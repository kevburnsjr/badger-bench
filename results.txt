Default Batch Size: 1000
Default Concurrency: 32



--- 32c 10M Random w/ 1:1 Read (NVME) ---



> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 10 --dir=$DATADIR --read
[0000] Write key rate per second: 255.90K. Total:   2.56M
[0001] Write key rate per second: 201.80K. Total:   4.58M
[0002] Write key rate per second: 182.60K. Total:   6.40M
[0003] Write key rate per second: 176.50K. Total:   8.17M
[0004] Write key rate per second: 165.20K. Total:   9.82M
[0005] Write key rate per second: 158.60K. Total:  10.02M
real    0m52.230s
user    0m30.391s
sys     0m26.379s

> time go run populate/main.go --kv rocksdb --valsz 0 --keys_mil 10 --dir=$DATADIR --read
[0000] Write key rate per second: 262.90K. Total:   2.63M
[0001] Write key rate per second: 115.30K. Total:   3.85M
[0002] Write key rate per second:  94.30K. Total:   4.79M
[0003] Write key rate per second:  73.00K. Total:   5.57M
[0004] Write key rate per second:  70.90K. Total:   6.27M
[0005] Write key rate per second:  54.40K. Total:   6.82M
[0006] Write key rate per second: 120.00K. Total:   8.07M
[0007] Write key rate per second:  96.40K. Total:   9.04M
[0008] Write key rate per second:  79.00K. Total:   9.83M
[0009] Write key rate per second:  76.20K. Total:  10.02M
real    1m33.415s
user    2m31.863s
sys     0m27.218s


> time go run populate/main.go --kv badger --valsz 0 --keys_mil 10 --dir=$DATADIR --read
[0000] Write key rate per second: 263.60K. Total:   2.64M
[0001] Write key rate per second: 202.20K. Total:   4.83M
[0002] Write key rate per second: 151.90K. Total:   6.39M
[0003] Write key rate per second: 165.60K. Total:   8.08M
[0004] Write key rate per second: 193.50K. Total:  10.02M
real    0m55.376s
user    1m41.246s
sys     0m2.270s

> time go run populate/main.go --kv leveldb --valsz 0 --keys_mil 10 --dir=$DATADIR --read
[0000] Write key rate per second: 116.40K. Total:   1.16M
[0001] Write key rate per second:  75.00K. Total:   1.91M
[0002] Write key rate per second:  65.10K. Total:   2.57M
[0003] Write key rate per second:  60.60K. Total:   3.17M
[0004] Write key rate per second:  55.60K. Total:   3.73M
[0005] Write key rate per second:  52.30K. Total:   4.25M
[0006] Write key rate per second:  49.50K. Total:   4.75M
[0007] Write key rate per second:  47.40K. Total:   5.23M
[0008] Write key rate per second:  45.00K. Total:   5.68M
[0009] Write key rate per second:  44.40K. Total:   6.12M
[0010] Write key rate per second:  40.80K. Total:   6.53M
[0011] Write key rate per second:  40.40K. Total:   6.93M
[0012] Write key rate per second:  40.90K. Total:   7.34M
[0013] Write key rate per second:  40.20K. Total:   7.75M
[0014] Write key rate per second:  38.40K. Total:   8.13M
[0015] Write key rate per second:  38.40K. Total:   8.51M
[0016] Write key rate per second:  38.40K. Total:   8.90M
[0017] Write key rate per second:  37.20K. Total:   9.28M
[0018] Write key rate per second:  36.00K. Total:   9.64M
[0019] Write key rate per second:  38.00K. Total:  10.02M
real    3m20.580s
user    5m48.266s
sys     0m28.053s

> time go run populate/main.go --kv bolt --valsz 0 --keys_mil 10 --dir=$DATADIR --read
[0000] Write key rate per second: 108.80K. Total:   1.09M
[0001] Write key rate per second:  73.60K. Total:   1.86M
[0002] Write key rate per second:  64.00K. Total:   2.50M
[0003] Write key rate per second:  57.60K. Total:   3.07M
[0004] Write key rate per second:  51.20K. Total:   3.58M
[0005] Write key rate per second:  51.20K. Total:   4.13M
[0006] Write key rate per second:  48.00K. Total:   4.61M
[0007] Write key rate per second:  48.00K. Total:   5.09M
[0008] Write key rate per second:  48.00K. Total:   5.57M
[0009] Write key rate per second:  44.80K. Total:   6.02M
[0010] Write key rate per second:  44.80K. Total:   6.46M
[0011] Write key rate per second:  44.80K. Total:   6.94M
[0012] Write key rate per second:  44.80K. Total:   7.39M
[0013] Write key rate per second:  41.60K. Total:   7.81M
[0014] Write key rate per second:  41.60K. Total:   8.22M
[0015] Write key rate per second:  41.60K. Total:   8.67M
[0016] Write key rate per second:  41.60K. Total:   9.09M
[0017] Write key rate per second:  44.80K. Total:   9.54M
[0018] Write key rate per second:  41.60K. Total:   9.95M
[0019] Write key rate per second:  41.60K. Total:  10.02M
real    3m12.295s
user    3m52.990s
sys     0m27.338s



--- 32c 10M Random w/ 1:1 Read w/ Strong Sync (NVME) ---


> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 10 --dir=$DATADIR --read --sync
[0000] Write key rate per second:  56.40K. Total: 564.00K
[0001] Write key rate per second:  39.20K. Total: 956.00K
[0002] Write key rate per second:  34.00K. Total:   1.30M
[0003] Write key rate per second:  31.80K. Total:   1.61M
[0004] Write key rate per second:  31.20K. Total:   1.93M
[0005] Write key rate per second:  29.90K. Total:   2.23M
[0006] Write key rate per second:  28.20K. Total:   2.51M
[0007] Write key rate per second:  27.40K. Total:   2.78M
[0008] Write key rate per second:  27.30K. Total:   3.06M
[0009] Write key rate per second:  27.10K. Total:   3.33M
[0010] Write key rate per second:  27.00K. Total:   3.60M
[0011] Write key rate per second:  26.90K. Total:   3.87M
[0012] Write key rate per second:  26.30K. Total:   4.13M
-------------------------- SNIP -------------------------
[0027] Write key rate per second:  22.80K. Total:   7.63M
[0028] Write key rate per second:  22.60K. Total:   7.86M
[0029] Write key rate per second:  22.40K. Total:   8.09M
[0030] Write key rate per second:  22.00K. Total:   8.31M
[0031] Write key rate per second:  21.70K. Total:   8.52M
[0032] Write key rate per second:  21.40K. Total:   8.74M
[0033] Write key rate per second:  21.10K. Total:   8.95M
[0034] Write key rate per second:  20.90K. Total:   9.16M
[0035] Write key rate per second:  20.70K. Total:   9.37M
[0036] Write key rate per second:  20.50K. Total:   9.57M
[0037] Write key rate per second:  20.50K. Total:   9.78M
[0038] Write key rate per second:  20.30K. Total:   9.98M
[0039] Write key rate per second:  20.00K. Total:  10.02M
real    6m32.967s
user    0m31.613s
sys     0m41.303s

381M

> time go run populate/main.go --kv rocksdb --valsz 0 --keys_mil 10 --dir=$DATADIR --read --sync
[0000] Write key rate per second: 249.80K. Total:   2.50M
[0001] Write key rate per second: 101.70K. Total:   3.58M
[0002] Write key rate per second:  79.30K. Total:   4.37M
[0003] Write key rate per second:  63.30K. Total:   5.05M
[0004] Write key rate per second:  55.90K. Total:   5.64M
[0005] Write key rate per second:  53.10K. Total:   6.19M
[0006] Write key rate per second:  39.40K. Total:   6.61M
[0007] Write key rate per second:  79.90K. Total:   7.43M
[0008] Write key rate per second:  93.10K. Total:   8.36M
[0009] Write key rate per second:  75.20K. Total:   9.16M
[0010] Write key rate per second:  61.60K. Total:   9.77M
[0011] Write key rate per second:  57.50K. Total:  10.02M
real    1m55.117s
user    3m15.407s
sys     0m25.108s

186M

> time go run populate/main.go --kv badger --valsz 0 --keys_mil 10 --dir=$DATADIR --read --sync
[0000] Write key rate per second: 231.60K. Total:   2.51M
[0001] Write key rate per second: 224.00K. Total:   4.84M
[0002] Write key rate per second: 171.10K. Total:   6.58M
[0003] Write key rate per second: 185.30K. Total:   8.44M
[0004] Write key rate per second: 217.40K. Total:  10.02M
real    0m54.691s
user    1m38.654s
sys     0m2.819s

808M

> time go run populate/main.go --kv leveldb --valsz 0 --keys_mil 10 --dir=$DATADIR --read --sync
[0000] Write key rate per second: 117.00K. Total:   1.17M
[0001] Write key rate per second:  75.10K. Total:   1.92M
[0002] Write key rate per second:  66.80K. Total:   2.59M
[0003] Write key rate per second:  60.00K. Total:   3.20M
[0004] Write key rate per second:  55.20K. Total:   3.75M
[0005] Write key rate per second:  53.00K. Total:   4.28M
[0006] Write key rate per second:  49.80K. Total:   4.78M
[0007] Write key rate per second:  47.80K. Total:   5.26M
[0008] Write key rate per second:  43.30K. Total:   5.69M
[0009] Write key rate per second:  43.80K. Total:   6.13M
[0010] Write key rate per second:  41.80K. Total:   6.55M
[0011] Write key rate per second:  41.30K. Total:   6.97M
[0012] Write key rate per second:  39.30K. Total:   7.36M
[0013] Write key rate per second:  38.60K. Total:   7.75M
[0014] Write key rate per second:  37.70K. Total:   8.13M
[0015] Write key rate per second:  37.80K. Total:   8.51M
[0016] Write key rate per second:  37.10K. Total:   8.89M
[0017] Write key rate per second:  37.40K. Total:   9.27M
[0018] Write key rate per second:  36.90K. Total:   9.64M
[0019] Write key rate per second:  38.00K. Total:  10.02M
real    3m20.889s
user    5m48.437s
sys     0m29.392s

214M

> time go run populate/main.go --kv bolt --valsz 0 --keys_mil 10 --dir=$DATADIR --read --sync
[0000] Write key rate per second: 112.00K. Total:   1.12M
[0001] Write key rate per second:  76.80K. Total:   1.89M
[0002] Write key rate per second:  64.00K. Total:   2.53M
[0003] Write key rate per second:  57.60K. Total:   3.10M
[0004] Write key rate per second:  54.40K. Total:   3.68M
[0005] Write key rate per second:  51.20K. Total:   4.19M
[0006] Write key rate per second:  51.20K. Total:   4.70M
[0007] Write key rate per second:  51.20K. Total:   5.22M
[0008] Write key rate per second:  48.00K. Total:   5.70M
[0009] Write key rate per second:  48.00K. Total:   6.18M
[0010] Write key rate per second:  48.00K. Total:   6.66M
[0011] Write key rate per second:  44.80K. Total:   7.10M
[0012] Write key rate per second:  48.00K. Total:   7.58M
[0013] Write key rate per second:  44.80K. Total:   8.03M
[0014] Write key rate per second:  44.80K. Total:   8.48M
[0015] Write key rate per second:  44.80K. Total:   8.93M
[0016] Write key rate per second:  41.60K. Total:   9.34M
[0017] Write key rate per second:  41.60K. Total:   9.79M
[0018] Write key rate per second:  44.80K. Total:  10.02M
real    3m5.882s
user    3m45.964s
sys     0m23.146s

562M



--- 32c 100M Random w/ 1:1 Read (NVME) ---



> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 100 --dir=$DATADIR --read
[0000] Write key rate per second: 256.00K. Total:   2.56M
[0001] Write key rate per second: 201.60K. Total:   4.58M
[0002] Write key rate per second: 182.70K. Total:   6.41M
[0003] Write key rate per second: 176.70K. Total:   8.17M
[0004] Write key rate per second: 165.60K. Total:   9.83M
[0005] Write key rate per second: 157.80K. Total:  11.41M
[0006] Write key rate per second: 156.50K. Total:  12.98M
[0007] Write key rate per second: 155.00K. Total:  14.53M
[0008] Write key rate per second: 153.60K. Total:  16.07M
[0009] Write key rate per second: 149.60K. Total:  17.56M
[0010] Write key rate per second: 145.20K. Total:  19.02M
[0011] Write key rate per second: 142.70K. Total:  20.45M
[0012] Write key rate per second: 142.00K. Total:  21.87M
-------------------------- SNIP -------------------------
[0063] Write key rate per second: 119.30K. Total:  86.77M
[0064] Write key rate per second: 119.50K. Total:  87.97M
[0065] Write key rate per second: 119.30K. Total:  89.16M
[0066] Write key rate per second: 119.00K. Total:  90.35M
[0067] Write key rate per second: 119.00K. Total:  91.54M
[0068] Write key rate per second: 118.50K. Total:  92.73M
[0069] Write key rate per second: 118.90K. Total:  93.92M
[0070] Write key rate per second: 118.90K. Total:  95.11M
[0071] Write key rate per second: 118.70K. Total:  96.30M
[0072] Write key rate per second: 118.60K. Total:  97.48M
[0073] Write key rate per second: 118.00K. Total:  98.66M
[0074] Write key rate per second: 118.20K. Total:  99.85M
[0075] Write key rate per second: 115.70K. Total: 100.00M
real    12m32.334s
user    6m33.120s
sys     6m46.528s

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          27.58    0.00   25.17   39.01    0.00    8.25

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
nvme1n1        2383.70         0.00       155.01          0       1550
nvme0n1           0.00         0.00         0.00          0          0

3.6GB

> time go run populate/main.go --kv rocksdb --valsz 0 --keys_mil 100 --dir=$DATADIR --read -batchsize 100000
[0000] Write key rate per second: 238.90K. Total:   2.63M
[0001] Write key rate per second: 115.20K. Total:   3.85M
[0002] Write key rate per second:  89.70K. Total:   4.80M
[0003] Write key rate per second:  73.50K. Total:   5.57M
[0004] Write key rate per second:  70.50K. Total:   6.28M
[0005] Write key rate per second:  51.90K. Total:   6.82M
[0006] Write key rate per second: 120.10K. Total:   8.06M
[0007] Write key rate per second:  93.80K. Total:   9.04M
[0008] Write key rate per second:  74.60K. Total:   9.82M
[0009] Write key rate per second:  69.30K. Total:  10.55M
[0010] Write key rate per second:  60.60K. Total:  11.19M
[0011] Write key rate per second:  56.40K. Total:  11.78M
[0012] Write key rate per second:  52.50K. Total:  12.33M
-------------------------- SNIP -------------------------
[0168] Write key rate per second:  56.40K. Total:  94.34M
[0169] Write key rate per second:  52.00K. Total:  94.89M
[0170] Write key rate per second:  47.70K. Total:  95.39M
[0171] Write key rate per second:  47.30K. Total:  95.89M
[0172] Write key rate per second:  44.40K. Total:  96.36M
[0173] Write key rate per second:  47.70K. Total:  96.86M
[0174] Write key rate per second:  46.70K. Total:  97.35M
[0175] Write key rate per second:  41.80K. Total:  97.79M
[0176] Write key rate per second:  36.90K. Total:  98.17M
[0177] Write key rate per second:  35.90K. Total:  98.55M
[0178] Write key rate per second:  47.20K. Total:  99.04M
[0179] Write key rate per second:  60.60K. Total:  99.68M
[0180] Write key rate per second:  56.00K. Total: 100.00M
real    30m7.010s
user    47m56.238s
sys     10m48.772s

2.4GB



--- 32c 100M Random w/ 1:1 Read w/ History (NVME) ---



> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 100 --dir=$DATADIR --read --history
[0000] Write key rate per second: 252.90K. Total:   2.53M
[0001] Write key rate per second: 198.90K. Total:   4.52M
[0002] Write key rate per second: 180.80K. Total:   6.33M
[0003] Write key rate per second: 165.40K. Total:   8.07M
[0004] Write key rate per second: 154.90K. Total:   9.71M
[0005] Write key rate per second: 155.40K. Total:  11.26M
[0006] Write key rate per second: 147.40K. Total:  12.81M
[0007] Write key rate per second: 153.80K. Total:  14.35M
[0008] Write key rate per second: 143.60K. Total:  15.86M
[0009] Write key rate per second: 146.70K. Total:  17.33M
[0010] Write key rate per second: 143.00K. Total:  18.76M
[0011] Write key rate per second: 140.60K. Total:  20.16M
[0012] Write key rate per second: 139.40K. Total:  21.56M
-------------------------- SNIP -------------------------
[0064] Write key rate per second: 117.50K. Total:  86.53M
[0065] Write key rate per second: 117.50K. Total:  87.71M
[0066] Write key rate per second: 117.30K. Total:  88.88M
[0067] Write key rate per second: 117.30K. Total:  90.06M
[0068] Write key rate per second: 111.40K. Total:  91.23M
[0069] Write key rate per second: 117.10K. Total:  92.40M
[0070] Write key rate per second: 117.10K. Total:  93.57M
[0071] Write key rate per second: 111.20K. Total:  94.74M
[0072] Write key rate per second: 111.00K. Total:  95.91M
[0073] Write key rate per second: 116.90K. Total:  97.08M
[0074] Write key rate per second: 110.60K. Total:  98.24M
[0075] Write key rate per second: 116.60K. Total:  99.41M
[0076] Write key rate per second: 111.80K. Total: 100.00M
real    12m46.187s
user    6m38.187s
sys     6m55.504s

5.2G

> time go run populate/main.go --kv badger --valsz 0 --keys_mil 100 --dir=$DATADIR --read --history
[0000] Write key rate per second: 254.90K. Total:   2.55M
[0001] Write key rate per second: 220.90K. Total:   4.76M
[0002] Write key rate per second: 160.50K. Total:   6.36M
[0003] Write key rate per second: 147.60K. Total:   7.89M
[0004] Write key rate per second: 188.00K. Total:   9.87M
[0005] Write key rate per second: 171.00K. Total:  11.78M
[0006] Write key rate per second:  92.60K. Total:  12.71M
[0007] Write key rate per second:  55.10K. Total:  13.20M
[0008] Write key rate per second: 184.40K. Total:  15.04M
[0009] Write key rate per second: 175.10K. Total:  16.84M
[0010] Write key rate per second: 129.80K. Total:  18.13M
[0011] Write key rate per second:  70.10K. Total:  18.84M
[0012] Write key rate per second: 116.10K. Total:  20.00M
-------------------------- SNIP -------------------------
[0097] Write key rate per second: 105.90K. Total:  92.33M
[0098] Write key rate per second:  57.70K. Total:  92.91M
[0099] Write key rate per second:  95.30K. Total:  93.86M
[0100] Write key rate per second:  13.60K. Total:  94.00M
[0101] Write key rate per second:  58.30K. Total:  94.58M
[0102] Write key rate per second:  90.80K. Total:  95.49M
[0103] Write key rate per second:  75.70K. Total:  96.25M
[0104] Write key rate per second:  34.00K. Total:  96.59M
[0105] Write key rate per second:   9.30K. Total:  96.68M
[0106] Write key rate per second:  90.20K. Total:  97.59M
[0107] Write key rate per second: 116.10K. Total:  98.75M
[0108] Write key rate per second:  84.60K. Total:  99.59M
[0109] Write key rate per second:  50.50K. Total: 100.00M
real    18m23.432s
user    35m5.264s
sys     0m46.388s

8.0G



--- 32c 100M History Only (NVME) ---



> time go run populate/main.go --kv leveldb --valsz 0 --keys_mil 100 --dir=$DATADIR --tsonly
[0000] Write key rate per second:   5.28M. Total:  52.76M
[0001] Write key rate per second:   4.72M. Total: 100.00M
real    0m20.944s
user    0m20.970s
sys     0m3.573s

1.5G

> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 100 --dir=$DATADIR --tsonly
[0000] Write key rate per second:   7.68M. Total:  76.78M
[0001] Write key rate per second:   7.33M. Total: 100.00M
real    0m14.160s
user    0m17.989s
sys     0m2.624s

1.6G

> time go run populate/main.go --kv rocksdb --valsz 0 --keys_mil 100 --dir=$DATADIR --tsonly
[0000] Write key rate per second:   5.11M. Total:  51.06M
[0001] Write key rate per second:   4.62M. Total:  97.30M
[0002] Write key rate per second:   4.76M. Total: 100.00M
real    0m22.149s
user    0m27.817s
sys     0m3.768s

1.5G

> time go run populate/main.go --kv bolt --valsz 0 --keys_mil 100 --dir=$DATADIR --tsonly
[0000] Write key rate per second:   1.04M. Total:  10.37M
[0001] Write key rate per second:   1.01M. Total:  20.51M
[0002] Write key rate per second: 992.00K. Total:  30.46M
[0003] Write key rate per second: 969.60K. Total:  40.16M
[0004] Write key rate per second: 966.40K. Total:  49.86M
[0005] Write key rate per second: 960.00K. Total:  59.46M
[0006] Write key rate per second: 960.00K. Total:  69.09M
[0007] Write key rate per second: 966.40K. Total:  78.78M
[0008] Write key rate per second: 966.40K. Total:  88.45M
[0009] Write key rate per second: 960.00K. Total:  98.05M
[0010] Write key rate per second: 960.00K. Total: 100.00M
real    1m43.066s
user    1m52.300s
sys     0m2.815s

1.6G

> time go run populate/main.go --kv badger --valsz 0 --keys_mil 100 --dir=$DATADIR --tsonly
[0000] Write key rate per second:   7.20M. Total:  72.03M
[0001] Write key rate per second:   7.13M. Total: 100.00M
real    0m15.040s
user    0m21.095s
sys     0m2.720s

1.5G



--- 32c 10M w/ History (NVME) ---



> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 10 --dir=$DATADIR --read --history
[0000] Write key rate per second: 251.60K. Total:   2.52M
[0001] Write key rate per second: 198.80K. Total:   4.50M
[0002] Write key rate per second: 171.30K. Total:   6.31M
[0003] Write key rate per second: 163.30K. Total:   8.03M
[0004] Write key rate per second: 161.00K. Total:   9.64M
[0005] Write key rate per second: 157.50K. Total:  10.02M
real    0m53.347s
user    0m31.179s
sys     0m26.730s

538M


> time go run populate/main.go --kv rocksdb --valsz 0 --keys_mil 10 --dir=$DATADIR --read --history
[0000] Write key rate per second: 235.40K. Total:   2.35M
[0001] Write key rate per second: 104.40K. Total:   3.40M
[0002] Write key rate per second:  80.40K. Total:   4.21M
[0003] Write key rate per second:  63.10K. Total:   4.84M
[0004] Write key rate per second: 102.50K. Total:   5.87M
[0005] Write key rate per second:  95.40K. Total:   6.83M
[0006] Write key rate per second:  75.40K. Total:   7.58M
[0007] Write key rate per second:  65.10K. Total:   8.24M
[0008] Write key rate per second:  59.60K. Total:   8.83M
[0009] Write key rate per second:  47.30K. Total:   9.31M
[0010] Write key rate per second:  44.30K. Total:   9.75M
[0011] Write key rate per second:  55.00K. Total:  10.02M
real    1m54.643s
user    3m2.968s
sys     0m37.305s

390M

> time go run populate/main.go --kv leveldb --valsz 0 --keys_mil 10 --dir=$DATADIR --read --history
[0000] Write key rate per second: 106.00K. Total:   1.06M
[0001] Write key rate per second:  66.20K. Total:   1.72M
[0002] Write key rate per second:  58.90K. Total:   2.31M
[0003] Write key rate per second:  52.00K. Total:   2.84M
[0004] Write key rate per second:  46.80K. Total:   3.30M
[0005] Write key rate per second:  44.80K. Total:   3.75M
[0006] Write key rate per second:  40.70K. Total:   4.16M
[0007] Write key rate per second:  36.70K. Total:   4.53M
[0008] Write key rate per second:  34.00K. Total:   4.87M
[0009] Write key rate per second:  36.20K. Total:   5.23M
[0010] Write key rate per second:  34.70K. Total:   5.58M
[0011] Write key rate per second:  34.50K. Total:   5.93M
[0012] Write key rate per second:  31.20K. Total:   6.26M
[0013] Write key rate per second:  32.40K. Total:   6.58M
[0014] Write key rate per second:  30.30K. Total:   6.89M
[0015] Write key rate per second:  28.40K. Total:   7.17M
[0016] Write key rate per second:  33.70K. Total:   7.51M
[0017] Write key rate per second:  31.20K. Total:   7.82M
[0018] Write key rate per second:  27.60K. Total:   8.11M
[0019] Write key rate per second:  29.10K. Total:   8.40M
[0020] Write key rate per second:  29.30K. Total:   8.70M
[0021] Write key rate per second:  28.40K. Total:   8.98M
[0022] Write key rate per second:  28.80K. Total:   9.27M
[0023] Write key rate per second:  30.00K. Total:   9.57M
[0024] Write key rate per second:  28.10K. Total:   9.85M
[0025] Write key rate per second:  29.60K. Total:  10.02M
real    4m16.145s
user    7m37.502s
sys     0m36.642s

231M


> time go run populate/main.go --kv badger --valsz 0 --keys_mil 10 --dir=$DATADIR --read --history
[0000] Write key rate per second: 255.90K. Total:   2.56M
[0001] Write key rate per second: 207.50K. Total:   4.76M
[0002] Write key rate per second: 157.50K. Total:   6.40M
[0003] Write key rate per second: 155.70K. Total:   8.01M
[0004] Write key rate per second: 201.10K. Total:  10.02M
real    0m55.983s
user    1m41.263s
sys     0m2.768s

819M



--- 32c 100M History Only w/ Strong Sync (EBS) ---



> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 100 --dir=$DATADIREBS --tsonly --sync
[0000] Write key rate per second: 359.00K. Total:   3.59M
[0001] Write key rate per second: 366.30K. Total:   7.25M
[0002] Write key rate per second: 368.40K. Total:  10.94M
[0003] Write key rate per second: 351.60K. Total:  14.46M
[0004] Write key rate per second: 368.80K. Total:  18.14M
[0005] Write key rate per second: 364.20K. Total:  21.79M
[0006] Write key rate per second: 331.10K. Total:  25.10M
[0007] Write key rate per second: 365.00K. Total:  28.75M
[0008] Write key rate per second: 342.00K. Total:  32.17M
[0009] Write key rate per second: 339.90K. Total:  35.57M
[0010] Write key rate per second: 339.80K. Total:  38.97M
[0011] Write key rate per second: 339.80K. Total:  42.37M
[0012] Write key rate per second: 329.10K. Total:  45.66M
[0013] Write key rate per second: 350.30K. Total:  49.17M
[0014] Write key rate per second: 340.00K. Total:  52.57M
[0015] Write key rate per second: 337.00K. Total:  55.94M
[0016] Write key rate per second: 342.50K. Total:  59.37M
[0017] Write key rate per second: 339.00K. Total:  62.76M
[0018] Write key rate per second: 340.40K. Total:  66.17M
[0019] Write key rate per second: 334.80K. Total:  69.51M
[0020] Write key rate per second: 345.10K. Total:  72.97M
[0021] Write key rate per second: 339.80K. Total:  76.36M
[0022] Write key rate per second: 339.30K. Total:  79.76M
[0023] Write key rate per second: 340.40K. Total:  83.17M
[0024] Write key rate per second: 339.70K. Total:  86.56M
[0025] Write key rate per second: 339.40K. Total:  89.96M
[0026] Write key rate per second: 337.00K. Total:  93.33M
[0027] Write key rate per second: 343.10K. Total:  96.76M
[0028] Write key rate per second: 323.70K. Total: 100.00M
real    4m50.739s
user    0m39.431s
sys     0m18.670s

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
           1.68    0.00    1.32   46.82    0.00   50.18

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
nvme1n1           0.00         0.00         0.00          0          0
nvme0n1        3364.80         0.00        22.72          0        227

1.5G

> time go run populate/main.go --kv leveldb --valsz 0 --keys_mil 100 --dir=$DATADIREBS --tsonly --sync
[0000] Write key rate per second:   3.22M. Total:  32.20M
[0001] Write key rate per second:   3.23M. Total:  64.52M
[0002] Write key rate per second:   3.24M. Total:  96.92M
[0003] Write key rate per second:   3.21M. Total: 100.00M
real    0m32.079s
user    0m17.950s
sys     0m3.941s

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          27.51    0.00    6.13   39.16    0.05   27.15

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
nvme1n1           0.00         0.00         0.00          0          0
nvme0n1        1379.50         0.00       109.27          0       1092

1.5G

> time go run populate/main.go --kv rocksdb --valsz 0 --keys_mil 100 --dir=$DATADIREBS --tsonly --sync
[0000] Write key rate per second:   2.88M. Total:  28.79M
[0001] Write key rate per second:   2.81M. Total:  56.96M
[0002] Write key rate per second:   2.98M. Total:  86.76M
[0003] Write key rate per second:   2.79M. Total: 100.00M
real    0m35.678s
user    0m21.489s
sys     0m5.173s

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          28.92    0.00    6.74   31.29    0.00   33.04

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
nvme1n1           0.00         0.00         0.00          0          0
nvme0n1        1169.80         0.00        95.52          0        955

1.5G

> time go run populate/main.go --kv badger --valsz 0 --keys_mil 100 --dir=$DATADIREBS --tsonly --sync
[0000] Write key rate per second:   3.03M. Total:  30.31M
[0001] Write key rate per second:   2.76M. Total:  57.91M
[0002] Write key rate per second:   2.78M. Total:  85.69M
[0003] Write key rate per second:   2.65M. Total: 100.00M
real    0m36.774s
user    0m22.705s
sys     0m4.323s

1.6G

time go run populate/main.go --kv bolt --valsz 0 --keys_mil 100 --dir=$DATADIREBS --tsonly --sync
[0000] Write key rate per second: 950.40K. Total:   9.50M
[0001] Write key rate per second: 931.20K. Total:  18.85M
[0002] Write key rate per second: 912.00K. Total:  27.97M
[0003] Write key rate per second: 886.40K. Total:  36.83M
[0004] Write key rate per second: 883.20K. Total:  45.70M
[0005] Write key rate per second: 880.00K. Total:  54.53M
[0006] Write key rate per second: 892.80K. Total:  63.49M
[0007] Write key rate per second: 873.60K. Total:  72.22M
[0008] Write key rate per second: 886.40K. Total:  81.12M
[0009] Write key rate per second: 892.80K. Total:  90.05M
[0010] Write key rate per second: 880.00K. Total:  98.88M
[0011] Write key rate per second: 860.80K. Total: 100.00M
real    1m52.309s
user    1m50.329s
sys     0m2.921s

1.6G



--- 32c 100M History Only w/ Strong Sync (NVME) ---



> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 100 --dir=$DATADIR --tsonly --sync
[0000] Write key rate per second:   2.99M. Total:  29.86M
[0001] Write key rate per second:   2.48M. Total:  54.64M
[0002] Write key rate per second:   2.48M. Total:  79.42M
[0003] Write key rate per second:   2.43M. Total: 100.00M
real    0m39.212s
user    0m16.463s
sys     0m9.623s

1.5G

> time go run populate/main.go --kv leveldb --valsz 0 --keys_mil 100 --dir=$DATADIR --tsonly --sync
[0000] Write key rate per second:   4.79M. Total:  47.93M
[0001] Write key rate per second:   4.51M. Total:  93.07M
[0002] Write key rate per second:   4.29M. Total: 100.00M
real    0m22.435s
user    0m19.514s
sys     0m4.069s

1.5G

> time go run populate/main.go --kv rocksdb --valsz 0 --keys_mil 100 --dir=$DATADIR --tsonly --sync
[0000] Write key rate per second:   4.94M. Total:  49.37M
[0001] Write key rate per second:   4.42M. Total:  93.61M
[0002] Write key rate per second:   4.35M. Total: 100.00M
real    0m22.337s
user    0m26.855s
sys     0m6.033s

1.5G

> time go run populate/main.go --kv badger --valsz 0 --keys_mil 100 --dir=$DATADIR --tsonly --sync
[0000] Write key rate per second:   6.88M. Total:  68.79M
[0001] Write key rate per second:   6.39M. Total: 100.00M
real    0m15.704s
user    0m20.547s
sys     0m2.444s

1.6G

> time go run populate/main.go --kv bolt --valsz 0 --keys_mil 100 --dir=$DATADIR --tsonly --sync
[0000] Write key rate per second:   1.07M. Total:  10.69M
[0001] Write key rate per second:   1.05M. Total:  21.18M
[0002] Write key rate per second:   1.02M. Total:  31.46M
[0003] Write key rate per second: 998.40K. Total:  41.47M
[0004] Write key rate per second:   1.00M. Total:  51.52M
[0005] Write key rate per second: 995.20K. Total:  61.50M
[0006] Write key rate per second: 992.00K. Total:  71.46M
[0007] Write key rate per second:   1.00M. Total:  81.47M
[0008] Write key rate per second: 998.40K. Total:  91.46M
[0009] Write key rate per second: 953.60K. Total: 100.00M
real    1m39.584s
user    1m49.114s
sys     0m2.564s

1.6G



--- 32c 100M History Only (NVME) ---



> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 100 --dir=$DATADIR --tsonly
[0000] Write key rate per second:   7.94M. Total:  83.28M
[0001] Write key rate per second:   7.93M. Total: 100.00M
real    0m13.179s
user    0m16.688s
sys     0m2.622s

1.6G

> time go run populate/main.go --kv leveldb --valsz 0 --keys_mil 100 --dir=$DATADIR --tsonly
[0000] Write key rate per second:   6.36M. Total:  66.90M
[0001] Write key rate per second:   6.67M. Total: 100.00M
real    0m16.027s
user    0m27.680s
sys     0m2.684s

1.5G

> time go run populate/main.go --kv rocksdb --valsz 0 --keys_mil 100 --dir=$DATADIR --tsonly
[0000] Write key rate per second:   4.45M. Total:  44.52M
[0001] Write key rate per second:   3.18M. Total:  76.41M
[0002] Write key rate per second:   4.27M. Total: 100.00M
real    0m26.073s
user    0m26.253s
sys     0m4.110s

1.5G

> time go run populate/main.go --kv badger --valsz 0 --keys_mil 100 --dir=$DATADIR --tsonly
[0000] Write key rate per second:   6.68M. Total:  66.76M
[0001] Write key rate per second:   3.39M. Total: 100.00M
real    0m20.229s
user    0m28.455s
sys     0m1.641s

1.6G

> time go run populate/main.go --kv bolt --valsz 0 --keys_mil 100 --dir=$DATADIR --tsonly
[0000] Write key rate per second:   1.08M. Total:  10.75M
[0001] Write key rate per second:   1.06M. Total:  21.38M
[0002] Write key rate per second: 899.20K. Total:  30.40M
[0003] Write key rate per second:   1.01M. Total:  40.54M
[0004] Write key rate per second:   1.01M. Total:  50.69M
[0005] Write key rate per second:   1.00M. Total:  60.74M
[0006] Write key rate per second:   1.00M. Total:  70.78M
[0007] Write key rate per second:   1.01M. Total:  80.90M
[0008] Write key rate per second:   1.00M. Total:  90.98M
[0009] Write key rate per second:   1.00M. Total: 100.00M
real    1m39.877s
user    1m48.222s
sys     0m2.753s

1.6G



--- 100M History Only w/ Strong Sync w/ Concurrency 1024 w/ Batch Size 100 (EBS) ---



> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 100 --dir=$DATADIREBS --tsonly --sync --batchsize 100 -n 1024
[0000] Write key rate per second:  40.58K. Total: 405.80K
[0001] Write key rate per second:  37.17K. Total: 777.60K
[0002] Write key rate per second:  37.11K. Total:   1.15M
[0003] Write key rate per second:  37.20K. Total:   1.52M
[0004] Write key rate per second:  37.17K. Total:   1.89M
[0005] Write key rate per second:  37.44K. Total:   2.27M
[0006] Write key rate per second:  37.02K. Total:   2.64M
[0007] Write key rate per second:  35.89K. Total:   3.00M
[0008] Write key rate per second:  31.94K. Total:   3.32M
[0009] Write key rate per second:  31.95K. Total:   3.64M
[0010] Write key rate per second:  31.79K. Total:   3.95M
[0011] Write key rate per second:  31.88K. Total:   4.27M
[0012] Write key rate per second:  32.07K. Total:   4.59M
[0013] Write key rate per second:  31.81K. Total:   4.91M
[0014] Write key rate per second:  31.92K. Total:   5.23M
[0015] Write key rate per second:  31.76K. Total:   5.55M
[0016] Write key rate per second:  32.08K. Total:   5.87M
[0017] Write key rate per second:  32.02K. Total:   6.19M
[0018] Write key rate per second:  31.95K. Total:   6.51M
[0019] Write key rate per second:  31.99K. Total:   6.83M
[0020] Write key rate per second:  31.79K. Total:   7.15M
[0021] Write key rate per second:  32.09K. Total:   7.47M
[0022] Write key rate per second:  32.09K. Total:   7.79M
[0023] Write key rate per second:  31.81K. Total:   8.11M
[0024] Write key rate per second:  31.80K. Total:   8.43M
[0025] Write key rate per second:  31.81K. Total:   8.75M
[0026] Write key rate per second:  31.91K. Total:   9.06M
[0027] Write key rate per second:  31.90K. Total:   9.38M
[0028] Write key rate per second:  31.93K. Total:   9.70M
[0029] Write key rate per second:  31.98K. Total:  10.02M

[ABORTED]

> time go run populate/main.go --kv leveldb --valsz 0 --keys_mil 100 --dir=$DATADIREBS --tsonly --sync --batchsize 100 -n 1024
[0000] Write key rate per second:   2.56M. Total:  25.55M
[0001] Write key rate per second:   2.56M. Total:  51.26M
[0002] Write key rate per second:   2.54M. Total:  76.77M
[0003] Write key rate per second:   2.45M. Total: 100.04M
real    0m40.242s
user    0m27.199s
sys     0m4.093s

1.6G

> time go run populate/main.go --kv rocksdb --valsz 0 --keys_mil 100 --dir=$DATADIREBS --tsonly --sync --batchsize 100 -n 1024
[0000] Write key rate per second:   1.85M. Total:  18.50M
[0001] Write key rate per second:   1.77M. Total:  36.15M
[0002] Write key rate per second:   1.71M. Total:  53.23M
[0003] Write key rate per second:   1.78M. Total:  71.02M
[0004] Write key rate per second:   1.70M. Total:  88.01M
[0005] Write key rate per second:   1.73M. Total: 100.04M
real    0m57.846s
user    0m52.663s
sys     0m14.839s

1.6G

> time go run populate/main.go --kv badger --valsz 0 --keys_mil 100 --dir=$DATADIREBS --tsonly --sync --batchsize 100 -n 1024
[0000] Write key rate per second:   4.38M. Total:  43.83M
[0001] Write key rate per second:   4.49M. Total:  88.75M
[0002] Write key rate per second:   4.07M. Total: 100.04M
real    0m24.785s
user    0m28.080s
sys     0m2.113s

1.7G

> time go run populate/main.go --kv bolt --valsz 0 --keys_mil 100 --dir=$DATADIREBS --tsonly --sync --batchsize 100 -n 1024
[0000] Write key rate per second:   1.11M. Total:  11.08M
[0001] Write key rate per second:   1.08M. Total:  21.93M
[0002] Write key rate per second:   1.04M. Total:  32.45M
[0003] Write key rate per second:   1.07M. Total:  43.19M
[0004] Write key rate per second:   1.07M. Total:  53.94M
[0005] Write key rate per second:   1.04M. Total:  64.40M
[0006] Write key rate per second:   1.05M. Total:  74.91M
[0007] Write key rate per second:   1.05M. Total:  85.48M
[0008] Write key rate per second:   1.06M. Total:  96.10M
[0009] Write key rate per second:   1.02M. Total: 100.04M
real    1m34.875s
user    1m48.663s
sys     0m2.172s

2.0G



--- 32c 10M w/ Batch Size 150 w/ history w/ Strong Sync (EBS) ---



> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 10 --dir=$DATADIREBS --sync --batchsize 150 -n 32 -read -history
[0000] Write key rate per second:   5.54K. Total:  55.35K
[0001] Write key rate per second:   3.38K. Total:  89.10K
[0002] Write key rate per second:   3.17K. Total: 120.75K
[0003] Write key rate per second:   3.00K. Total: 150.75K
[0004] Write key rate per second:   2.88K. Total: 179.55K
[0005] Write key rate per second:   2.82K. Total: 207.75K
[0006] Write key rate per second:   2.81K. Total: 235.80K
[0007] Write key rate per second:   2.76K. Total: 263.40K
[0008] Write key rate per second:   2.62K. Total: 289.65K
[0009] Write key rate per second:   2.52K. Total: 315.00K
real    1m47.474s
user    0m1.902s
sys     0m1.317s

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
           0.30    0.00    0.35   49.25    0.05   50.05

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
nvme1n1           0.00         0.00         0.00          0          0
nvme0n1        3025.40         0.00        12.61          0        126

[ABORTED]

> time go run populate/main.go --kv leveldb --valsz 0 --keys_mil 10 --dir=$DATADIREBS --sync --batchsize 150 -n 32 -read -history
[0000] Write key rate per second:  92.75K. Total:   1.06M
[0001] Write key rate per second:  64.65K. Total:   1.71M
[0002] Write key rate per second:  51.69K. Total:   2.25M
[0003] Write key rate per second:  46.58K. Total:   2.74M
[0004] Write key rate per second:  43.24K. Total:   3.17M
[0005] Write key rate per second:  39.77K. Total:   3.57M
[0006] Write key rate per second:  33.09K. Total:   3.92M
[0007] Write key rate per second:  34.38K. Total:   4.27M
[0008] Write key rate per second:  33.65K. Total:   4.60M
[0009] Write key rate per second:  36.24K. Total:   4.97M
[0010] Write key rate per second:  31.38K. Total:   5.30M
[0011] Write key rate per second:  34.09K. Total:   5.64M
[0012] Write key rate per second:  31.05K. Total:   5.96M
[0013] Write key rate per second:  32.15K. Total:   6.28M
[0014] Write key rate per second:  32.61K. Total:   6.61M
[0015] Write key rate per second:  29.64K. Total:   6.92M
[0016] Write key rate per second:  33.23K. Total:   7.25M
[0017] Write key rate per second:  27.86K. Total:   7.55M
[0018] Write key rate per second:  30.64K. Total:   7.87M
[0019] Write key rate per second:  31.52K. Total:   8.19M
[0020] Write key rate per second:  29.30K. Total:   8.50M
[0021] Write key rate per second:  31.80K. Total:   8.81M
[0022] Write key rate per second:  33.23K. Total:   9.15M
[0023] Write key rate per second:  30.41K. Total:   9.47M
[0024] Write key rate per second:  30.78K. Total:   9.79M
[0025] Write key rate per second:  30.98K. Total:  10.00M
real    4m17.964s
user    7m11.958s
sys     0m37.955s

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          84.78    0.00    7.79    5.16    0.05    2.22

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
nvme1n1           0.00         0.00         0.00          0          0
nvme0n1         246.90         0.00        34.80          0        347

367M

> time go run populate/main.go --kv rocksdb --valsz 0 --keys_mil 10 --dir=$DATADIREBS --sync --batchsize 150 -n 32 -read -history
[0000] Write key rate per second: 195.78K. Total:   2.17M
[0001] Write key rate per second:  87.18K. Total:   3.04M
[0002] Write key rate per second:  68.00K. Total:   3.72M
[0003] Write key rate per second:  58.14K. Total:   4.31M
[0004] Write key rate per second:  42.93K. Total:   4.77M
[0005] Write key rate per second:  80.42K. Total:   5.57M
[0006] Write key rate per second:  78.97K. Total:   6.41M
[0007] Write key rate per second:  61.99K. Total:   7.07M
[0008] Write key rate per second:  58.55K. Total:   7.66M
[0009] Write key rate per second:  48.66K. Total:   8.14M
[0010] Write key rate per second:  46.20K. Total:   8.60M
[0011] Write key rate per second:  41.33K. Total:   9.02M
[0012] Write key rate per second:  33.44K. Total:   9.35M
[0013] Write key rate per second:  34.23K. Total:   9.70M
[0014] Write key rate per second:  44.10K. Total:  10.00M
real    2m26.674s
user    3m58.914s
sys     0m34.539s

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          82.29    0.00   12.93    1.27    0.00    3.51

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
nvme1n1           0.00         0.00         0.00          0          0
nvme0n1         259.70         0.00         6.75          0         67

332M

> time go run populate/main.go --kv badger --valsz 0 --keys_mil 10 --dir=$DATADIREBS --sync --batchsize 150 -n 32 -read -history
[0000] Write key rate per second: 220.53K. Total:   2.21M
[0001] Write key rate per second: 194.24K. Total:   4.15M
[0002] Write key rate per second: 185.18K. Total:   6.00M
[0003] Write key rate per second: 107.40K. Total:   7.16M
[0004] Write key rate per second: 198.54K. Total:   9.14M
[0005] Write key rate per second: 180.60K. Total:  10.00M
real    1m2.269s
user    1m28.004s
sys     0m3.125s

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          69.66    0.00    2.49   17.30    0.00   10.55

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
nvme1n1           0.00         0.00         0.00          0          0
nvme0n1         711.80         0.00        26.23          0        262

966M

> time go run populate/main.go --kv bolt --valsz 0 --keys_mil 10 --dir=$DATADIREBS --sync --batchsize 150 -n 32 -read -history
[0000] Write key rate per second:  29.76K. Total: 297.60K
[0001] Write key rate per second:   9.60K. Total: 393.60K
[0002] Write key rate per second:   7.20K. Total: 465.60K
[0003] Write key rate per second:   7.20K. Total: 537.60K
[0004] Write key rate per second:   6.24K. Total: 600.00K
[0005] Write key rate per second:   5.76K. Total: 657.60K
[0006] Write key rate per second:   5.76K. Total: 715.20K
[0007] Write key rate per second:   5.76K. Total: 772.80K
[0008] Write key rate per second:   5.28K. Total: 825.60K
[0009] Write key rate per second:   4.80K. Total: 873.60K
real    1m44.153s
user    0m17.467s
sys     0m1.715s

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
           7.13    0.00    0.60   43.80    0.00   48.47

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
nvme1n1           0.00         0.00         0.00          0          0
nvme0n1        3070.10         0.00        20.24          0        202

[ABORTED]



--- 32c 10M w/ Batch Size 150 w/ History (EBS) ---



> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 10 --dir=$DATADIREBS --batchsize 150 -n 32 -read -history
[0000] Write key rate per second: 248.90K. Total:   2.49M
[0001] Write key rate per second: 195.60K. Total:   4.44M
[0002] Write key rate per second: 183.65K. Total:   6.28M
[0003] Write key rate per second: 149.29K. Total:   7.77M
[0004] Write key rate per second: 170.40K. Total:   9.48M
[0005] Write key rate per second: 160.51K. Total:  10.00M
real    0m54.044s
user    0m29.825s
sys     0m23.691s

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          27.55    0.00   22.73   24.00    0.00   25.72

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
nvme1n1           0.00         0.00         0.00          0          0
nvme0n1        2282.50         0.00        32.06          0        320

632M

> time go run populate/main.go --kv leveldb --valsz 0 --keys_mil 10 --dir=$DATADIREBS --batchsize 150 -n 32 -read -history
[0000] Write key rate per second: 109.38K. Total:   1.09M
[0001] Write key rate per second:  69.90K. Total:   1.79M
[0002] Write key rate per second:  55.03K. Total:   2.37M
[0003] Write key rate per second:  52.56K. Total:   2.89M
[0004] Write key rate per second:  45.80K. Total:   3.37M
[0005] Write key rate per second:  42.26K. Total:   3.81M
[0006] Write key rate per second:  41.33K. Total:   4.22M
[0007] Write key rate per second:  39.98K. Total:   4.62M
[0008] Write key rate per second:  37.71K. Total:   5.00M
[0009] Write key rate per second:  35.04K. Total:   5.35M
[0010] Write key rate per second:  33.45K. Total:   5.69M
[0011] Write key rate per second:  29.64K. Total:   6.00M
[0012] Write key rate per second:  31.91K. Total:   6.34M
[0013] Write key rate per second:  32.79K. Total:   6.66M
[0014] Write key rate per second:  29.48K. Total:   6.98M
[0015] Write key rate per second:  29.73K. Total:   7.29M
[0016] Write key rate per second:  31.56K. Total:   7.63M
[0017] Write key rate per second:  34.41K. Total:   7.99M
[0018] Write key rate per second:  33.28K. Total:   8.34M
[0019] Write key rate per second:  34.68K. Total:   8.68M
[0020] Write key rate per second:  34.44K. Total:   9.03M
[0021] Write key rate per second:  33.31K. Total:   9.38M
[0022] Write key rate per second:  32.82K. Total:   9.73M
[0023] Write key rate per second:  33.26K. Total:  10.00M
real    3m58.995s
user    7m13.985s
sys     0m34.457s

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          91.17    0.00    8.02    0.00    0.00    0.80

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
nvme1n1           0.00         0.00         0.00          0          0
nvme0n1           8.50         0.00         1.83          0         18

369M

> time go run populate/main.go --kv rocksdb --valsz 0 --keys_mil 10 --dir=$DATADIREBS --batchsize 150 -n 32 -read -history
[0000] Write key rate per second: 204.33K. Total:   2.27M
[0001] Write key rate per second:  81.12K. Total:   3.13M
[0002] Write key rate per second:  63.26K. Total:   3.81M
[0003] Write key rate per second:  56.56K. Total:   4.40M
[0004] Write key rate per second:  41.30K. Total:   4.85M
[0005] Write key rate per second:  89.03K. Total:   5.76M
[0006] Write key rate per second:  82.44K. Total:   6.58M
[0007] Write key rate per second:  59.13K. Total:   7.21M
[0008] Write key rate per second:  55.16K. Total:   7.79M
[0009] Write key rate per second:  45.57K. Total:   8.27M
[0010] Write key rate per second:  46.34K. Total:   8.73M
[0011] Write key rate per second:  38.55K. Total:   9.12M
[0012] Write key rate per second:  33.03K. Total:   9.47M
[0013] Write key rate per second:  39.09K. Total:   9.87M
[0014] Write key rate per second:  48.51K. Total:  10.00M
real    2m22.511s
user    3m59.418s
sys     0m32.870s

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          84.22    0.00   11.07    0.10    0.00    4.61

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
nvme1n1           0.00         0.00         0.00          0          0
nvme0n1          33.20         0.00         7.69          0         76

332M

> time go run populate/main.go --kv badger --valsz 0 --keys_mil 10 --dir=$DATADIREBS --batchsize 150 -n 32 -read -history

> time go run populate/main.go --kv bolt --valsz 0 --keys_mil 10 --dir=$DATADIREBS --batchsize 150 -n 32 -read -history



--- 32c 10M Random w/ 1-off Read (EBS) ---



> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 10 --dir=$DATADIREBS -read -read-other
[0000] Write key rate per second: 213.40K. Total:   2.13M
[0001] Write key rate per second: 175.30K. Total:   3.89M
[0002] Write key rate per second: 162.60K. Total:   5.51M
[0003] Write key rate per second: 147.30K. Total:   6.99M
[0004] Write key rate per second: 150.90K. Total:   8.49M
[0005] Write key rate per second: 139.10K. Total:   9.89M
[0006] Write key rate per second: 140.20K. Total:  10.02M
real    1m1.951s
user    0m45.481s
sys     0m20.846s

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          33.20    0.00   18.93   14.17    0.00   33.71

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
nvme1n1           0.00         0.00         0.00          0          0
nvme0n1         473.70         0.00        74.01          0        740

651M

> time go run populate/main.go --kv rocksdb --valsz 0 --keys_mil 10 --dir=$DATADIREBS -read -read-other
[0000] Write key rate per second: 258.40K. Total:   2.58M
[0001] Write key rate per second: 155.30K. Total:   4.14M
[0002] Write key rate per second: 118.00K. Total:   5.32M
[0003] Write key rate per second:  97.90K. Total:   6.30M
[0004] Write key rate per second:  77.50K. Total:   7.08M
[0005] Write key rate per second: 147.50K. Total:   8.56M
[0006] Write key rate per second: 111.60K. Total:   9.74M
[0007] Write key rate per second: 105.50K. Total:  10.02M
real    1m13.591s
user    2m13.407s
sys     0m8.088s

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          90.65    0.00    8.45    0.05    0.00    0.85

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
nvme1n1           0.00         0.00         0.00          0          0
nvme0n1          26.80         0.00         6.44          0         64

186M

> time go run populate/main.go --kv badger --valsz 0 --keys_mil 10 --dir=$DATADIREBS -read -read-other

> time go run populate/main.go --kv leveldb --valsz 0 --keys_mil 10 --dir=$DATADIREBS -read -read-other
[0000] Write key rate per second: 127.40K. Total:   1.27M
[0001] Write key rate per second:  93.70K. Total:   2.22M
[0002] Write key rate per second:  79.80K. Total:   3.02M
[0003] Write key rate per second:  70.00K. Total:   3.73M
[0004] Write key rate per second:  64.90K. Total:   4.38M
[0005] Write key rate per second:  59.70K. Total:   4.98M
[0006] Write key rate per second:  55.80K. Total:   5.54M
[0007] Write key rate per second:  50.40K. Total:   6.05M
[0008] Write key rate per second:  46.40K. Total:   6.52M
[0009] Write key rate per second:  47.30K. Total:   6.99M
[0010] Write key rate per second:  46.00K. Total:   7.45M
[0011] Write key rate per second:  46.20K. Total:   7.91M
[0012] Write key rate per second:  45.60K. Total:   8.37M
[0013] Write key rate per second:  45.90K. Total:   8.84M
[0014] Write key rate per second:  47.40K. Total:   9.31M
[0015] Write key rate per second:  45.00K. Total:   9.76M
[0016] Write key rate per second:  45.80K. Total:  10.02M
real    2m46.136s
user    5m6.950s
sys     0m13.556s

213M

> time go run populate/main.go --kv bolt --valsz 0 --keys_mil 10 --dir=$DATADIREBS -read -read-other



--- 10M Random w/ Concurrency 1 w/ Batch Size 100 w/ 1-off Read (NVME) ---



> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 10 --dir=$DATADIR --read -batchsize 100 -n 1
[0000] Write key rate per second: 245.61K. Total:   2.46M
[0001] Write key rate per second: 195.82K. Total:   4.41M
[0002] Write key rate per second: 186.68K. Total:   6.28M
[0003] Write key rate per second: 180.26K. Total:   8.08M
[0004] Write key rate per second: 177.23K. Total:   9.86M
[0005] Write key rate per second: 173.76K. Total:  10.00M
real    0m51.755s
user    0m29.500s
sys     0m23.519s

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          27.20    0.00   24.42   22.59    0.00   25.79

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
nvme1n1        1058.20         0.00       104.28          0       1042
nvme0n1           0.00         0.00         0.00          0          0
nvme2n1           0.00         0.00         0.00          0          0

368M

> time go run populate/main.go --kv rocksdb --valsz 0 --keys_mil 10 --dir=$DATADIR --read -batchsize 100 -n 1
[0000] Write key rate per second: 221.57K. Total:   2.22M
[0001] Write key rate per second:  99.09K. Total:   3.21M
[0002] Write key rate per second:  67.92K. Total:   3.89M
[0003] Write key rate per second:  63.88K. Total:   4.53M
[0004] Write key rate per second:  50.53K. Total:   5.03M
[0005] Write key rate per second:  47.77K. Total:   5.51M
[0006] Write key rate per second:  46.50K. Total:   5.97M
[0007] Write key rate per second:  57.61K. Total:   6.55M
[0008] Write key rate per second: 103.26K. Total:   7.58M
[0009] Write key rate per second:  70.03K. Total:   8.28M
[0010] Write key rate per second:  63.87K. Total:   8.92M
[0011] Write key rate per second:  54.34K. Total:   9.47M
[0012] Write key rate per second:  48.05K. Total:   9.95M
[0013] Write key rate per second:  46.09K. Total:  10.00M
real    2m12.064s
user    2m5.190s
sys     0m18.119s

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          47.83    0.00    7.16    0.10    0.05   44.86

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
nvme1n1          48.80         0.00         5.92          0         59
nvme0n1           0.50         0.00         0.00          0          0
nvme2n1           0.00         0.00         0.00          0          0

185M

> time go run populate/main.go --kv leveldb --valsz 0 --keys_mil 10 --dir=$DATADIR --read -batchsize 100 -n 1
[0000] Write key rate per second: 104.77K. Total:   1.23M
[0001] Write key rate per second:  71.69K. Total:   1.97M
[0002] Write key rate per second:  65.74K. Total:   2.66M
[0003] Write key rate per second:  57.62K. Total:   3.25M
[0004] Write key rate per second:  58.96K. Total:   3.84M
[0005] Write key rate per second:  50.67K. Total:   4.37M
[0006] Write key rate per second:  45.61K. Total:   4.85M
[0007] Write key rate per second:  43.95K. Total:   5.33M
[0008] Write key rate per second:  44.39K. Total:   5.80M
[0009] Write key rate per second:  41.15K. Total:   6.23M
[0010] Write key rate per second:  41.84K. Total:   6.67M
[0011] Write key rate per second:  39.54K. Total:   7.08M
[0012] Write key rate per second:  38.43K. Total:   7.48M
[0013] Write key rate per second:  38.75K. Total:   7.90M
[0014] Write key rate per second:  36.48K. Total:   8.28M
[0015] Write key rate per second:  36.91K. Total:   8.67M
[0016] Write key rate per second:  36.35K. Total:   9.05M
[0017] Write key rate per second:  36.21K. Total:   9.43M
[0018] Write key rate per second:  35.19K. Total:   9.80M
[0019] Write key rate per second:  36.62K. Total:  10.00M
real    3m16.409s
user    5m32.472s
sys     0m26.894s

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          91.36    0.00    7.58    0.15    0.00    0.90

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
nvme1n1          63.70         0.00         7.52          0         75
nvme0n1           0.00         0.00         0.00          0          0
nvme2n1           0.00         0.00         0.00          0          0

214M



--- 32c 100M Random w/ key size 12 (NVME) ---



> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 100 --dir=$DATADIR --read -keysz 12
[0000] Write key rate per second: 286.80K. Total:   2.87M
[0001] Write key rate per second: 226.30K. Total:   5.13M
[0002] Write key rate per second: 209.90K. Total:   7.23M
[0003] Write key rate per second: 196.00K. Total:   9.19M
[0004] Write key rate per second: 192.80K. Total:  11.12M
[0005] Write key rate per second: 182.40K. Total:  12.94M
[0006] Write key rate per second: 175.60K. Total:  14.70M
[0007] Write key rate per second: 172.10K. Total:  16.42M
[0008] Write key rate per second: 161.90K. Total:  18.12M
[0009] Write key rate per second: 168.80K. Total:  19.81M
[0010] Write key rate per second: 170.10K. Total:  21.51M
[0011] Write key rate per second: 158.60K. Total:  23.18M
[0012] Write key rate per second: 159.70K. Total:  24.78M
-------------------------- SNIP -------------------------
[0053] Write key rate per second: 134.00K. Total:  83.66M
[0054] Write key rate per second: 137.50K. Total:  85.04M
[0055] Write key rate per second: 133.40K. Total:  86.37M
[0056] Write key rate per second: 132.50K. Total:  87.70M
[0057] Write key rate per second: 136.80K. Total:  89.06M
[0058] Write key rate per second: 132.20K. Total:  90.39M
[0059] Write key rate per second: 135.80K. Total:  91.75M
[0060] Write key rate per second: 131.60K. Total:  93.06M
[0061] Write key rate per second: 131.40K. Total:  94.38M
[0062] Write key rate per second: 135.80K. Total:  95.73M
[0063] Write key rate per second: 130.70K. Total:  97.04M
[0064] Write key rate per second: 134.40K. Total:  98.39M
[0065] Write key rate per second: 123.20K. Total:  99.69M
[0066] Write key rate per second: 127.80K. Total: 100.00M
real    11m3.336s
user    6m25.098s
sys     5m13.172s

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          28.41    0.00   25.62   36.36    0.00    9.61

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
nvme1n1        2297.50         0.00       155.01          0       1550
nvme0n1           0.60         0.00         0.00          0          0
nvme2n1           0.00         0.00         0.00          0          0

3.1G


> time go run populate/main.go --kv rocksdb --valsz 0 --keys_mil 100 --dir=$DATADIR -keysz 12
[0000] Write key rate per second: 666.00K. Total:   7.15M
[0001] Write key rate per second: 601.20K. Total:  13.17M
[0002] Write key rate per second: 563.00K. Total:  19.15M
[0003] Write key rate per second: 573.90K. Total:  24.85M
[0004] Write key rate per second: 567.90K. Total:  30.86M
[0005] Write key rate per second: 547.60K. Total:  36.63M
[0006] Write key rate per second: 587.50K. Total:  42.51M
[0007] Write key rate per second: 585.50K. Total:  48.38M
[0008] Write key rate per second: 555.90K. Total:  54.22M
[0009] Write key rate per second: 577.00K. Total:  59.98M
[0010] Write key rate per second: 548.70K. Total:  65.47M
[0011] Write key rate per second: 103.50K. Total:  66.50M
[0012] Write key rate per second: 210.20K. Total:  68.61M
[0013] Write key rate per second: 561.60K. Total:  74.50M
[0014] Write key rate per second: 583.20K. Total:  80.33M
[0015] Write key rate per second: 588.10K. Total:  86.22M
[0016] Write key rate per second: 545.10K. Total:  91.93M
[0017] Write key rate per second: 271.90K. Total:  94.65M
[0018] Write key rate per second: 562.70K. Total: 100.00M
real    3m10.626s
user    5m46.685s
sys     0m13.423s

1.5G



--- 16c 100M Random w/ 16 Partitions (NVME) ---



> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 100 --dir=$DATADIR -keysz 16 -n 16 -p
[0000] Write key rate per second: 453.40K. Total:   5.13M
[0001] Write key rate per second: 383.40K. Total:   8.95M
[0002] Write key rate per second: 339.10K. Total:  12.53M
[0003] Write key rate per second: 348.40K. Total:  16.01M
[0004] Write key rate per second: 333.50K. Total:  19.35M
[0005] Write key rate per second: 308.00K. Total:  22.60M
[0006] Write key rate per second: 323.20K. Total:  25.83M
[0007] Write key rate per second: 316.30K. Total:  28.99M
[0008] Write key rate per second: 316.80K. Total:  32.16M
[0009] Write key rate per second: 307.10K. Total:  35.24M
[0010] Write key rate per second: 288.30K. Total:  38.12M
[0011] Write key rate per second: 285.20K. Total:  40.97M
[0012] Write key rate per second: 281.80K. Total:  43.79M
-------------------------- SNIP -------------------------
[0023] Write key rate per second: 255.10K. Total:  73.58M
[0024] Write key rate per second: 251.80K. Total:  76.09M
[0025] Write key rate per second: 250.50K. Total:  78.60M
[0026] Write key rate per second: 249.40K. Total:  81.09M
[0027] Write key rate per second: 247.40K. Total:  83.57M
[0028] Write key rate per second: 245.90K. Total:  86.03M
[0029] Write key rate per second: 246.70K. Total:  88.49M
[0030] Write key rate per second: 244.20K. Total:  90.94M
[0031] Write key rate per second: 229.20K. Total:  93.23M
[0032] Write key rate per second: 199.70K. Total:  95.23M
[0033] Write key rate per second: 171.60K. Total:  96.94M
[0034] Write key rate per second: 152.10K. Total:  98.47M
[0035] Write key rate per second: 138.00K. Total:  99.85M
real    6m1.577s
user    5m55.641s
sys     5m13.808s

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          51.41    0.00   47.28    1.06    0.00    0.25

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
nvme1n1        1370.20         0.00       155.01          0       1550
nvme0n1           0.00         0.00         0.00          0          0
nvme2n1           0.00         0.00         0.00          0          0

3.8G

> time go run populate/main.go --kv rocksdb --valsz 0 --keys_mil 100 --dir=$DATADIR -keysz 12 -n 16 -p
[0000] Write key rate per second: 723.90K. Total:   7.88M
[0001] Write key rate per second: 588.30K. Total:  14.10M
[0002] Write key rate per second: 543.30K. Total:  19.84M
[0003] Write key rate per second: 513.50K. Total:  25.24M
[0004] Write key rate per second: 513.90K. Total:  30.64M
[0005] Write key rate per second: 599.30K. Total:  37.05M
[0006] Write key rate per second: 492.80K. Total:  42.23M
[0007] Write key rate per second: 478.40K. Total:  47.27M
[0008] Write key rate per second: 446.30K. Total:  51.99M
[0009] Write key rate per second: 468.20K. Total:  56.86M
[0010] Write key rate per second: 540.60K. Total:  62.53M
[0011] Write key rate per second: 554.30K. Total:  68.34M
[0012] Write key rate per second: 507.30K. Total:  73.41M
[0013] Write key rate per second: 464.10K. Total:  78.33M
[0014] Write key rate per second: 473.60K. Total:  83.32M
[0015] Write key rate per second: 490.70K. Total:  88.50M
[0016] Write key rate per second: 584.30K. Total:  94.55M
real    3m0.744s
user    5m43.618s
sys     0m15.299s

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          94.89    0.00    5.01    0.00    0.00    0.10

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
nvme1n1         104.40         0.00        12.51          0        125
nvme0n1           0.00         0.00         0.00          0          0
nvme2n1           0.00         0.00         0.00          0          0

3.0G


--- 32c 1B Random w/ Key Size 12 (NVME) ---



> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 1000 --dir=$DATADIR -keysz 12 -n 1
[0000] Write key rate per second: 335.20K. Total:   3.35M
[0001] Write key rate per second: 260.40K. Total:   5.96M
[0002] Write key rate per second: 236.60K. Total:   8.32M
[0003] Write key rate per second: 229.70K. Total:  10.62M
[0004] Write key rate per second: 217.20K. Total:  12.79M
[0005] Write key rate per second: 203.00K. Total:  14.82M
[0006] Write key rate per second: 196.70K. Total:  16.79M
[0007] Write key rate per second: 195.60K. Total:  18.74M
[0008] Write key rate per second: 192.70K. Total:  20.67M
[0009] Write key rate per second: 190.50K. Total:  22.58M
[0010] Write key rate per second: 188.80K. Total:  24.46M
[0011] Write key rate per second: 182.90K. Total:  26.29M
[0012] Write key rate per second: 178.40K. Total:  28.08M
-------------------------- SNIP -------------------------
[0154] Write key rate per second:  70.10K. Total: 194.15M
[0155] Write key rate per second:  69.90K. Total: 194.85M
[0156] Write key rate per second:  70.20K. Total: 195.55M
[0157] Write key rate per second:  68.80K. Total: 196.24M
[0158] Write key rate per second:  69.20K. Total: 196.93M
[0159] Write key rate per second:  68.90K. Total: 197.62M
[0160] Write key rate per second:  68.80K. Total: 198.31M
[0161] Write key rate per second:  68.60K. Total: 199.00M
[0162] Write key rate per second:  68.40K. Total: 199.68M
[0163] Write key rate per second:  68.30K. Total: 200.37M
[0164] Write key rate per second:  68.00K. Total: 201.04M
[0165] Write key rate per second:  67.70K. Total: 201.72M
[0166] Write key rate per second:  67.60K. Total: 202.40M
real    27m56.054s
user    10m57.464s
sys     11m6.444s

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          12.48    0.00   12.64   52.82    0.00   22.06

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
nvme1n1       11572.30         0.00       155.01          0       1550
nvme0n1           0.00         0.00         0.00          0          0
nvme2n1           0.00         0.00         0.00          0          0

6.2G (Aborted at 20%)

> time go run populate/main.go --kv rocksdb --valsz 0 --keys_mil 1000 --dir=$DATADIR -keysz 12
[0000] Write key rate per second: 711.50K. Total:   7.12M
[0001] Write key rate per second: 609.30K. Total:  13.22M
[0002] Write key rate per second: 600.30K. Total:  19.24M
[0003] Write key rate per second: 595.50K. Total:  25.23M
[0004] Write key rate per second: 558.10K. Total:  31.12M
[0005] Write key rate per second: 563.20K. Total:  37.04M
[0006] Write key rate per second: 591.30K. Total:  42.95M
[0007] Write key rate per second: 578.10K. Total:  48.74M
[0008] Write key rate per second: 560.60K. Total:  54.35M
[0009] Write key rate per second: 514.00K. Total:  59.50M
[0010] Write key rate per second: 539.20K. Total:  65.16M
[0011] Write key rate per second: 277.30K. Total:  67.93M
[0012] Write key rate per second:  89.10K. Total:  68.82M
-------------------------- SNIP -------------------------
[0341] Write key rate per second:  98.10K. Total: 983.68M
[0342] Write key rate per second:  99.90K. Total: 984.68M
[0343] Write key rate per second: 101.70K. Total: 985.69M
[0344] Write key rate per second: 106.20K. Total: 986.75M
[0345] Write key rate per second: 105.30K. Total: 987.81M
[0346] Write key rate per second: 108.00K. Total: 988.89M
[0347] Write key rate per second:  79.20K. Total: 989.68M
[0348] Write key rate per second:  71.10K. Total: 990.39M
[0349] Write key rate per second:  67.50K. Total: 991.07M
[0350] Write key rate per second:  45.90K. Total: 991.52M
[0351] Write key rate per second: 190.80K. Total: 993.43M
[0352] Write key rate per second: 584.70K. Total: 999.29M
[0353] Write key rate per second: 566.80K. Total: 1000.00M
real    58m52.651s
user    85m45.790s
sys     3m58.925s

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          54.83    0.00    3.60    0.90    0.00   40.67

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
nvme1n1         303.90         0.00        37.59          0        375
nvme0n1           0.10         0.00         0.00          0          0
nvme2n1           0.00         0.00         0.00          0          0

13G



--- 1c 100M Random w/ Key Size 12 (EBS) ---



> time go run populate/main.go --kv rocksdb --valsz 0 --keys_mil 100 --dir=$DATADIREBS -keysz 12
[0000] Write key rate per second: 709.30K. Total:   7.09M
[0001] Write key rate per second: 594.40K. Total:  13.04M
[0002] Write key rate per second: 567.70K. Total:  19.09M
[0003] Write key rate per second: 588.10K. Total:  24.97M
[0004] Write key rate per second: 536.90K. Total:  30.64M
[0005] Write key rate per second: 589.20K. Total:  36.54M
[0006] Write key rate per second: 548.70K. Total:  42.33M
[0007] Write key rate per second: 559.80K. Total:  48.21M
[0008] Write key rate per second: 587.00K. Total:  54.08M
[0009] Write key rate per second: 565.80K. Total:  59.74M
[0010] Write key rate per second: 575.10K. Total:  65.51M
[0011] Write key rate per second: 137.50K. Total:  66.89M
[0012] Write key rate per second: 101.70K. Total:  67.91M
[0013] Write key rate per second: 558.80K. Total:  73.69M
[0014] Write key rate per second: 573.60K. Total:  79.41M
[0015] Write key rate per second: 546.90K. Total:  85.11M
[0016] Write key rate per second: 531.80K. Total:  90.70M
[0017] Write key rate per second: 207.20K. Total:  92.77M
[0018] Write key rate per second: 559.60K. Total:  98.40M
[0019] Write key rate per second: 550.60K. Total: 100.00M
real    3m14.722s
user    5m48.571s
sys     0m13.397s

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          95.15    0.00    2.95    1.05    0.00    0.85

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
nvme1n1           0.00         0.00         0.00          0          0
nvme0n1         107.20         0.00        25.53          0        255
nvme2n1           0.00         0.00         0.00          0          0

1.5G

> time go run populate/main.go --kv badger --valsz 0 --keys_mil 100 --dir=$DATADIREBS -keysz 12
[0000] Write key rate per second: 407.60K. Total:   4.08M
[0001] Write key rate per second: 345.50K. Total:   7.54M
[0002] Write key rate per second: 345.60K. Total:  10.99M
[0003] Write key rate per second: 313.50K. Total:  14.13M
[0004] Write key rate per second: 222.80K. Total:  16.36M
[0005] Write key rate per second: 317.40K. Total:  19.53M
[0006] Write key rate per second: 265.20K. Total:  22.18M
[0007] Write key rate per second: 252.80K. Total:  24.71M
[0008] Write key rate per second: 254.20K. Total:  27.26M
[0009] Write key rate per second: 218.10K. Total:  29.44M
[0010] Write key rate per second: 229.80K. Total:  31.74M
[0011] Write key rate per second: 223.40K. Total:  33.98M
[0012] Write key rate per second: 256.60K. Total:  36.55M
-------------------------- SNIP -------------------------
[0028] Write key rate per second: 243.40K. Total:  69.73M
[0029] Write key rate per second: 213.90K. Total:  72.00M
[0030] Write key rate per second: 222.60K. Total:  74.35M
[0031] Write key rate per second: 176.90K. Total:  76.28M
[0032] Write key rate per second:  0.00. Total:  76.28M
[0033] Write key rate per second:  0.00. Total:  76.28M
[0034] Write key rate per second:  72.30K. Total:  77.00M
[0035] Write key rate per second: 253.30K. Total:  79.65M
[0036] Write key rate per second: 240.20K. Total:  82.15M
[0037] Write key rate per second: 221.90K. Total:  84.48M
[0038] Write key rate per second: 216.20K. Total:  86.73M
2020/02/03 10:39:32 writeRequests: Unable to write to value log file: "/data-ebs/badger/000088.vlog": write /data-ebs/badger/000088.vlog: no space left on device
2020/02/03 10:39:32 write /data-ebs/badger/000088.vlog: no space left on device
Unable to write to value log file: "/data-ebs/badger/000088.vlog"
github.com/dgraph-io/badger.(*valueLog).write.func1
        /home/ec2-user/go/pkg/mod/github.com/dgraph-io/badger@v1.6.0/value.go:998
github.com/dgraph-io/badger.(*valueLog).write
        /home/ec2-user/go/pkg/mod/github.com/dgraph-io/badger@v1.6.0/value.go:1060
github.com/dgraph-io/badger.(*DB).writeRequests
        /home/ec2-user/go/pkg/mod/github.com/dgraph-io/badger@v1.6.0/db.go:619
github.com/dgraph-io/badger.(*DB).doWrites.func1
        /home/ec2-user/go/pkg/mod/github.com/dgraph-io/badger@v1.6.0/db.go:692
runtime.goexit
        /usr/local/go/src/runtime/asm_amd64.s:1357

github.com/dgraph-io/badger/y.Wrap
        /home/ec2-user/go/pkg/mod/github.com/dgraph-io/badger@v1.6.0/y/error.go:71
github.com/dgraph-io/badger/y.Check
        /home/ec2-user/go/pkg/mod/github.com/dgraph-io/badger@v1.6.0/y/error.go:43
main.writeBatch
        /home/ec2-user/badger-bench/populate/main.go:142
main.main.func7
        /home/ec2-user/badger-bench/populate/main.go:536
runtime.goexit
        /usr/local/go/src/runtime/asm_amd64.s:1357
exit status 1
real    6m38.055s
user    12m8.163s
sys     0m30.484s

8.9G before crash



--- HEADS UP : Full Workload - i3.large vs a1.large vs c5.large (EBS) ---

A1 is 66% as performant as i3 for 33% the cost.
C5 is 92% as performant as i3 for 50% the cost.
A1 is 72% as performant as c5 for 60% the cost.



> time go run populate/main.go --kv rocksdb --valsz 0 --keys_mil 100 --dir=$DATADIREBS -keysz 12 -read -read-other -n 16 -p
[0000] Write key rate per second: 348.40K. Total:   3.72M
[0001] Write key rate per second: 323.90K. Total:   6.95M
[0002] Write key rate per second: 308.60K. Total:  10.03M
[0003] Write key rate per second: 298.20K. Total:  13.02M
[0004] Write key rate per second: 290.70K. Total:  15.93M
[0005] Write key rate per second: 283.60K. Total:  18.78M
[0006] Write key rate per second: 277.90K. Total:  21.57M
[0007] Write key rate per second: 261.60K. Total:  24.33M
[0008] Write key rate per second: 258.10K. Total:  27.04M
[0009] Write key rate per second: 247.40K. Total:  29.51M
[0010] Write key rate per second: 211.00K. Total:  31.73M
[0011] Write key rate per second: 204.80K. Total:  33.77M
[0012] Write key rate per second: 189.30K. Total:  35.67M
-------------------------- SNIP -------------------------
[0037] Write key rate per second: 165.70K. Total:  82.08M
[0038] Write key rate per second: 164.10K. Total:  83.72M
[0039] Write key rate per second: 163.40K. Total:  85.36M
[0040] Write key rate per second: 152.50K. Total:  86.88M
[0041] Write key rate per second: 128.80K. Total:  88.24M
[0042] Write key rate per second: 129.60K. Total:  89.61M
[0043] Write key rate per second: 130.20K. Total:  90.91M
[0044] Write key rate per second: 148.60K. Total:  92.40M
[0045] Write key rate per second: 147.10K. Total:  93.87M
[0046] Write key rate per second: 148.60K. Total:  95.37M
[0047] Write key rate per second: 134.00K. Total:  96.79M
[0048] Write key rate per second: 143.30K. Total:  98.23M
[0049] Write key rate per second: 127.50K. Total:  99.50M
real    8m26.464s
user    15m59.213s
sys     0m26.563s

2.7G

> time go run populate/main.go --kv rocksdb --valsz 0 --keys_mil 100 --dir=$DATADIREBS -keysz 12 -read -read-other -n 16 -p
[0000] Write key rate per second: 245.10K. Total:   2.63M
[0001] Write key rate per second: 232.10K. Total:   4.95M
[0002] Write key rate per second: 223.00K. Total:   7.19M
[0003] Write key rate per second: 217.50K. Total:   9.37M
[0004] Write key rate per second: 202.80K. Total:  11.51M
[0005] Write key rate per second: 208.60K. Total:  13.59M
[0006] Write key rate per second: 207.20K. Total:  15.67M
[0007] Write key rate per second: 204.20K. Total:  17.73M
[0008] Write key rate per second: 202.50K. Total:  19.75M
[0009] Write key rate per second: 200.00K. Total:  21.76M
[0010] Write key rate per second: 198.50K. Total:  23.75M
[0011] Write key rate per second: 196.30K. Total:  25.72M
[0012] Write key rate per second: 189.30K. Total:  27.61M
-------------------------- SNIP -------------------------
[0061] Write key rate per second:  97.60K. Total:  88.10M
[0062] Write key rate per second:  98.50K. Total:  89.09M
[0063] Write key rate per second:  98.10K. Total:  90.08M
[0064] Write key rate per second:  95.70K. Total:  91.04M
[0065] Write key rate per second:  99.40K. Total:  92.04M
[0066] Write key rate per second:  94.60K. Total:  93.00M
[0067] Write key rate per second:  98.20K. Total:  93.98M
[0068] Write key rate per second:  96.70K. Total:  94.96M
[0069] Write key rate per second:  92.30K. Total:  95.89M
[0070] Write key rate per second:  93.70K. Total:  96.84M
[0071] Write key rate per second:  89.10K. Total:  97.73M
[0072] Write key rate per second:  83.60K. Total:  98.57M
[0073] Write key rate per second:  68.30K. Total:  99.26M
[0074] Write key rate per second:  47.80K. Total:  99.74M
real    12m40.151s
user    23m13.383s
sys     0m45.570s

2.7G

> time go run populate/main.go --kv rocksdb --valsz 0 --keys_mil 100 --dir=$DATADIREBS -keysz 12 -read -read-other -n 16 -p
[0000] Write key rate per second: 342.00K. Total:   3.42M
[0001] Write key rate per second: 279.80K. Total:   6.40M
[0002] Write key rate per second: 268.60K. Total:   9.24M
[0003] Write key rate per second: 278.10K. Total:  12.02M
[0004] Write key rate per second: 254.60K. Total:  14.71M
[0005] Write key rate per second: 264.60K. Total:  17.34M
[0006] Write key rate per second: 260.30K. Total:  19.95M
[0007] Write key rate per second: 258.40K. Total:  22.54M
[0008] Write key rate per second: 253.20K. Total:  25.08M
[0009] Write key rate per second: 249.90K. Total:  27.58M
[0010] Write key rate per second: 221.60K. Total:  29.80M
[0011] Write key rate per second: 193.40K. Total:  31.84M
[0012] Write key rate per second: 175.70K. Total:  33.70M
-------------------------- SNIP -------------------------
[0041] Write key rate per second: 151.00K. Total:  83.43M
[0042] Write key rate per second: 141.40K. Total:  84.92M
[0043] Write key rate per second: 140.50K. Total:  86.41M
[0044] Write key rate per second: 119.20K. Total:  87.66M
[0045] Write key rate per second: 121.10K. Total:  88.87M
[0046] Write key rate per second: 120.80K. Total:  90.14M
[0047] Write key rate per second: 130.70K. Total:  91.45M
[0048] Write key rate per second: 135.50K. Total:  92.81M
[0049] Write key rate per second: 133.50K. Total:  94.22M
[0050] Write key rate per second: 131.80K. Total:  95.54M
[0051] Write key rate per second: 136.20K. Total:  96.91M
[0052] Write key rate per second: 123.20K. Total:  98.14M
[0053] Write key rate per second: 117.70K. Total:  99.32M
real    9m8.495s
user    17m22.572s
sys     0m27.748s

2.7G



--- Loaded Database Test - Adding 100M keys to DB w/ 5B Keys - w/ 1:1 Read w/ 16 Partitions w/ 256M buckets w/ Key Size 12 (EBS) ---

Existing Database is 76G


> time go run populate/main.go --kv rocksdb --valsz 0 --keys_mil 100 --dir=$DATADIREBS -keysz 12 -read -n 16 -p -a
Initialized after 2.392146559s
[0000] Write key rate per second:  0.00. Total:  0.00
[0001] Write key rate per second:  0.00. Total:  0.00
[0002] Write key rate per second:  0.00. Total:  0.00
[0003] Write key rate per second:  0.00. Total:  0.00
[0004] Write key rate per second:  0.00. Total:  0.00
[0005] Write key rate per second:  0.00. Total:  0.00
[0006] Write key rate per second: 100.00. Total:   1.00K
[0007] Write key rate per second:  0.00. Total:   1.00K
[0008] Write key rate per second:  0.00. Total:   1.00K
[0009] Write key rate per second:  0.00. Total:   1.00K
[0010] Write key rate per second: 100.00. Total:   2.00K
[0011] Write key rate per second: 100.00. Total:   3.00K
[0012] Write key rate per second: 500.00. Total:   8.00K
-------------------------- SNIP -------------------------
[0057] Write key rate per second: 400.00. Total: 156.00K
[0058] Write key rate per second: 700.00. Total: 163.00K
[0059] Write key rate per second: 500.00. Total: 168.00K
[0060] Write key rate per second: 500.00. Total: 173.00K
[0061] Write key rate per second: 600.00. Total: 179.00K
[0062] Write key rate per second: 500.00. Total: 184.00K
[0063] Write key rate per second: 500.00. Total: 189.00K
[0064] Write key rate per second: 600.00. Total: 195.00K
[0065] Write key rate per second: 400.00. Total: 199.00K
[0066] Write key rate per second: 500.00. Total: 204.00K
[0067] Write key rate per second: 700.00. Total: 211.00K
[0068] Write key rate per second: 400.00. Total: 215.00K
[0069] Write key rate per second: 500.00. Total: 221.00K
real    11m51.121s
user    10m53.119s
sys     1m57.775s

Well, that was a mistake.
We'll need to bucket.



--- 100M Keys w/ 4 Byte Buckets w/ 1:1 Read w/ 16 Partitions w/ 256M buckets w/ Key Size 12 w/ History (EBS) ---



> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 100 --dir=$DATADIREBS -keysz 12 -read -n 16 -p -history
[0000] Write key rate per second: 270.90K. Total:   2.96M    Scan Rate: 339.00
[0001] Write key rate per second: 215.90K. Total:   5.23M    Scan Rate: 732.00
[0002] Write key rate per second: 202.50K. Total:   7.38M    Scan Rate:   1.10K
[0003] Write key rate per second: 203.50K. Total:   9.41M    Scan Rate:   1.36K
[0004] Write key rate per second: 184.70K. Total:  11.34M    Scan Rate:   1.53K
[0005] Write key rate per second: 180.70K. Total:  13.24M    Scan Rate:   1.85K
[0006] Write key rate per second: 189.60K. Total:  15.13M    Scan Rate:   2.16K
[0007] Write key rate per second: 177.90K. Total:  17.01M    Scan Rate:   2.26K
[0008] Write key rate per second: 178.20K. Total:  18.87M    Scan Rate:   2.62K
[0009] Write key rate per second: 182.30K. Total:  20.69M    Scan Rate:   2.80K
[0010] Write key rate per second: 172.80K. Total:  22.51M    Scan Rate:   2.97K
[0011] Write key rate per second: 170.40K. Total:  24.30M    Scan Rate:   3.26K
[0012] Write key rate per second: 168.80K. Total:  26.08M    Scan Rate:   3.53K
-------------------------- SNIP -------------------------
[0173] Write key rate per second:   1.40K. Total:  49.67M    Scan Rate: 53.00
[0174] Write key rate per second: 900.00.  Total:  49.68M    Scan Rate: 20.00
[0175] Write key rate per second:   1.30K. Total:  49.69M    Scan Rate: 58.00
[0176] Write key rate per second:   1.00K. Total:  49.70M    Scan Rate: 23.00
[0177] Write key rate per second: 600.00.  Total:  49.71M    Scan Rate: 36.00
[0178] Write key rate per second:   1.70K. Total:  49.72M    Scan Rate: 42.00
[0179] Write key rate per second: 400.00.  Total:  49.73M    Scan Rate: 12.00
[0180] Write key rate per second:   1.50K. Total:  49.74M    Scan Rate: 63.00
[0181] Write key rate per second: 900.00.  Total:  49.75M    Scan Rate: 38.00
[0182] Write key rate per second:   1.40K. Total:  49.77M    Scan Rate: 42.00
[0183] Write key rate per second: 500.00.  Total:  49.77M    Scan Rate: 11.00
[0184] Write key rate per second:   1.70K. Total:  49.79M    Scan Rate: 66.00
[0185] Write key rate per second: 800.00.  Total:  49.80M    Scan Rate: 20.00
real    31m10.698s
user    5m24.652s
sys     2m55.949s

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
           0.00    0.00    0.05   99.95    0.00    0.00

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
nvme0n1           0.00         0.00         0.00          0          0
nvme1n1         437.80         0.00         4.60          0         46

(EBS Volume Burst Balance exhausted - 300iops for 100gb disk)



--- 100M Keys w/ 4 Byte Buckets w/ 1:1 Read w/ 16 Partitions w/ 256M buckets w/ 16 Volumes w/ Key Size 12 w/ History (EBS) ---



> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 100 --dir=$DATADIREBS -keysz 12 -read -n 16 -p -history
/data-ebs/0/lmdb
/data-ebs/1/lmdb
/data-ebs/2/lmdb
/data-ebs/3/lmdb
/data-ebs/4/lmdb
/data-ebs/5/lmdb
/data-ebs/6/lmdb
/data-ebs/7/lmdb
/data-ebs/8/lmdb
/data-ebs/9/lmdb
/data-ebs/a/lmdb
/data-ebs/b/lmdb
/data-ebs/c/lmdb
/data-ebs/d/lmdb
/data-ebs/e/lmdb
/data-ebs/f/lmdb
[0000] Write key rate per second: 255.30K. Total:   2.80M    Scan Rate: 306.00
[0001] Write key rate per second: 208.30K. Total:   4.87M    Scan Rate: 584.00
[0002] Write key rate per second: 184.40K. Total:   6.83M    Scan Rate: 903.00
[0003] Write key rate per second: 180.70K. Total:   8.63M    Scan Rate:   1.11K
[0004] Write key rate per second: 161.60K. Total:  10.25M    Scan Rate:   1.19K
[0005] Write key rate per second: 146.40K. Total:  11.71M    Scan Rate:   1.24K
[0006] Write key rate per second: 133.60K. Total:  13.06M    Scan Rate:   1.30K
[0007] Write key rate per second: 124.40K. Total:  14.30M    Scan Rate:   1.30K
[0008] Write key rate per second: 122.20K. Total:  15.53M    Scan Rate:   1.41K
[0009] Write key rate per second: 117.40K. Total:  16.71M    Scan Rate:   1.54K
[0010] Write key rate per second: 113.00K. Total:  17.84M    Scan Rate:   1.52K
[0011] Write key rate per second: 109.00K. Total:  18.93M    Scan Rate:   1.53K
[0012] Write key rate per second:  99.50K. Total:  19.98M    Scan Rate:   1.67K

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          40.95    0.00   57.79    1.26    0.00    0.00

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
nvme0n1           0.00         0.00         0.00          0          0
nvme12n1       1255.70         0.00        14.56          0        145
nvme13n1       1247.60         0.00        16.42          0        164
nvme14n1       1280.50         0.00        14.97          0        149
nvme15n1       1217.10         0.00        14.17          0        141
nvme16n1       1260.40         0.00        14.54          0        145
nvme2n1        1339.50         0.00        15.14          0        151
nvme3n1        1268.10         0.00        15.11          0        151
nvme4n1        1224.90         0.00        16.20          0        162
nvme5n1        1252.40         0.00        13.77          0        137
nvme6n1        1216.00         0.00        15.30          0        153
nvme7n1        1285.40         0.00        15.38          0        153
nvme8n1        1158.00         0.00        14.83          0        148
nvme9n1        1233.60         0.00        14.99          0        149
nvme10n1       1194.40         0.00        14.97          0        149
nvme11n1       1285.20         0.00        14.94          0        149
nvme1n1        1283.00         0.00        14.32          0        143

-------------------------- SNIP -------------------------
[0065] Write key rate per second:  14.40K. Total:  47.38M    Scan Rate: 658.00
[0066] Write key rate per second:  14.30K. Total:  47.52M    Scan Rate: 673.00
[0067] Write key rate per second:  13.90K. Total:  47.66M    Scan Rate: 629.00
[0068] Write key rate per second:  14.50K. Total:  47.80M    Scan Rate: 666.00
[0069] Write key rate per second:  13.90K. Total:  47.94M    Scan Rate: 640.00
[0070] Write key rate per second:  14.00K. Total:  48.08M    Scan Rate: 675.00
[0071] Write key rate per second:  14.10K. Total:  48.23M    Scan Rate: 672.00
[0072] Write key rate per second:  13.60K. Total:  48.36M    Scan Rate: 608.00
[0073] Write key rate per second:  13.90K. Total:  48.50M    Scan Rate: 664.00
[0074] Write key rate per second:  13.80K. Total:  48.64M    Scan Rate: 675.00
[0075] Write key rate per second:  13.70K. Total:  48.78M    Scan Rate: 640.00
[0076] Write key rate per second:  13.70K. Total:  48.91M    Scan Rate: 665.00
[0077] Write key rate per second:  13.20K. Total:  49.05M    Scan Rate: 613.00


avg-cpu:  %user   %nice %system %iowait  %steal   %idle
           0.51    0.00    2.44   97.05    0.00    0.00

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
nvme0n1           0.00         0.00         0.00          0          0
nvme12n1        249.90         0.00         3.02          0         30
nvme13n1        248.80         0.00         3.10          0         31
nvme14n1        249.80         0.00         2.49          0         24
nvme15n1        250.30         0.00         2.73          0         27
nvme16n1        250.30         0.00         2.95          0         29
nvme2n1         251.00         0.00         2.54          0         25
nvme3n1         250.50         0.00         2.15          0         21
nvme4n1         251.60         0.00         1.96          0         19
nvme5n1         249.70         0.00         2.57          0         25
nvme6n1         250.20         0.00         1.81          0         18
nvme7n1         248.70         0.00         2.08          0         20
nvme8n1         249.40         0.00         2.19          0         21
nvme9n1         249.50         0.00         2.22          0         22
nvme10n1        248.80         0.00         1.90          0         19
nvme11n1        251.10         0.00         2.28          0         22
nvme1n1         250.60         0.00         1.99          0         19

(EC2 EBSIOBalance% exhausted) 13kps @ 4k iops baseline. Not tea bag.

2.2G @ 49M keys

> time go run populate/main.go --kv rocksdb --valsz 0 --keys_mil 100 --dir=$DATADIREBS -keysz 12 -read -n 16 -p
[0000] Write key rate per second: 243.70K. Total:   2.44M    Scan Rate: 231.00
[0001] Write key rate per second: 211.00K. Total:   4.55M    Scan Rate: 574.00
[0002] Write key rate per second: 201.40K. Total:   6.57M    Scan Rate: 838.00
[0003] Write key rate per second: 192.40K. Total:   8.49M    Scan Rate:   1.14K
[0004] Write key rate per second: 190.50K. Total:  10.41M    Scan Rate:   1.38K
[0005] Write key rate per second: 185.70K. Total:  12.27M    Scan Rate:   1.63K
[0006] Write key rate per second: 180.50K. Total:  14.07M    Scan Rate:   1.88K
[0007] Write key rate per second: 177.50K. Total:  15.85M    Scan Rate:   2.10K
[0008] Write key rate per second: 166.70K. Total:  17.61M    Scan Rate:   2.31K
[0009] Write key rate per second: 170.10K. Total:  19.30M    Scan Rate:   2.39K
[0010] Write key rate per second: 170.50K. Total:  21.01M    Scan Rate:   2.65K
[0011] Write key rate per second: 166.70K. Total:  22.68M    Scan Rate:   2.90K
[0012] Write key rate per second: 162.70K. Total:  24.31M    Scan Rate:   3.00K
-------------------------- SNIP -------------------------
[0167] Write key rate per second:  20.10K. Total:  97.02M    Scan Rate:   1.61K
[0168] Write key rate per second:  20.40K. Total:  97.23M    Scan Rate:   1.60K
[0169] Write key rate per second:  20.10K. Total:  97.43M    Scan Rate:   1.61K
[0170] Write key rate per second:  20.50K. Total:  97.63M    Scan Rate:   1.68K
[0171] Write key rate per second:  22.20K. Total:  97.86M    Scan Rate:   1.89K
[0172] Write key rate per second:  22.80K. Total:  98.08M    Scan Rate:   2.02K
[0173] Write key rate per second:  23.30K. Total:  98.32M    Scan Rate:   2.04K
[0174] Write key rate per second:  23.40K. Total:  98.55M    Scan Rate:   2.04K
[0175] Write key rate per second:  24.90K. Total:  98.80M    Scan Rate:   2.13K
[0176] Write key rate per second:  29.70K. Total:  99.10M    Scan Rate:   2.45K
[0177] Write key rate per second:  29.90K. Total:  99.42M    Scan Rate:   2.71K
[0178] Write key rate per second:  35.30K. Total:  99.77M    Scan Rate:   2.92K
[0179] Write key rate per second:  32.20K. Total: 100.00M    Scan Rate:   2.49K
real    30m0.735s
user    45m7.533s
sys     11m38.266s

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          65.98    0.00   31.47    1.90    0.00    0.65

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
nvme0n1           4.60         0.16         0.00          1          0
nvme12n1        775.60         3.52         0.02         35          0
nvme13n1        740.30         3.32         0.02         33          0
nvme14n1        802.60         3.65         0.02         36          0
nvme15n1        775.80         3.56         0.02         35          0
nvme16n1        810.70         3.71         0.02         37          0
nvme2n1         796.50         3.65         0.02         36          0
nvme3n1         845.00         3.92         0.02         39          0
nvme4n1         696.70         3.10         0.02         30          0
nvme5n1         836.00         3.81         0.02         38          0
nvme6n1         805.00         3.67         0.02         36          0
nvme7n1         845.90         3.90         0.02         38          0
nvme8n1         831.50         3.88         0.02         38          0
nvme9n1         735.80         3.31         0.02         33          0
nvme10n1        791.30         3.62         0.02         36          0
nvme11n1        801.70         3.68         0.02         36          0
nvme1n1         881.70         4.17         0.02         41          0

No throttling

2.9G @ 100M keys



--- 400M Keys w/ Append to previous test ---



> time go run populate/main.go --kv rocksdb --valsz 0 --keys_mil 400 --dir=$DATADIREBS -keysz 12 -read -n 16 -p -a
[0000] Write key rate per second:  35.20K. Total: 352.00K    Scan Rate:   5.24K
[0001] Write key rate per second:  34.10K. Total: 697.00K    Scan Rate:   4.97K
[0002] Write key rate per second:  34.10K. Total:   1.04M    Scan Rate:   5.02K
[0003] Write key rate per second:  33.80K. Total:   1.38M    Scan Rate:   4.94K
[0004] Write key rate per second:  34.00K. Total:   1.73M    Scan Rate:   5.07K
[0005] Write key rate per second:  33.40K. Total:   2.06M    Scan Rate:   5.06K
[0006] Write key rate per second:  34.30K. Total:   2.41M    Scan Rate:   5.23K
[0007] Write key rate per second:  33.50K. Total:   2.74M    Scan Rate:   4.98K
[0008] Write key rate per second:  33.40K. Total:   3.08M    Scan Rate:   4.77K
[0009] Write key rate per second:  33.60K. Total:   3.42M    Scan Rate:   5.07K
[0010] Write key rate per second:  32.60K. Total:   3.75M    Scan Rate:   4.76K
[0011] Write key rate per second:  33.30K. Total:   4.09M    Scan Rate:   5.20K
[0012] Write key rate per second:  32.90K. Total:   4.42M    Scan Rate:   4.89K

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          74.14    0.00   24.66    0.85    0.00    0.35

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
nvme0n1           5.10         0.06         0.01          0          0
nvme12n1        659.50         3.30         0.02         32          0
nvme13n1        675.10         3.37         0.02         33          0
nvme14n1        627.40         2.90         0.04         28          0
nvme15n1        669.70         3.13         0.03         31          0
nvme16n1        640.30         2.95         0.04         29          0
nvme2n1         654.70         3.04         0.03         30          0
nvme3n1         448.00         2.20         6.51         22         65
nvme4n1         660.40         3.02         0.04         30          0
nvme5n1         573.80         2.76         0.01         27          0
nvme6n1         684.70         3.20         0.04         31          0
nvme7n1         797.90         4.02         0.10         40          1
nvme8n1         656.60         3.05         0.04         30          0
nvme9n1         702.80         3.32         0.03         33          0
nvme10n1        675.20         3.25         0.03         32          0
nvme11n1        701.10         3.30         0.12         32          1
nvme1n1         681.80         3.20         0.03         31          0

-------------------------- SNIP -------------------------

[0176] Write key rate per second:  15.50K. Total:  48.91M    Scan Rate:   2.12K
[0177] Write key rate per second:  10.50K. Total:  49.02M    Scan Rate:   1.42K
[0178] Write key rate per second:  11.00K. Total:  49.13M    Scan Rate:   1.55K
[0179] Write key rate per second:  10.60K. Total:  49.24M    Scan Rate:   1.45K
[0180] Write key rate per second:  10.70K. Total:  49.34M    Scan Rate:   1.50K
[0181] Write key rate per second:  11.00K. Total:  49.45M    Scan Rate:   1.57K
[0182] Write key rate per second:  10.70K. Total:  49.56M    Scan Rate:   1.53K
[0183] Write key rate per second:  10.80K. Total:  49.67M    Scan Rate:   1.57K
[0184] Write key rate per second:  11.30K. Total:  49.78M    Scan Rate:   1.69K
[0185] Write key rate per second:  10.60K. Total:  49.89M    Scan Rate:   1.57K
[0186] Write key rate per second:  11.20K. Total:  50.00M    Scan Rate:   1.72K
[0187] Write key rate per second:  11.40K. Total:  50.12M    Scan Rate:   1.75K
[0188] Write key rate per second:  12.10K. Total:  50.24M    Scan Rate:   1.97K

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          20.29    0.00    8.88   70.78    0.00    0.05

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
nvme0n1           0.20         0.01         0.00          0          0
nvme12n1        247.90         1.23         0.04         12          0
nvme13n1        249.70         1.22         0.03         12          0
nvme14n1        249.60         1.12         0.06         11          0
nvme15n1        250.30         1.18         0.05         11          0
nvme16n1        251.00         1.18         0.05         11          0
nvme2n1         250.40         1.18         0.05         11          0
nvme3n1         250.10         1.18         0.05         11          0
nvme4n1         249.20         1.11         0.06         11          0
nvme5n1         249.70         1.23         0.04         12          0
nvme6n1         250.60         1.19         0.04         11          0
nvme7n1         250.00         1.20         0.04         12          0
nvme8n1         250.10         1.20         0.04         11          0
nvme9n1         250.50         1.22         0.04         12          0
nvme10n1        250.50         1.23         0.04         12          0
nvme11n1        250.80         1.20         0.01         11          0
nvme1n1         249.60         1.19         0.04         11          0

(EC2 EBSIOBalance% exhausted) 10kps @ 4k iops baseline. Again, not tea bag.

-------------------------- SNIP -------------------------

[0201] Write key rate per second:  30.50K. Total:  53.91M    Scan Rate:   5.36K
[0202] Write key rate per second:  29.70K. Total:  54.21M    Scan Rate:   5.26K
[0203] Write key rate per second:  30.20K. Total:  54.52M    Scan Rate:   5.35K
[0204] Write key rate per second:  28.00K. Total:  54.80M    Scan Rate:   4.95K
[0205] Write key rate per second:  27.20K. Total:  55.07M    Scan Rate:   4.64K
[0206] Write key rate per second:  27.90K. Total:  55.36M    Scan Rate:   4.89K
[0207] Write key rate per second:  27.30K. Total:  55.63M    Scan Rate:   4.78K
[0208] Write key rate per second:  26.20K. Total:  55.90M    Scan Rate:   4.76K
[0209] Write key rate per second:  24.60K. Total:  56.14M    Scan Rate:   4.45K
[0210] Write key rate per second:  24.90K. Total:  56.40M    Scan Rate:   4.50K
[0211] Write key rate per second:  25.20K. Total:  56.65M    Scan Rate:   4.60K
[0212] Write key rate per second:  25.30K. Total:  56.90M    Scan Rate:   4.59K
[0213] Write key rate per second:  25.30K. Total:  57.16M    Scan Rate:   4.62K

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          61.54    0.00   19.10   17.77    0.00    1.58

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
nvme0n1           1.80         0.03         0.00          0          0
nvme12n1        262.10         1.31         0.04         13          0
nvme13n1        289.00         1.49         0.02         14          0
nvme14n1         32.20         0.00         0.65          0          6
nvme15n1        269.10         1.40         0.04         13          0
nvme16n1        285.00         1.49         0.04         14          0
nvme2n1         295.90         1.54         0.03         15          0
nvme3n1         273.10         1.43         0.03         14          0
nvme4n1          35.90         0.00         0.72          0          7
nvme5n1         271.30         1.43         0.03         14          0
nvme6n1         287.70         1.52         0.03         15          0
nvme7n1         272.40         1.43         0.03         14          0
nvme8n1         281.10         1.49         0.03         14          0
nvme9n1         290.90         1.55         0.03         15          0
nvme10n1        287.30         1.50         0.03         15          0
nvme11n1        286.00         1.52         0.03         15          0
nvme1n1         279.40         1.48         0.03         14          0

(Compaction) Highly variable throughput caused by compaction likely hidden from aggregate metrics due to concurrency

Booooooooooooooooooooooooooooooooooooooooooooooooo

-------------------------- SNIP -------------------------


[0244] Write key rate per second:  15.40K. Total:  64.14M    Scan Rate:   2.85K
[0245] Write key rate per second:  14.20K. Total:  64.29M    Scan Rate:   2.59K
[0246] Write key rate per second:  14.90K. Total:  64.44M    Scan Rate:   2.56K
[0247] Write key rate per second:  16.20K. Total:  64.60M    Scan Rate:   2.13K
[0248] Write key rate per second:  16.50K. Total:  64.77M    Scan Rate:   2.17K
[0249] Write key rate per second:  16.90K. Total:  64.94M    Scan Rate:   2.24K
[0250] Write key rate per second:  17.20K. Total:  65.11M    Scan Rate:   2.26K
[0251] Write key rate per second:  10.50K. Total:  65.22M    Scan Rate:   1.39K
[0252] Write key rate per second:   9.60K. Total:  65.32M    Scan Rate:   1.22K
[0253] Write key rate per second:  12.80K. Total:  65.45M    Scan Rate:   1.70K
[0254] Write key rate per second:  23.70K. Total:  65.68M    Scan Rate:   3.17K
[0255] Write key rate per second:  26.80K. Total:  65.95M    Scan Rate:   3.57K
[0256] Write key rate per second:  29.40K. Total:  66.25M    Scan Rate:   3.96K

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          63.59    0.00   18.49   16.93    0.00    0.98

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
nvme0n1           6.00         0.09         0.00          0          0
nvme12n1        290.10         1.53         0.02         15          0
nvme13n1        298.60         1.59         0.02         15          0
nvme14n1         27.10         0.01         0.54          0          5
nvme15n1        278.60         1.49         0.03         14          0
nvme16n1        282.10         1.52         0.01         15          0
nvme2n1         281.00         1.51         0.03         15          0
nvme3n1         272.40         1.47         0.03         14          0
nvme4n1          43.00         0.00         4.35          0         43
nvme5n1         277.10         1.50         0.03         15          0
nvme6n1         280.10         1.52         0.01         15          0
nvme7n1         274.50         1.48         0.03         14          0
nvme8n1         275.00         1.49         0.01         14          0
nvme9n1         273.20         1.47         0.03         14          0
nvme10n1        281.10         1.51         0.03         15          0
nvme11n1        286.20         1.55         0.03         15          0
nvme1n1         276.30         1.49         0.01         14          0

15k to 9k to 30k for no reason?

-------------------------- SNIP -------------------------

[0303] Write key rate per second:   6.50K. Total:  75.26M    Scan Rate:   1.05K
[0304] Write key rate per second:   6.30K. Total:  75.33M    Scan Rate: 933.00
[0305] Write key rate per second:   5.10K. Total:  75.38M    Scan Rate: 728.00
[0306] Write key rate per second:   5.40K. Total:  75.43M    Scan Rate: 689.00
[0307] Write key rate per second:   6.00K. Total:  75.49M    Scan Rate: 812.00
[0308] Write key rate per second:   6.00K. Total:  75.55M    Scan Rate: 831.00
[0309] Write key rate per second:   6.20K. Total:  75.62M    Scan Rate: 796.00
[0310] Write key rate per second:   5.90K. Total:  75.68M    Scan Rate: 795.00
[0311] Write key rate per second:   6.20K. Total:  75.74M    Scan Rate: 838.00
[0312] Write key rate per second:   5.80K. Total:  75.80M    Scan Rate: 735.00
[0313] Write key rate per second:   6.20K. Total:  75.86M    Scan Rate: 830.00
[0314] Write key rate per second:   5.70K. Total:  75.92M    Scan Rate: 763.00
[0315] Write key rate per second:   6.10K. Total:  75.98M    Scan Rate: 776.00

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          12.51    0.00    7.50   79.77    0.00    0.22

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
nvme0n1           0.00         0.00         0.00          0          0
nvme12n1        249.10         1.36         0.00         13          0
nvme13n1        246.60         1.36         0.00         13          0
nvme14n1        250.30         1.50         0.00         14          0
nvme15n1        250.40         1.35         0.01         13          0
nvme16n1        250.00         1.33         0.02         13          0
nvme2n1         250.60         1.37         0.02         13          0
nvme3n1         249.60         1.32         0.03         13          0
nvme4n1         251.60         1.59         0.00         15          0
nvme5n1         250.30         1.31         0.03         13          0
nvme6n1         251.10         1.33         0.01         13          0
nvme7n1         249.30         1.30         0.03         13          0
nvme8n1         249.80         1.30         0.01         12          0
nvme9n1         250.40         1.36         0.02         13          0
nvme10n1        250.50         1.32         0.01         13          0
nvme11n1        250.20         1.31         0.01         13          0
nvme1n1         250.40         1.30         0.02         13          0

Dropped to 5k? The data rates hardly changed. If anything they became more consistent.
Suddenly throughput is gone. I think we found the baseline.

Stop the test, let the burst credits refill and we'll start again from the top w/ lmdb to see if it breaks as bad.

4.4G @ 213M

> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 100 --dir=$DATADIREBS -keysz 12 -read -n 16 -p -batchsize 100 -sp 16
[0000] Write key rate per second: 294.89K. Total:   3.42M    Scan Rate: 148.00
[0001] Write key rate per second: 226.54K. Total:   5.79M    Scan Rate: 264.00
[0002] Write key rate per second: 213.85K. Total:   7.92M    Scan Rate: 338.00
[0003] Write key rate per second: 191.21K. Total:   9.96M    Scan Rate: 419.00
[0004] Write key rate per second: 174.97K. Total:  11.76M    Scan Rate: 475.00
[0005] Write key rate per second: 164.87K. Total:  13.50M    Scan Rate: 517.00
[0006] Write key rate per second: 175.24K. Total:  15.16M    Scan Rate: 612.00
[0007] Write key rate per second: 166.42K. Total:  16.71M    Scan Rate: 607.00
[0008] Write key rate per second: 153.01K. Total:  18.36M    Scan Rate: 683.00
[0009] Write key rate per second: 142.24K. Total:  19.80M    Scan Rate: 673.00
[0010] Write key rate per second: 154.64K. Total:  21.26M    Scan Rate: 739.00
[0011] Write key rate per second: 147.21K. Total:  22.69M    Scan Rate: 758.00
[0012] Write key rate per second: 152.29K. Total:  24.21M    Scan Rate: 866.00
-------------------------- SNIP -------------------------
[0064] Write key rate per second: 126.83K. Total:  83.35M    Scan Rate:   2.59K
[0065] Write key rate per second:  97.04K. Total:  84.35M    Scan Rate:   1.48K
[0066] Write key rate per second: 120.83K. Total:  85.64M    Scan Rate:   1.89K
[0067] Write key rate per second: 137.59K. Total:  87.01M    Scan Rate:   2.30K
[0068] Write key rate per second: 131.37K. Total:  88.39M    Scan Rate:   2.38K
[0069] Write key rate per second: 127.91K. Total:  89.73M    Scan Rate:   2.37K
[0070] Write key rate per second: 136.01K. Total:  91.09M    Scan Rate:   2.46K
[0071] Write key rate per second: 131.94K. Total:  92.48M    Scan Rate:   2.69K
[0072] Write key rate per second: 128.20K. Total:  93.82M    Scan Rate:   2.76K
[0073] Write key rate per second: 140.44K. Total:  95.22M    Scan Rate:   2.68K
[0074] Write key rate per second: 122.04K. Total:  96.52M    Scan Rate:   2.46K
[0075] Write key rate per second: 140.99K. Total:  97.92M    Scan Rate:   2.83K
[0076] Write key rate per second: 138.22K. Total:  99.30M    Scan Rate:   3.00K
real    12m57.545s
user    10m16.082s
sys     9m21.396s

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          41.08    0.00   42.10   16.82    0.00    0.00

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
nvme0n1           0.20         0.00         0.00          0          0
nvme12n1        252.70         0.00        11.55          0        115
nvme13n1        249.90         0.00        11.08          0        110
nvme14n1        249.80         0.00        14.08          0        140
nvme15n1        237.50         0.00        18.35          0        183
nvme16n1        243.60         0.00        14.79          0        147
nvme2n1         250.40         0.00        15.29          0        152
nvme3n1         247.60         0.00        13.58          0        135
nvme4n1         255.80         0.00        10.42          0        104
nvme5n1         257.20         0.00         5.28          0         52
nvme6n1         251.10         0.00        12.15          0        121
nvme7n1         249.00         0.00        14.31          0        143
nvme8n1         247.00         0.00        10.81          0        108
nvme9n1         245.60         0.00        13.48          0        134
nvme10n1        251.40         0.00         7.03          0         70
nvme11n1        256.10         0.00         6.09          0         60
nvme1n1         255.20         0.00         9.21          0         92

3.3G

Seems good, let's keep going.


> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 8000 --dir=$DATADIREBS -keysz 12 -read -n 16 -p -sp 16 -batchsize 100 -keypfx 4 -sync-every 1000
[0000] Write key rate per second: 327.63K. Total:   3.60M    Scan Rate: 152.00
[0001] Write key rate per second: 240.80K. Total:   6.24M    Scan Rate: 289.00
[0002] Write key rate per second: 224.79K. Total:   8.53M    Scan Rate: 387.00
[0003] Write key rate per second: 214.94K. Total:  10.68M    Scan Rate: 488.00
[0004] Write key rate per second: 203.60K. Total:  12.72M    Scan Rate: 567.00
[0005] Write key rate per second: 185.74K. Total:  14.64M    Scan Rate: 594.00
[0006] Write key rate per second: 195.23K. Total:  16.40M    Scan Rate: 710.00
[0007] Write key rate per second: 181.88K. Total:  17.79M    Scan Rate: 727.00
[0008] Write key rate per second: 155.49K. Total:  18.89M    Scan Rate: 722.00
[0009] Write key rate per second: 151.35K. Total:  19.85M    Scan Rate: 696.00
[0010] Write key rate per second: 128.00K. Total:  20.82M    Scan Rate: 620.00
[0011] Write key rate per second: 146.02K. Total:  22.04M    Scan Rate: 741.00
[0012] Write key rate per second: 125.75K. Total:  22.88M    Scan Rate: 660.00

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          41.76    0.00   30.11   28.13    0.00    0.00

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
nvme0n1           0.00         0.00         0.00          0          0
nvme12n1        257.40         0.00         1.37          0         13
nvme13n1        256.10         0.00         2.23          0         22
nvme14n1        237.60         0.00        20.68          0        206
nvme15n1        251.60         0.00         8.24          0         82
nvme16n1        237.40         0.00        18.08          0        180
nvme2n1         250.80         0.00        12.98          0        129
nvme3n1         259.90         0.00         1.43          0         14
nvme4n1         260.00         0.00         1.54          0         15
nvme5n1         234.60         0.00        18.61          0        186
nvme6n1         241.70         0.00        17.74          0        177
nvme7n1         248.00         0.00        12.10          0        121
nvme8n1         245.40         0.00        10.31          0        103
nvme9n1         242.20         0.00        14.20          0        142
nvme10n1        258.90         0.00         1.63          0         16
nvme11n1        259.80         0.00         1.87          0         18
nvme1n1         258.80         0.00         2.10          0         20

-------------------------- SNIP -------------------------
[1876] Write key rate per second:   5.53K. Total: 416.99M    Scan Rate:   1.67K
[1877] Write key rate per second:   8.07K. Total: 417.07M    Scan Rate:   2.92K
[1878] Write key rate per second:   2.15K. Total: 417.10M    Scan Rate: 170.00
[1879] Write key rate per second:   2.02K. Total: 417.12M    Scan Rate: 151.00
[1880] Write key rate per second:   2.18K. Total: 417.14M    Scan Rate: 187.00
[1881] Write key rate per second:   1.99K. Total: 417.16M    Scan Rate: 144.00
[1882] Write key rate per second:   2.56K. Total: 417.19M    Scan Rate: 199.00
[1883] Write key rate per second:   2.41K. Total: 417.21M    Scan Rate: 176.00
[1884] Write key rate per second:   6.19K. Total: 417.27M    Scan Rate:   1.88K
[1885] Write key rate per second:   7.65K. Total: 417.36M    Scan Rate:   2.74K
[1886] Write key rate per second:   1.93K. Total: 417.38M    Scan Rate: 150.00
[1887] Write key rate per second:   2.04K. Total: 417.40M    Scan Rate: 168.00
[1888] Write key rate per second:   2.10K. Total: 417.42M    Scan Rate: 159.00
real    5h16m10.231s
user    59m44.700s
sys     1h0m20.110s

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
           2.48    0.00    6.99   90.53    0.00    0.00

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
nvme0n1           0.10         0.00         0.00          0          0
nvme12n1        255.70         0.33         0.69          3          6
nvme13n1        255.10         0.27         0.83          2          8
nvme14n1        256.00         0.28         0.84          2          8
nvme15n1        252.90         0.28         0.74          2          7
nvme16n1        253.10         0.33         0.70          3          7
nvme2n1         255.40         0.28         0.77          2          7
nvme3n1         231.80         0.45         0.48          4          4
nvme4n1         256.30         0.27         0.83          2          8
nvme5n1         254.70         0.28         0.81          2          8
nvme6n1         231.30         0.57         0.34          5          3
nvme7n1         247.10         0.38         0.63          3          6
nvme8n1         245.70         0.42         0.58          4          5
nvme9n1         250.90         0.25         3.39          2         33
nvme10n1        244.30         0.39         0.58          3          5
nvme11n1        253.50         0.33         0.74          3          7
nvme1n1         256.20         0.34         0.71          3          7

12.6G

Changed filesystem from xfs to ext4
This increased block size from 512 to 4096
Keypfx 4 w/ 256 DBs = 4B pages. Didn't work out so well on a single node.

> time go run populate/main.go --kv rocksdb --valsz 0 --keys_mil 400 --dir=$DATADIREBS -keysz 12 -read -n 16 -p -batchsize 1000 -keypfx 4 -sync
[0000] Write key rate per second: 226.70K. Total:   2.43M    Scan Rate:   1.09K
[0001] Write key rate per second: 204.50K. Total:   4.48M    Scan Rate:   2.52K
[0002] Write key rate per second: 189.10K. Total:   6.37M    Scan Rate:   3.67K
[0003] Write key rate per second: 182.20K. Total:   8.19M    Scan Rate:   4.71K
[0004] Write key rate per second: 177.30K. Total:   9.96M    Scan Rate:   6.07K
[0005] Write key rate per second: 174.30K. Total:  11.71M    Scan Rate:   6.67K
[0006] Write key rate per second: 168.40K. Total:  13.39M    Scan Rate:   7.57K
[0007] Write key rate per second: 166.00K. Total:  15.05M    Scan Rate:   8.34K
[0008] Write key rate per second: 163.10K. Total:  16.68M    Scan Rate:   9.24K
[0009] Write key rate per second: 152.60K. Total:  18.30M    Scan Rate:  10.51K
[0010] Write key rate per second: 158.60K. Total:  19.88M    Scan Rate:  10.57K
[0011] Write key rate per second: 156.10K. Total:  21.44M    Scan Rate:  11.36K
[0012] Write key rate per second: 155.10K. Total:  22.99M    Scan Rate:  12.86K
-------------------------- SNIP -------------------------
[0210] Write key rate per second:  34.70K. Total: 117.99M    Scan Rate:  15.28K
[0211] Write key rate per second:  38.20K. Total: 118.38M    Scan Rate:  16.00K
[0212] Write key rate per second:  37.10K. Total: 118.75M    Scan Rate:  15.67K
[0213] Write key rate per second:  35.60K. Total: 119.10M    Scan Rate:  14.98K
[0214] Write key rate per second:  38.30K. Total: 119.49M    Scan Rate:  16.20K
[0215] Write key rate per second:  44.70K. Total: 119.93M    Scan Rate:  18.98K
[0216] Write key rate per second:  48.90K. Total: 120.42M    Scan Rate:  20.76K
[0217] Write key rate per second:  58.30K. Total: 121.00M    Scan Rate:  25.19K
[0218] Write key rate per second:  61.50K. Total: 121.62M    Scan Rate:  26.73K
[0219] Write key rate per second:  62.20K. Total: 122.24M    Scan Rate:  26.75K
[0220] Write key rate per second:  62.80K. Total: 122.87M    Scan Rate:  28.71K
[0221] Write key rate per second:  63.30K. Total: 123.50M    Scan Rate:  27.46K
[0222] Write key rate per second:  62.70K. Total: 124.13M    Scan Rate:  27.60K
real    37m16.145s
user    58m37.791s
sys     12m31.515s

1.2G

Very good space usage and throughput. Should run this case overnight.
Keypfx 4 w/ 16 DBs = 256M pages.


> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 400 --dir=$DATADIREBS -keysz 12 -read -n 16 -p -batchsize 100 -keypfx 3 -sync-every 100 -sp 16
[0000] Write key rate per second: 174.61K. Total:   1.75M    Scan Rate:   9.18K
[0001] Write key rate per second: 153.29K. Total:   3.28M    Scan Rate:  23.05K
[0002] Write key rate per second: 141.42K. Total:   4.77M    Scan Rate:  35.73K
[0003] Write key rate per second: 142.48K. Total:   6.20M    Scan Rate:  46.62K
[0004] Write key rate per second: 130.87K. Total:   7.58M    Scan Rate:  56.48K
[0005] Write key rate per second: 127.36K. Total:   8.92M    Scan Rate:  66.09K
[0006] Write key rate per second: 127.19K. Total:  10.19M    Scan Rate:  72.30K
[0007] Write key rate per second: 120.98K. Total:  11.47M    Scan Rate:  82.04K
[0008] Write key rate per second: 117.88K. Total:  12.64M    Scan Rate:  84.40K
[0009] Write key rate per second: 101.66K. Total:  13.71M    Scan Rate:  84.08K
[0010] Write key rate per second: 101.81K. Total:  14.78M    Scan Rate:  90.93K
[0011] Write key rate per second:  99.29K. Total:  15.82M    Scan Rate:  95.16K
[0012] Write key rate per second:  94.88K. Total:  16.82M    Scan Rate:  97.25K
-------------------------- SNIP -------------------------
[0085] Write key rate per second:  12.00K. Total:  45.08M    Scan Rate:  32.31K
[0086] Write key rate per second:  14.00K. Total:  45.22M    Scan Rate:  37.56K
[0087] Write key rate per second:   6.00K. Total:  45.28M    Scan Rate:  16.13K
[0088] Write key rate per second:  12.00K. Total:  45.40M    Scan Rate:  32.43K
[0089] Write key rate per second:  14.00K. Total:  45.54M    Scan Rate:  37.96K
[0090] Write key rate per second:   6.00K. Total:  45.60M    Scan Rate:  16.26K
[0091] Write key rate per second:  12.00K. Total:  45.72M    Scan Rate:  32.59K
[0092] Write key rate per second:  14.00K. Total:  45.86M    Scan Rate:  38.22K
[0093] Write key rate per second:   6.00K. Total:  45.92M    Scan Rate:  16.40K
[0094] Write key rate per second:  12.00K. Total:  46.04M    Scan Rate:  32.85K
[0095] Write key rate per second:  14.00K. Total:  46.18M    Scan Rate:  38.53K
[0096] Write key rate per second:   5.00K. Total:  46.23M    Scan Rate:  13.72K
[0097] Write key rate per second:  13.00K. Total:  46.36M    Scan Rate:  35.82K
real    16m32.487s
user    7m45.711s
sys     6m44.412s

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
           6.82    0.00    7.33   85.79    0.00    0.05

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
nvme0n1           0.00         0.00         0.00          0          0
nvme12n1        251.10         0.00         1.89          0         18
nvme13n1        252.00         0.00         1.98          0         19
nvme14n1        249.90         0.00         1.95          0         19
nvme15n1        251.80         0.00         1.94          0         19
nvme16n1        250.30         0.00         1.92          0         19
nvme2n1         250.10         0.00         1.91          0         19
nvme3n1         247.30         0.00         1.92          0         19
nvme4n1         248.80         0.00         1.89          0         18
nvme5n1         250.30         0.00         1.95          0         19
nvme6n1         250.50         0.00         1.93          0         19
nvme7n1         249.50         0.00         1.94          0         19
nvme8n1         246.90         0.00         1.94          0         19
nvme9n1         249.30         0.00         1.99          0         19
nvme10n1        249.00         0.00         1.98          0         19
nvme11n1        249.10         0.00         1.91          0         19
nvme1n1         255.00         0.00         2.02          0         20

961M (20 bytes per key)

~ 10kps consistent - quite good.

> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 400 --dir=$DATADIREBS -keysz 12 -read -n 16 -p -batchsize 1000 -keypfx 3 -sp 16 -sync-every 1000
[0000] Write key rate per second: 246.30K. Total:   2.46M    Scan Rate:  18.10K
[0001] Write key rate per second: 195.30K. Total:   4.42M    Scan Rate:  40.07K
[0002] Write key rate per second: 188.30K. Total:   6.31M    Scan Rate:  57.47K
[0003] Write key rate per second: 179.00K. Total:   8.10M    Scan Rate:  74.55K
[0004] Write key rate per second: 168.00K. Total:   9.78M    Scan Rate:  86.36K
[0005] Write key rate per second: 162.30K. Total:  11.41M    Scan Rate: 102.43K
[0006] Write key rate per second: 145.10K. Total:  12.86M    Scan Rate: 100.44K
[0007] Write key rate per second: 138.50K. Total:  14.24M    Scan Rate: 106.80K
[0008] Write key rate per second: 131.30K. Total:  15.56M    Scan Rate: 110.80K
[0009] Write key rate per second: 128.40K. Total:  16.84M    Scan Rate: 124.08K
[0010] Write key rate per second: 124.90K. Total:  18.09M    Scan Rate: 129.93K
[0011] Write key rate per second: 123.10K. Total:  19.33M    Scan Rate: 130.88K
[0012] Write key rate per second: 139.70K. Total:  20.72M    Scan Rate: 158.92K
[0013] Write key rate per second: 139.80K. Total:  22.12M    Scan Rate: 170.18K
-------------------------- SNIP -------------------------
[0282] Write key rate per second:   7.20K. Total: 181.78M    Scan Rate:  75.12K
[0283] Write key rate per second:   7.50K. Total: 181.86M    Scan Rate:  77.67K
[0284] Write key rate per second:   7.70K. Total: 181.93M    Scan Rate:  81.15K
[0285] Write key rate per second:   7.50K. Total: 182.01M    Scan Rate:  79.06K
[0286] Write key rate per second:   8.10K. Total: 182.09M    Scan Rate:  86.02K
[0287] Write key rate per second:   8.40K. Total: 182.17M    Scan Rate:  87.69K
[0288] Write key rate per second:   8.00K. Total: 182.25M    Scan Rate:  82.78K
[0289] Write key rate per second:   8.20K. Total: 182.34M    Scan Rate:  85.19K
[0290] Write key rate per second:   8.10K. Total: 182.42M    Scan Rate:  83.71K
[0291] Write key rate per second:   8.10K. Total: 182.50M    Scan Rate:  84.49K
[0292] Write key rate per second:   8.20K. Total: 182.58M    Scan Rate:  84.14K
[0293] Write key rate per second:   7.80K. Total: 182.66M    Scan Rate:  80.57K
[0294] Write key rate per second:   8.50K. Total: 182.74M    Scan Rate:  87.44K
[0295] Write key rate per second:   8.60K. Total: 182.83M    Scan Rate:  88.09K
-------------------------- SNIP -------------------------
[0306] Write key rate per second:   9.50K. Total: 184.05M    Scan Rate:  96.30K
[0307] Write key rate per second:  10.00K. Total: 184.15M    Scan Rate: 100.68K
[0308] Write key rate per second:  11.40K. Total: 184.27M    Scan Rate: 112.78K
[0309] Write key rate per second:  16.10K. Total: 184.43M    Scan Rate: 153.57K
[0310] Write key rate per second:  50.10K. Total: 184.93M    Scan Rate: 462.39K
[0311] Write key rate per second:  33.60K. Total: 185.27M    Scan Rate: 330.45K
[0312] Write key rate per second:  22.00K. Total: 185.49M    Scan Rate: 219.26K
[0313] Write key rate per second:  75.50K. Total: 186.24M    Scan Rate: 760.06K
[0314] Write key rate per second:  20.30K. Total: 186.44M    Scan Rate: 216.79K
[0315] Write key rate per second:  21.70K. Total: 186.66M    Scan Rate: 231.01K
[0316] Write key rate per second:  77.20K. Total: 187.44M    Scan Rate: 847.61K
[0317] Write key rate per second:  20.00K. Total: 187.64M    Scan Rate: 222.06K
[0318] Write key rate per second:  11.40K. Total: 187.75M    Scan Rate: 125.90K
[0319] Write key rate per second:   8.00K. Total: 187.83M    Scan Rate:  87.81K
-------------------------- SNIP -------------------------
[0347] Write key rate per second:   8.60K. Total: 190.20M    Scan Rate:  97.50K
[0348] Write key rate per second:   8.30K. Total: 190.28M    Scan Rate:  92.93K
[0349] Write key rate per second:   8.60K. Total: 190.37M    Scan Rate:  95.68K
[0350] Write key rate per second:   8.20K. Total: 190.45M    Scan Rate:  91.90K
[0351] Write key rate per second:   8.60K. Total: 190.53M    Scan Rate:  97.14K
[0352] Write key rate per second:   8.40K. Total: 190.62M    Scan Rate:  94.66K
[0353] Write key rate per second:   8.20K. Total: 190.70M    Scan Rate:  92.44K
[0354] Write key rate per second:   8.30K. Total: 190.78M    Scan Rate:  93.53K
[0355] Write key rate per second:   8.90K. Total: 190.87M    Scan Rate: 101.25K
[0356] Write key rate per second:   8.10K. Total: 190.95M    Scan Rate:  91.88K
[0357] Write key rate per second:   8.60K. Total: 191.04M    Scan Rate:  97.01K
[0358] Write key rate per second:   8.60K. Total: 191.12M    Scan Rate:  96.38K
[0359] Write key rate per second:   8.30K. Total: 191.21M    Scan Rate:  94.51K
real    60m5.694s
user    26m15.478s
sys     14m35.108s

Throughput Flappy.

EC2 EBSByteBalance% and EBSIOBalance% trade positions as the throughput constraint due to syncing every 1M keys per partition (x16)

Beter to sync more often to obtain consistent throughput

> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 100 --dir=$DATADIREBS -keysz 12 -read -n 16 -p -batchsize 50 -keypfx 3 -sp 16 -sync-every 50
[0000] Write key rate per second: 146.70K. Total:   1.47M    Scan Rate:   6.41K
[0001] Write key rate per second: 124.69K. Total:   2.72M    Scan Rate:  15.64K
[0002] Write key rate per second: 108.86K. Total:   3.81M    Scan Rate:  21.11K
[0003] Write key rate per second:  25.13K. Total:   4.06M    Scan Rate:   5.86K
[0004] Write key rate per second:  23.87K. Total:   4.30M    Scan Rate:   5.95K
[0005] Write key rate per second:  22.23K. Total:   4.53M    Scan Rate:   5.87K
[0006] Write key rate per second:  20.75K. Total:   4.74M    Scan Rate:   5.68K
[0007] Write key rate per second:  20.99K. Total:   4.95M    Scan Rate:   6.07K
[0008] Write key rate per second:  20.25K. Total:   5.15M    Scan Rate:   6.07K
[0009] Write key rate per second:  18.81K. Total:   5.34M    Scan Rate:   5.89K
[0010] Write key rate per second:  17.50K. Total:   5.51M    Scan Rate:   5.60K
[0011] Write key rate per second:  17.48K. Total:   5.69M    Scan Rate:   5.86K
[0012] Write key rate per second:  16.75K. Total:   5.86M    Scan Rate:   5.72K
-------------------------- SNIP -------------------------
[0071] Write key rate per second:   8.75K. Total:  11.90M    Scan Rate:   6.20K
[0072] Write key rate per second:   8.00K. Total:  11.98M    Scan Rate:   5.65K
[0073] Write key rate per second:   8.13K. Total:  12.06M    Scan Rate:   5.87K
[0074] Write key rate per second:   8.00K. Total:  12.14M    Scan Rate:   5.79K
[0075] Write key rate per second:   8.25K. Total:  12.22M    Scan Rate:   5.99K
[0076] Write key rate per second:   8.49K. Total:  12.31M    Scan Rate:   6.25K
[0077] Write key rate per second:   7.88K. Total:  12.39M    Scan Rate:   5.79K
[0078] Write key rate per second:   7.93K. Total:  12.47M    Scan Rate:   5.88K
[0079] Write key rate per second:   8.00K. Total:  12.55M    Scan Rate:   5.93K
[0080] Write key rate per second:   8.00K. Total:  12.63M    Scan Rate:   6.01K
[0081] Write key rate per second:   7.75K. Total:  12.71M    Scan Rate:   5.82K
[0082] Write key rate per second:   7.74K. Total:  12.78M    Scan Rate:   5.89K
[0083] Write key rate per second:   7.87K. Total:  12.86M    Scan Rate:   6.03K
real    14m9.807s
user    1m50.676s
sys     1m41.784s

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
           3.73    0.00    4.91   91.36    0.00    0.00

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
nvme0n1           0.00         0.00         0.00          0          0
nvme12n1        250.70         0.00         1.67          0         16
nvme13n1        250.40         0.00         1.71          0         17
nvme14n1        250.90         0.00         1.70          0         16
nvme15n1        250.20         0.00         1.70          0         16
nvme16n1        250.60         0.00         1.63          0         16
nvme2n1         250.70         0.00         1.71          0         17
nvme3n1         249.50         0.00         1.72          0         17
nvme4n1         247.40         0.00         1.66          0         16
nvme5n1         250.20         0.00         1.70          0         16
nvme6n1         250.70         0.00         1.67          0         16
nvme7n1         249.80         0.00         1.69          0         16
nvme8n1         249.10         0.00         1.69          0         16
nvme9n1         248.90         0.00         1.67          0         16
nvme10n1        249.90         0.00         1.65          0         16
nvme11n1        250.70         0.00         1.67          0         16
nvme1n1         250.70         0.00         1.67          0         16

340M

Thoughput steady at 7-8k. 50x50 is probably a bit low.

> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 100 --dir=$DATADIREBS -keysz 12 -read -n 16 -p -batchsize 50 -keypfx 3 -sp 16 -sync-every 200
[0000] Write key rate per second: 142.33K. Total:   1.55M    Scan Rate:   7.24K
[0001] Write key rate per second: 137.87K. Total:   2.93M    Scan Rate:  18.36K
[0002] Write key rate per second: 132.79K. Total:   4.26M    Scan Rate:  28.30K
[0003] Write key rate per second: 122.83K. Total:   5.55M    Scan Rate:  37.41K
[0004] Write key rate per second: 125.50K. Total:   6.80M    Scan Rate:  45.97K
[0005] Write key rate per second: 122.53K. Total:   8.03M    Scan Rate:  53.91K
[0006] Write key rate per second: 112.98K. Total:   9.21M    Scan Rate:  60.46K
[0007] Write key rate per second: 116.98K. Total:  10.38M    Scan Rate:  68.16K
[0008] Write key rate per second: 108.30K. Total:  11.52M    Scan Rate:  74.20K
[0009] Write key rate per second:  96.22K. Total:  12.54M    Scan Rate:  72.52K
[0010] Write key rate per second:  89.47K. Total:  13.48M    Scan Rate:  72.75K
[0011] Write key rate per second:  88.13K. Total:  14.41M    Scan Rate:  77.28K
[0012] Write key rate per second:  88.44K. Total:  15.29M    Scan Rate:  78.10K
-------------------------- SNIP -------------------------
[0092] Write key rate per second:  14.66K. Total:  33.91M    Scan Rate:  32.27K
[0093] Write key rate per second:  15.00K. Total:  34.06M    Scan Rate:  30.50K
[0094] Write key rate per second:  15.00K. Total:  34.22M    Scan Rate:  32.66K
[0095] Write key rate per second:  16.00K. Total:  34.38M    Scan Rate:  32.68K
[0096] Write key rate per second:  14.00K. Total:  34.52M    Scan Rate:  28.74K
[0097] Write key rate per second:  14.00K. Total:  34.68M    Scan Rate:  33.05K
[0098] Write key rate per second:  12.00K. Total:  34.80M    Scan Rate:  24.79K
[0099] Write key rate per second:  11.69K. Total:  34.94M    Scan Rate:  28.73K
[0100] Write key rate per second:  12.78K. Total:  35.07M    Scan Rate:  28.24K
[0101] Write key rate per second:  11.69K. Total:  35.20M    Scan Rate:  25.29K
[0102] Write key rate per second:  14.00K. Total:  35.34M    Scan Rate:  29.46K
[0103] Write key rate per second:  16.00K. Total:  35.50M    Scan Rate:  33.79K
[0104] Write key rate per second:  15.00K. Total:  35.65M    Scan Rate:  31.77K

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
           8.47    0.00    9.03   82.51    0.00    0.00

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
nvme0n1           0.10         0.00         0.00          0          0
nvme12n1        242.90         0.00         2.47          0         24
nvme13n1        245.90         0.00         2.52          0         25
nvme14n1        251.30         0.00         2.52          0         25
nvme15n1        249.90         0.00         2.50          0         24
nvme16n1        245.00         0.00         2.43          0         24
nvme2n1         253.00         0.00         2.47          0         24
nvme3n1         251.50         0.00         2.51          0         25
nvme4n1         253.00         0.00         2.54          0         25
nvme5n1         251.60         0.00         2.51          0         25
nvme6n1         242.90         0.00         2.39          0         23
nvme7n1         253.20         0.00         2.51          0         25
nvme8n1         251.10         0.00         2.57          0         25
nvme9n1         249.40         0.00         2.51          0         25
nvme10n1        255.70         0.00         2.55          0         25
nvme11n1        251.80         0.00         2.50          0         25
nvme1n1         251.90         0.00         2.54          0         25

Much better?

-------------------------- SNIP -------------------------

[0159] Write key rate per second:   9.00K. Total:  42.45M    Scan Rate:  22.75K
[0160] Write key rate per second:  12.00K. Total:  42.57M    Scan Rate:  30.29K
[0161] Write key rate per second:  11.00K. Total:  42.68M    Scan Rate:  27.97K
[0162] Write key rate per second:  10.00K. Total:  42.79M    Scan Rate:  27.96K
[0163] Write key rate per second:  11.67K. Total:  42.91M    Scan Rate:  30.60K
[0164] Write key rate per second:  11.00K. Total:  43.02M    Scan Rate:  28.14K
[0165] Write key rate per second:  10.06K. Total:  43.13M    Scan Rate:  28.39K
[0166] Write key rate per second:   7.95K. Total:  43.24M    Scan Rate:  27.24K
[0167] Write key rate per second:  13.00K. Total:  43.37M    Scan Rate:  33.54K
[0168] Write key rate per second:  11.00K. Total:  43.48M    Scan Rate:  28.52K
[0169] Write key rate per second:   7.79K. Total:  43.56M    Scan Rate:  21.05K
[0170] Write key rate per second:  10.00K. Total:  43.69M    Scan Rate:  32.94K
[0171] Write key rate per second:  11.00K. Total:  43.81M    Scan Rate:  31.33K
[0172] Write key rate per second:  10.00K. Total:  43.91M    Scan Rate:  26.15K
[0173] Write key rate per second:  11.00K. Total:  44.02M    Scan Rate:  28.85K
[0174] Write key rate per second:  10.00K. Total:  44.13M    Scan Rate:  28.95K

02/04/2020 11:58:13 PM
avg-cpu:  %user   %nice %system %iowait  %steal   %idle
           5.24    0.00    7.17   87.59    0.00    0.00

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
nvme0n1           3.50         0.00         0.01          0          0
nvme12n1        247.10         0.00         1.98          0         19
nvme13n1        247.90         0.00         2.00          0         19
nvme14n1        253.80         0.00         1.97          0         19
nvme15n1        248.30         0.00         2.05          0         20
nvme16n1        249.00         0.00         2.00          0         20
nvme2n1         247.70         0.00         1.96          0         19
nvme3n1         252.00         0.00         1.99          0         19
nvme4n1         253.20         0.00         2.01          0         20
nvme5n1         246.20         0.00         2.00          0         19
nvme6n1         254.00         0.00         2.00          0         19
nvme7n1         248.10         0.00         1.95          0         19
nvme8n1         252.30         0.00         1.95          0         19
nvme9n1         251.10         0.00         2.00          0         19
nvme10n1        247.90         0.00         2.03          0         20
nvme11n1        249.70         0.00         2.01          0         20
nvme1n1         248.90         0.00         2.03          0         20

real    29m27.941s
user    7m30.464s
sys     6m47.468s

Write volume drops. 10k inserts between sync is probably too little. 100k is probably closer to correct.

922M

> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 100 --dir=$DATADIREBS -keysz 12 -read -n 16 -p -batchsize 50 -keypfx 3 -sp 16 -sync-every 1000
[0000] Write key rate per second: 158.00K. Total:   1.58M    Scan Rate:   7.45K
[0001] Write key rate per second: 142.01K. Total:   3.00M    Scan Rate:  19.33K
[0002] Write key rate per second: 131.03K. Total:   4.38M    Scan Rate:  30.39K
[0003] Write key rate per second: 124.33K. Total:   5.69M    Scan Rate:  39.13K
[0004] Write key rate per second: 124.42K. Total:   7.00M    Scan Rate:  49.36K
[0005] Write key rate per second: 128.08K. Total:   8.28M    Scan Rate:  58.23K
[0006] Write key rate per second: 127.55K. Total:   9.56M    Scan Rate:  67.77K
[0007] Write key rate per second: 125.83K. Total:  10.82M    Scan Rate:  75.94K
[0008] Write key rate per second: 122.23K. Total:  12.05M    Scan Rate:  82.72K
[0009] Write key rate per second:  99.78K. Total:  13.10M    Scan Rate:  78.57K
[0010] Write key rate per second: 102.92K. Total:  14.13M    Scan Rate:  83.38K
[0011] Write key rate per second:  96.88K. Total:  15.15M    Scan Rate:  88.79K
[0012] Write key rate per second: 100.04K. Total:  16.15M    Scan Rate:  92.77K
-------------------------- SNIP -------------------------
[0182] Write key rate per second:  21.96K. Total:  96.41M    Scan Rate: 124.90K
[0183] Write key rate per second:  23.26K. Total:  96.64M    Scan Rate: 132.18K
[0184] Write key rate per second:  29.67K. Total:  96.95M    Scan Rate: 178.83K
[0185] Write key rate per second:  31.73K. Total:  97.27M    Scan Rate: 181.47K
[0186] Write key rate per second:  24.04K. Total:  97.52M    Scan Rate: 145.91K
[0187] Write key rate per second:  25.00K. Total:  97.77M    Scan Rate: 144.26K
[0188] Write key rate per second:  12.85K. Total:  97.90M    Scan Rate:  73.78K
[0189] Write key rate per second:  37.61K. Total:  98.28M    Scan Rate: 216.41K
[0190] Write key rate per second:  29.40K. Total:  98.57M    Scan Rate: 170.63K
[0191] Write key rate per second:  16.27K. Total:  98.75M    Scan Rate: 104.41K
[0192] Write key rate per second:  45.02K. Total:  99.20M    Scan Rate: 263.53K
[0193] Write key rate per second:  45.01K. Total:  99.65M    Scan Rate: 265.12K
[0194] Write key rate per second:  32.38K. Total:  99.97M    Scan Rate: 190.59K

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          12.99    0.00   15.07   71.93    0.00    0.00

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
nvme0n1           0.00         0.00         0.00          0          0
nvme12n1        251.10         0.00         3.06          0         30
nvme13n1        247.70         0.00         5.30          0         53
nvme14n1        251.20         0.00         2.90          0         29
nvme15n1        251.00         0.00         2.19          0         21
nvme16n1        251.90         0.00         1.50          0         15
nvme2n1         251.70         0.00         2.05          0         20
nvme3n1         248.00         0.00         4.40          0         44
nvme4n1         249.80         0.00         2.30          0         22
nvme5n1         250.70         0.00         2.70          0         27
nvme6n1         249.90         0.00         2.70          0         26
nvme7n1         250.60         0.00         3.72          0         37
nvme8n1         249.40         0.00         3.24          0         32
nvme9n1         247.50         0.00         2.72          0         27
nvme10n1        249.70         0.00         2.18          0         21
nvme11n1        250.40         0.00         4.93          0         49
nvme1n1         249.80         0.00         2.11          0         21

real    32m33.245s
user    19m15.810s
sys     16m11.555s

1.7GB

Very good. Data set still fits in memory so it hasn't yet self-limited on page reads.
Continuing to 1B.

> nohup time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 900 --dir=$DATADIREBS -keysz 12 -read -n 16 -p -batchsize 50 -keypfx 3 -sp 16 -sync-every 1000 -a
[0000] Write key rate per second:  50.69K. Total: 545.85K    Scan Rate: 326.13K
[0001] Write key rate per second:  16.55K. Total: 723.65K    Scan Rate: 106.37K
[0002] Write key rate per second:   6.80K. Total: 799.20K    Scan Rate:  44.76K
[0003] Write key rate per second: 775.00.  Total: 806.95K    Scan Rate:   4.65K
[0004] Write key rate per second:  34.37K. Total:   1.17M    Scan Rate: 207.04K
[0005] Write key rate per second:  17.73K. Total:   1.36M    Scan Rate: 107.11K
[0006] Write key rate per second:  18.98K. Total:   1.55M    Scan Rate: 114.82K
[0007] Write key rate per second:  14.84K. Total:   1.71M    Scan Rate:  90.02K
[0008] Write key rate per second:  12.85K. Total:   1.84M    Scan Rate:  77.89K
[0009] Write key rate per second:  15.45K. Total:   2.00M    Scan Rate:  93.87K
[0010] Write key rate per second:  24.00K. Total:   2.24M    Scan Rate: 145.96K
[0011] Write key rate per second:  24.41K. Total:   2.49M    Scan Rate: 149.38K
[0012] Write key rate per second:  17.06K. Total:   2.67M    Scan Rate: 104.28K
-------------------------- SNIP -------------------------

Aborted.

Locked at 10k and we haven't even filled ram.
Pegged on write throughput.

This workload needs to be moved to the i3 instance class.



--- 256c 1B Keys w/ Key space 16M w/ History (NVME) ---



> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 1000 --dir=$DATADIR -keysz 12 -n 16 -p -batchsize 1000 -keypfx 3 -sp 16 -sync-every 100 -fill -history
TOTAL KEYS TO WRITE: 1000.00M
WITH VALUE SIZE:  0.00
WITH HISTORY
WITH RANDOM KEYS
BATCH SIZE 1000
CONCURRENCY 16
KEY SIZE 12
KEY PREFIX 3
KEY SPACE  16.78M
PARTITIONED
Init lmdb
Initialized after 582.542437ms
[0000] Keys per second:   1.16M Total:  11.61M Scan:  0.00   Rate:  0.00
[0001] Keys per second: 912.00K Total:  20.91M Scan: 414.19K Rate:  0.00
[0002] Keys per second: 709.20K Total:  28.07M Scan: 718.63K Rate:  1.00
[0003] Keys per second: 828.30K Total:  36.44M Scan:   1.08M Rate:  1.00
[0004] Keys per second: 995.20K Total:  46.49M Scan:   2.00M Rate:  2.00
[0005] Keys per second: 813.50K Total:  53.96M Scan:   2.09M Rate:  2.00
[0006] Keys per second:   1.02M Total:  64.13M Scan:   2.99M Rate:  2.00
[0007] Keys per second: 736.50K Total:  71.59M Scan:   2.80M Rate:  3.00
[0008] Keys per second: 730.80K Total:  78.98M Scan:   2.78M Rate:  3.00
[0009] Keys per second: 804.50K Total:  87.09M Scan:   3.60M Rate:  4.00
[0010] Keys per second: 867.00K Total:  95.86M Scan:   4.34M Rate:  5.00
[0011] Keys per second: 852.90K Total: 104.47M Scan:   4.57M Rate:  5.00
[0012] Keys per second: 852.80K Total: 113.42M Scan:   5.48M Rate:  6.00

Linux 4.14.77-70.59.amzn1.x86_64 (ip-172-31-26-138)     02/06/2020      _x86_64_        (2 CPU)

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          59.92    0.00   13.12   26.81    0.15    0.00

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
xvda              1.10         0.00         0.01          0          0
nvme0n1        5481.80         0.00       190.70          0       1907

Constrained by Write MBps

-------------------------- SNIP -------------------------

[0232] Keys per second: 259.60K Total: 969.02M Scan:  14.69M Rate: 56.00
[0233] Keys per second: 261.30K Total: 971.66M Scan:  14.84M Rate: 56.00
[0234] Keys per second: 263.60K Total: 974.32M Scan:  15.00M Rate: 56.00
[0235] Keys per second: 260.80K Total: 976.96M Scan:  14.89M Rate: 57.00
[0236] Keys per second: 262.40K Total: 979.62M Scan:  14.97M Rate: 57.00
[0237] Keys per second: 259.30K Total: 982.25M Scan:  14.89M Rate: 57.00
[0238] Keys per second: 257.10K Total: 984.84M Scan:  14.71M Rate: 57.00
[0239] Keys per second: 257.10K Total: 987.45M Scan:  14.85M Rate: 57.00
[0240] Keys per second: 259.50K Total: 990.07M Scan:  15.01M Rate: 57.00
[0241] Keys per second: 257.20K Total: 992.67M Scan:  14.78M Rate: 57.00
[0242] Keys per second: 255.60K Total: 995.26M Scan:  14.82M Rate: 57.00
[0243] Keys per second: 254.30K Total: 997.83M Scan:  14.68M Rate: 57.00
[0244] Keys per second: 197.80K Total: 999.83M Scan:  11.51M Rate: 58.00
real    41m0.047s
user    31m42.915s
sys     8m35.738s

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          21.26    0.00   14.97   63.57    0.21    0.00

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
xvda              0.40         0.00         0.00          0          0
nvme0n1        7625.30         0.00       190.72          0       1907
xvdf              0.00         0.00         0.00          0          0

24.5G


> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 1000 --dir=$DATADIR -keysz 12 -n 16 -p -batchsize 1000 -keypfx 3 -sp 16 -sync-every 100 -fill -ldbhist



--- 256c 100M Keys w/ Key space 16M w/ History (NVME) ---



> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 100 --dir=$DATADIR -keysz 12 -n 16 -p -batchsize 1000 -keypfx 3 -sp 16 -sync-every 100 -fill -history
[0000] Keys per second:   1.18M Total:  11.82M Scan:  48.64K Rate:  0.00
[0001] Keys per second: 894.10K Total:  21.28M Scan: 453.87K Rate:  0.00
[0002] Keys per second: 806.60K Total:  29.35M Scan: 864.08K Rate:  1.00
[0003] Keys per second: 863.60K Total:  38.00M Scan:   1.32M Rate:  1.00
[0004] Keys per second: 927.00K Total:  47.87M Scan:   2.03M Rate:  2.00
[0005] Keys per second: 946.20K Total:  57.85M Scan:   2.76M Rate:  2.00
[0006] Keys per second: 906.00K Total:  66.91M Scan:   2.90M Rate:  3.00
[0007] Keys per second: 850.00K Total:  75.42M Scan:   3.16M Rate:  3.00
[0008] Keys per second: 826.50K Total:  84.13M Scan:   3.81M Rate:  4.00
[0009] Keys per second: 791.70K Total:  92.00M Scan:   3.56M Rate:  4.00
real    1m50.888s
user    3m10.412s
sys     0m12.039s

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          77.68    0.00    8.37   11.82    0.00    2.13

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
xvda              0.10         0.00         0.00          0          0
nvme0n1        3376.30         0.00       164.79          0       1647
xvdf              0.00         0.00         0.00          0          0

4.3G



--- 256c 100M Keys w/ Key space 16M w/ LevelDB History (NVME + EBS) ---



> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 100 --dir=$DATADIR -keysz 12 -n 16 -p -batchsize 1000 -keypfx 3 -sp 16 -sync-every 100 -fill -ldbhist $DATADIREBS
[0000] Keys per second:   1.21M Total:  12.14M Scan:  49.19K Rate:  0.00
[0001] Keys per second: 954.60K Total:  21.67M Scan: 497.43K Rate:  0.00
[0002] Keys per second: 785.60K Total:  29.95M Scan: 902.71K Rate:  1.00
[0003] Keys per second: 875.40K Total:  39.10M Scan:   1.46M Rate:  1.00
[0004] Keys per second: 968.70K Total:  49.27M Scan:   2.18M Rate:  2.00
[0005] Keys per second: 966.20K Total:  59.47M Scan:   2.73M Rate:  2.00
[0006] Keys per second: 837.20K Total:  67.84M Scan:   2.85M Rate:  3.00
[0007] Keys per second: 870.90K Total:  76.46M Scan:   3.40M Rate:  3.00
[0008] Keys per second: 748.40K Total:  83.54M Scan:   3.46M Rate:  4.00
[0009] Keys per second: 813.10K Total:  91.66M Scan:   3.84M Rate:  4.00
real    1m54.171s
user    3m1.903s
sys     0m15.906s

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          82.03    0.00   10.03    4.61    0.05    3.29

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
xvda              0.00         0.00         0.00          0          0
nvme0n1        1828.30         0.00       168.51          0       1685
xvdf            217.10         0.00        20.98          0        209

3.0G NVME
1.2G EBS

> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 100 --dir=$DATADIR -keysz 11 -n 16 -p -batchsize 1000 -keypfx 3 -sp 16 -sync-every 100 -fill -ldbhist $DATADIREBS
[0000] Keys per second:   1.21M Total:  12.13M Scan:  51.77K Rate:  0.00
[0001] Keys per second: 968.40K Total:  21.84M Scan: 495.81K Rate:  0.00
[0002] Keys per second: 810.40K Total:  29.95M Scan: 899.83K Rate:  1.00
[0003] Keys per second: 835.80K Total:  38.31M Scan:   1.36M Rate:  1.00
[0004] Keys per second: 989.50K Total:  48.66M Scan:   2.18M Rate:  2.00
[0005] Keys per second: 993.40K Total:  58.59M Scan:   2.69M Rate:  2.00
[0006] Keys per second: 952.60K Total:  68.15M Scan:   3.10M Rate:  3.00
[0007] Keys per second: 870.20K Total:  76.85M Scan:   3.27M Rate:  3.00
[0008] Keys per second: 798.10K Total:  83.97M Scan:   3.17M Rate:  3.00
[0009] Keys per second: 849.40K Total:  92.47M Scan:   3.89M Rate:  4.00
[0010] Keys per second: 706.00K Total:  99.53M Scan:   3.80M Rate:  5.00
real    1m55.680s
user    3m2.718s
sys     0m14.746s

2.7G    /data
1.1G    /data-ebs



--- 256c 100M Keys @ 92bits w/ Key space 256M w/ LevelDB History (NVME + EBS) ---



> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 100 --dir=$DATADIR -keysz 12 -n 16 -p -batchsize 1000 -keypfx 4 -keytrunc 4 -sp 16 -sync-every 100 -fill -ldbhist $DATADIREBS
[0000] Keys per second:   1.24M Total:  12.37M Scan:  0.00 Rate:  0.00
[0001] Keys per second:   1.25M Total:  24.93M Scan:  0.00 Rate:  0.00
[0002] Keys per second:   1.18M Total:  36.76M Scan:  0.00 Rate:  0.00
[0003] Keys per second:   1.21M Total:  48.92M Scan:  0.00 Rate:  0.00
[0004] Keys per second:   1.22M Total:  61.16M Scan:  0.00 Rate:  0.00
[0005] Keys per second:   1.29M Total:  72.97M Scan:  0.00 Rate:  0.00
[0006] Keys per second:   1.16M Total:  84.61M Scan:  0.00 Rate:  0.00
[0007] Keys per second:   1.10M Total:  95.78M Scan:  0.00 Rate:  0.00
real    1m30.019s
user    2m24.895s
sys     0m13.562s

3.4G    /data
1.2G    /data-ebs



--- 256c 1B Keys @ 92bits w/ Key space 256M w/ LevelDB History (NVME + EBS) ---



> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 1000 --dir=$DATADIR -keysz 12 -n 16 -p -batchsize 1000 -keypfx 4 -keytrunc 4 -sp 16 -sync-every 100 -fill -ldbhist $DATADIREBS
[0000] Keys per second:   1.16M Total:  12.41M Scan:  0.00 Rate:  0.00
[0001] Keys per second:   1.22M Total:  24.59M Scan:  0.00 Rate:  0.00
[0002] Keys per second:   1.23M Total:  36.89M Scan:  0.00 Rate:  0.00
[0003] Keys per second:   1.22M Total:  49.13M Scan:  0.00 Rate:  0.00
[0004] Keys per second:   1.18M Total:  60.98M Scan:  0.00 Rate:  0.00
[0005] Keys per second:   1.19M Total:  72.91M Scan:  0.00 Rate:  0.00
[0006] Keys per second:   1.17M Total:  84.56M Scan:  0.00 Rate:  0.00
[0007] Keys per second:   1.23M Total:  97.41M Scan:  0.00 Rate:  0.00
[0008] Keys per second:   1.17M Total: 107.51M Scan:  0.00 Rate:  0.00
[0009] Keys per second:   1.15M Total: 119.67M Scan:  0.00 Rate:  0.00
[0010] Keys per second:   1.34M Total: 131.87M Scan:  0.00 Rate:  0.00
[0011] Keys per second:   1.27M Total: 144.00M Scan:  0.00 Rate:  0.00
[0012] Keys per second:   1.22M Total: 156.19M Scan:  0.00 Rate:  0.00
-------------------------- SNIP -------------------------
[0158] Keys per second: 442.00K Total: 947.50M Scan:   1.32M Rate:  2.00
[0159] Keys per second: 607.80K Total: 952.01M Scan:   1.61M Rate:  2.00
[0160] Keys per second: 488.70K Total: 956.08M Scan:   1.52M Rate:  3.00
[0161] Keys per second: 545.70K Total: 960.69M Scan:   1.63M Rate:  2.00
[0162] Keys per second: 521.90K Total: 965.48M Scan:   1.62M Rate:  3.00
[0163] Keys per second: 449.60K Total: 969.80M Scan:   1.25M Rate:  2.00
[0164] Keys per second: 556.40K Total: 974.15M Scan:   1.67M Rate:  2.00
[0165] Keys per second: 522.60K Total: 978.83M Scan:   1.62M Rate:  3.00
[0166] Keys per second: 460.40K Total: 983.47M Scan:   1.38M Rate:  2.00
[0167] Keys per second: 450.30K Total: 987.79M Scan:   1.29M Rate:  2.00
[0168] Keys per second: 428.60K Total: 992.37M Scan:   1.29M Rate:  3.00
[0169] Keys per second: 430.10K Total: 996.89M Scan:   1.36M Rate:  3.00
[0170] Keys per second: 442.20K Total: 1000.19M Scan:   1.33M Rate:  3.00
real    28m30.820s
user    31m7.195s
sys     4m17.000s

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          26.08    0.00    8.31   59.75    0.65    5.20

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
xvda              0.30         0.00         0.00          0          0
nvme0n1       10649.00        40.54        17.54        405        175
xvdf            118.40         0.01        11.39          0        113

23G     /data
12G     /data-ebs



--- 256c 1B Keys @ 92bits (256M/256M) w/ LevelDB History (EBS + EBS) ---



> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 1000 --dir=$DATADIREBS-2 -keysz 12 -n 16 -p -batchsize 1000 -keypfx 4 -keytrunc 4 -sp 16 -sync-every 100 -fill -ldbhist $DATADIREBS
[0000] Keys per second:   1.16M Total:  12.15M Scan:  0.00 Rate:  0.00
[0001] Keys per second:   1.17M Total:  20.18M Scan:  0.00 Rate:  0.00
[0002] Keys per second: 721.00K Total:  26.07M Scan:  0.00 Rate:  0.00
[0003] Keys per second:   1.05M Total:  36.53M Scan:  0.00 Rate:  0.00
[0004] Keys per second:   1.21M Total:  48.59M Scan:  0.00 Rate:  0.00
[0005] Keys per second: 954.10K Total:  55.17M Scan:  0.00 Rate:  0.00
[0006] Keys per second: 812.00K Total:  63.29M Scan:  0.00 Rate:  0.00
[0007] Keys per second:   1.17M Total:  74.96M Scan:  0.00 Rate:  0.00
[0008] Keys per second: 905.50K Total:  81.25M Scan:  0.00 Rate:  0.00
[0009] Keys per second: 513.30K Total:  85.64M Scan:  0.00 Rate:  0.00
[0010] Keys per second: 942.90K Total:  93.67M Scan:  0.00 Rate:  0.00
[0011] Keys per second: 999.60K Total: 103.65M Scan:  0.00 Rate:  0.00
[0012] Keys per second: 796.40K Total: 110.96M Scan:  0.00 Rate:  0.00

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
           4.88    0.00    2.72   91.61    0.74    0.06

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
xvda              0.20         0.00         0.00          0          0
nvme0n1           0.00         0.00         0.00          0          0
xvdf             64.40         0.01         5.42          0         54
xvdg           2997.10        10.14        22.64        101        226

-------------------------- SNIP -------------------------
[0257] Keys per second: 136.60K Total: 768.52M Scan: 274.90K Rate:  2.00
[0258] Keys per second: 116.50K Total: 769.69M Scan: 244.73K Rate:  2.00
[0259] Keys per second: 134.60K Total: 771.03M Scan: 269.60K Rate:  2.00
[0260] Keys per second: 135.80K Total: 772.39M Scan: 271.30K Rate:  1.00
[0261] Keys per second:  41.40K Total: 772.81M Scan:  72.90K Rate:  1.00
[0262] Keys per second:   9.20K Total: 772.90M Scan:  17.70K Rate:  1.00
[0263] Keys per second:   7.70K Total: 772.98M Scan:  16.30K Rate:  2.00
[0264] Keys per second:   8.40K Total: 773.06M Scan:  16.60K Rate:  1.00
[0265] Keys per second:  12.10K Total: 773.18M Scan:  24.30K Rate:  2.00

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
           0.41    0.00    0.36   99.07    0.16    0.00

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
xvda              3.50         0.01         0.00          0          0
nvme0n1           0.00         0.00         0.00          0          0
xvdf             15.30         0.00         0.30          0          2
xvdg            311.00         0.98         0.89          9          8

EBS BurstBalance depleted

-------------------------- SNIP -------------------------
[0466] Keys per second:   8.50K Total: 793.81M Scan:  16.13K Rate:  1.00
[0467] Keys per second:  12.50K Total: 793.94M Scan:  25.85K Rate:  2.00
[0468] Keys per second:   9.00K Total: 794.03M Scan:  19.80K Rate:  2.00
[0469] Keys per second:  12.50K Total: 794.15M Scan:  26.33K Rate:  2.00
[0470] Keys per second:   7.70K Total: 794.23M Scan:  15.00K Rate:  1.00
[0471] Keys per second:  10.40K Total: 794.34M Scan:  22.70K Rate:  2.00
[0472] Keys per second:  10.50K Total: 794.44M Scan:  22.00K Rate:  2.00
[0473] Keys per second:  10.30K Total: 794.54M Scan:  22.03K Rate:  2.00
[0474] Keys per second:   9.20K Total: 794.63M Scan:  18.30K Rate:  1.00
[0475] Keys per second:  10.30K Total: 794.74M Scan:  22.73K Rate:  2.00
[0476] Keys per second:  11.30K Total: 794.85M Scan:  24.53K Rate:  2.00
[0477] Keys per second:  10.70K Total: 794.96M Scan:  22.10K Rate:  2.00
[0478] Keys per second:   9.70K Total: 795.05M Scan:  19.70K Rate:  2.00
real    79m58.442s
user    26m34.651s
sys     3m30.678s

[Aborted]



--- 128c 1B Keys @ 90bits (32M/64M) w/ LevelDB History (NVME + EBS) --- i3.large



> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 1000 --dir=$DATADIR -keysz 12 -n 16 -p -batchsize 50 -keypfx 4 -keytrunc 6 -sp 8 -sync-every 1000 -fill -ldbhist $DATADIREBS
[0000] Keys per second: 844.85K Total:   8.45M Scan:  0.00 Rate:  0.00
[0001] Keys per second: 923.41K Total:  16.37M Scan:  0.00 Rate:  0.00
[0002] Keys per second: 968.70K Total:  24.69M Scan:   1.89K Rate:  0.00
[0003] Keys per second:   1.08M Total:  32.91M Scan: 108.90K Rate:  0.00
[0004] Keys per second: 921.63K Total:  38.62M Scan: 485.37K Rate:  0.00
[0005] Keys per second: 677.26K Total:  44.40M Scan: 641.10K Rate:  0.00
[0006] Keys per second: 731.53K Total:  49.76M Scan: 689.51K Rate:  0.00
[0007] Keys per second: 730.30K Total:  55.58M Scan: 644.97K Rate:  0.00
[0008] Keys per second: 720.36K Total:  61.19M Scan: 807.08K Rate:  1.00
[0009] Keys per second: 743.86K Total:  67.25M Scan:   1.01M Rate:  1.00
[0010] Keys per second: 950.90K Total:  74.28M Scan:   1.67M Rate:  1.00
[0011] Keys per second:   1.05M Total:  81.39M Scan:   2.14M Rate:  2.00
[0012] Keys per second: 873.30K Total:  88.46M Scan:   1.89M Rate:  2.00
-------------------------- SNIP -------------------------
[0208] Keys per second: 304.49K Total: 966.69M Scan:  12.19M Rate: 40.00
[0209] Keys per second: 285.37K Total: 969.54M Scan:  11.07M Rate: 38.00
[0210] Keys per second: 291.19K Total: 972.65M Scan:  11.92M Rate: 40.00
[0211] Keys per second: 327.52K Total: 976.03M Scan:  13.10M Rate: 40.00
[0212] Keys per second: 306.77K Total: 979.17M Scan:  12.15M Rate: 39.00
[0213] Keys per second: 329.07K Total: 982.66M Scan:  13.63M Rate: 41.00
[0214] Keys per second: 302.39K Total: 985.94M Scan:  12.82M Rate: 42.00
[0215] Keys per second: 300.63K Total: 988.93M Scan:  11.48M Rate: 38.00
[0216] Keys per second: 269.13K Total: 991.63M Scan:  10.27M Rate: 38.00
[0217] Keys per second: 271.49K Total: 994.65M Scan:  11.36M Rate: 41.00
[0218] Keys per second: 281.39K Total: 997.42M Scan:  11.02M Rate: 39.00
[0219] Keys per second: 244.83K Total: 999.97M Scan:  10.08M Rate: 41.00
[0220] Keys per second: 247.50K Total: 1000.00M Scan:  10.19M Rate: 41.00
real    36m45.726s
user    42m28.368s
sys     13m16.457s

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          29.82    0.00   16.23   53.61    0.34    0.00

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
xvda              0.40         0.00         0.00          0          0
nvme0n1        7867.50        17.81       190.70        178       1906
xvdf            445.70         0.01        10.67          0        106

After 1.6 Billion events:

24G     /data
19G     /data-ebs

@ 1.4B: 17.0 Bytes NVME + 12 Bytes EBS / evt
@ 1.6B: 15.5 Bytes NVME + 12 Bytes EBS / evt



!!!!    Tuned param lmdb.NoMetaSync     !!!!!!
!!!!    Tuned param lmdb.NoDupData      !!!!!!
!!!!    Tuned param lmdb.DupSort        !!!!!!
!!!!    Tuned param lmdb.DupFixed       !!!!!!



--- 256c 1B Keys @ 90bits (64M/64M) w/ LevelDB History (NVME + EBS) --- i3.large --- 47bd1413.png



> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 1000 --dir=$DATADIR -keysz 12 -n 16 -p -batchsize 100 -keypfx 4 -keytrunc 6 -sp 16 -sync-every 1000 -fill -ldbhist $DATADIREBS
[0000] Keys per second: 990.96K Total:  10.43M Scan:  0.00 Rate:  0.00
[0001] Keys per second:   1.10M Total:  20.32M Scan:  0.00 Rate:  0.00
[0002] Keys per second:   1.05M Total:  30.17M Scan:  0.00 Rate:  0.00
[0003] Keys per second:   1.05M Total:  39.72M Scan:  0.00 Rate:  0.00
[0004] Keys per second:   1.11M Total:  50.27M Scan:   8.82K Rate:  0.00
[0005] Keys per second: 982.05K Total:  58.96M Scan:  85.35K Rate:  0.00
[0006] Keys per second:   1.13M Total:  68.40M Scan: 330.03K Rate:  0.00
[0007] Keys per second:   1.01M Total:  74.82M Scan: 605.11K Rate:  0.00
[0008] Keys per second: 865.57K Total:  81.38M Scan: 774.46K Rate:  0.00
[0009] Keys per second: 736.80K Total:  87.63M Scan: 724.20K Rate:  0.00
[0010] Keys per second: 711.40K Total:  93.46M Scan: 709.83K Rate:  0.00
[0011] Keys per second: 997.94K Total: 100.49M Scan: 997.94K Rate:  1.00
[0012] Keys per second:   1.30M Total: 107.16M Scan:   1.30M Rate:  1.00
[0013] Keys per second: 943.79K Total: 113.52M Scan: 946.98K Rate:  1.00
[0014] Keys per second:   1.04M Total: 119.55M Scan: 986.21K Rate:  0.00
[0015] Keys per second: 817.03K Total: 126.78M Scan: 820.19K Rate:  1.00
[0016] Keys per second: 935.84K Total: 134.81M Scan:   1.29M Rate:  1.00
-------------------------- SNIP -------------------------
[0132] Keys per second: 778.84K Total: 871.97M Scan:   8.29M Rate: 10.00
[0133] Keys per second: 957.91K Total: 879.66M Scan:   9.82M Rate: 10.00
[0134] Keys per second: 813.21K Total: 886.88M Scan:   8.97M Rate: 11.00
[0135] Keys per second: 823.99K Total: 893.48M Scan:   9.66M Rate: 11.00
[0136] Keys per second: 739.19K Total: 900.71M Scan:   8.46M Rate: 11.00
[0137] Keys per second: 732.35K Total: 908.04M Scan:   8.50M Rate: 11.00
[0138] Keys per second: 789.36K Total: 914.50M Scan:   9.28M Rate: 11.00
[0139] Keys per second:   1.08M Total: 922.03M Scan:  12.88M Rate: 11.00
[0140] Keys per second: 923.14K Total: 928.96M Scan:  10.76M Rate: 11.00
[0141] Keys per second: 954.07K Total: 936.32M Scan:  11.80M Rate: 12.00
[0142] Keys per second: 787.38K Total: 943.41M Scan:   9.90M Rate: 12.00
[0143] Keys per second: 790.38K Total: 950.64M Scan:  10.26M Rate: 12.00
[0144] Keys per second: 866.33K Total: 957.38M Scan:  11.03M Rate: 12.00
[0145] Keys per second: 679.60K Total: 964.35M Scan:   8.37M Rate: 12.00
[0146] Keys per second: 791.33K Total: 971.64M Scan:  10.06M Rate: 12.00
[0147] Keys per second: 861.75K Total: 979.56M Scan:  11.01M Rate: 12.00
[0148] Keys per second: 742.35K Total: 987.06M Scan:  10.43M Rate: 14.00
[0149] Keys per second: 707.62K Total: 994.20M Scan:   9.63M Rate: 13.00
[0150] Keys per second: 717.32K Total: 1000.01M Scan:   9.95M Rate: 13.00
real    25m12.076s
user    34m44.311s
sys     6m23.227s

continuing...

> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 1000 --dir=$DATADIR -keysz 12 -n 16 -p -batchsize 100 -keypfx 4 -keytrunc 6 -sp 16 -sync-every 1000 -fill -ldbhist $DATADIREBS -a
[0000] Keys per second: 710.88K Total:   7.11M Scan:  10.66M Rate: 15.00
[0001] Keys per second: 922.06K Total:  13.51M Scan:  13.83M Rate: 15.00
[0002] Keys per second: 875.10K Total:  20.55M Scan:  11.25M Rate: 12.00
[0003] Keys per second: 972.81K Total:  26.87M Scan:  13.95M Rate: 14.00
[0004] Keys per second: 784.08K Total:  33.94M Scan:  11.50M Rate: 14.00
[0005] Keys per second: 776.20K Total:  40.16M Scan:  11.54M Rate: 14.00
[0006] Keys per second: 863.56K Total:  46.24M Scan:  12.36M Rate: 14.00
[0007] Keys per second: 924.66K Total:  51.95M Scan:  14.40M Rate: 15.00
[0008] Keys per second: 662.59K Total:  56.85M Scan:  10.56M Rate: 15.00
[0009] Keys per second: 541.97K Total:  62.05M Scan:   8.65M Rate: 15.00
[0010] Keys per second: 650.19K Total:  67.50M Scan:  10.61M Rate: 16.00
[0011] Keys per second: 565.44K Total:  72.56M Scan:   9.74M Rate: 17.00
[0012] Keys per second: 600.00K Total:  78.48M Scan:  10.12M Rate: 16.00
[0013] Keys per second: 509.06K Total:  83.57M Scan:   8.52M Rate: 16.00
[0014] Keys per second: 574.89K Total:  89.32M Scan:   9.76M Rate: 16.00
[0015] Keys per second: 586.40K Total:  95.19M Scan:  10.01M Rate: 17.00
[0016] Keys per second: 548.48K Total: 100.67M Scan:  10.29M Rate: 18.00
[0017] Keys per second: 529.11K Total: 105.96M Scan:   9.99M Rate: 18.00
-------------------------- SNIP -------------------------
[0545] Keys per second: 180.49K Total: 971.01M Scan:   5.14M Rate: 28.00
[0546] Keys per second: 170.13K Total: 972.48M Scan:   4.85M Rate: 28.00
[0547] Keys per second: 145.71K Total: 973.94M Scan:   4.14M Rate: 28.00
[0548] Keys per second: 173.57K Total: 975.46M Scan:   4.97M Rate: 28.00
[0549] Keys per second: 172.72K Total: 976.95M Scan:   4.96M Rate: 28.00
[0550] Keys per second: 140.63K Total: 978.35M Scan:   4.03M Rate: 28.00
[0551] Keys per second: 175.39K Total: 979.94M Scan:   5.04M Rate: 28.00
[0552] Keys per second: 150.12K Total: 981.44M Scan:   4.59M Rate: 30.00
[0553] Keys per second: 114.42K Total: 982.59M Scan:   3.31M Rate: 28.00
[0554] Keys per second: 161.66K Total: 984.21M Scan:   4.66M Rate: 28.00
[0555] Keys per second: 171.40K Total: 985.80M Scan:   4.95M Rate: 28.00
[0556] Keys per second: 153.12K Total: 987.36M Scan:   4.50M Rate: 29.00
[0557] Keys per second: 136.25K Total: 988.67M Scan:   3.76M Rate: 27.00
[0558] Keys per second: 174.00K Total: 990.27M Scan:   4.91M Rate: 28.00
[0559] Keys per second: 141.87K Total: 991.68M Scan:   4.11M Rate: 29.00
[0560] Keys per second: 163.76K Total: 993.32M Scan:   4.75M Rate: 29.00
[0561] Keys per second: 221.13K Total: 995.53M Scan:   6.41M Rate: 29.00
[0562] Keys per second: 224.34K Total: 997.87M Scan:   6.78M Rate: 30.00
[0563] Keys per second: 299.27K Total: 1000.01M Scan:   8.68M Rate: 29.00
real    94m5.980s
user    49m5.888s
sys     25m36.024s

23G     /data
23G     /data-ebs

continuing w/ batch size 10 ...

> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 100 --dir=$DATADIR -keysz 12 -n 16 -p -batchsize 10 -keypfx 4 -keytrunc 6 -sp 16 -sync-every 10000 -fill -ldbhist $DATADIREBS -a
[0000] Keys per second: 215.18K Total:   2.15M Scan:   6.46M Rate: 30.00
[0001] Keys per second: 358.70K Total:   4.18M Scan:  11.03M Rate: 30.00
[0002] Keys per second: 333.45K Total:   6.27M Scan:  10.00M Rate: 30.00
[0003] Keys per second: 316.88K Total:   8.62M Scan:   9.51M Rate: 30.00
[0004] Keys per second: 350.99K Total:  10.54M Scan:   9.59M Rate: 27.00
[0005] Keys per second: 295.96K Total:  12.73M Scan:   7.95M Rate: 26.00
[0006] Keys per second: 296.88K Total:  14.55M Scan:   9.32M Rate: 31.00
[0007] Keys per second: 288.44K Total:  16.50M Scan:   9.22M Rate: 31.00
[0008] Keys per second: 307.19K Total:  18.55M Scan:   8.63M Rate: 28.00
[0009] Keys per second: 338.81K Total:  20.32M Scan:   9.89M Rate: 29.00
[0010] Keys per second: 257.68K Total:  22.43M Scan:   8.14M Rate: 31.00
[0011] Keys per second: 256.16K Total:  24.26M Scan:   8.14M Rate: 31.00
[0012] Keys per second: 257.84K Total:  26.23M Scan:   5.93M Rate: 23.00
-------------------------- SNIP -------------------------
[0061] Keys per second: 123.65K Total:  82.75M Scan:   3.88M Rate: 31.00
[0062] Keys per second: 109.14K Total:  83.74M Scan:   3.64M Rate: 33.00
[0063] Keys per second:  87.74K Total:  84.62M Scan:   2.73M Rate: 31.00
[0064] Keys per second: 114.66K Total:  85.66M Scan:   3.55M Rate: 31.00
[0065] Keys per second: 117.64K Total:  86.65M Scan:   3.65M Rate: 31.00
[0066] Keys per second: 101.50K Total:  87.53M Scan:   3.03M Rate: 29.00
[0067] Keys per second: 115.55K Total:  88.61M Scan:   3.74M Rate: 32.00
[0068] Keys per second: 123.94K Total:  89.60M Scan:   3.95M Rate: 31.00
[0069] Keys per second: 114.92K Total:  90.67M Scan:   3.46M Rate: 30.00
[0070] Keys per second: 141.86K Total:  91.72M Scan:   4.22M Rate: 29.00
[0071] Keys per second:  99.68K Total:  92.56M Scan:   2.96M Rate: 29.00
[0072] Keys per second: 148.72K Total:  93.75M Scan:   4.72M Rate: 31.00
[0073] Keys per second: 120.84K Total:  94.61M Scan:   3.75M Rate: 31.00
[0074] Keys per second: 131.36K Total:  95.70M Scan:   4.07M Rate: 31.00
[0075] Keys per second: 138.62K Total:  96.82M Scan:   3.29M Rate: 23.00
[0076] Keys per second: 101.50K Total:  97.72M Scan:   2.93M Rate: 28.00
[0077] Keys per second: 119.90K Total:  98.82M Scan:   3.85M Rate: 32.00
[0078] Keys per second: 109.84K Total:  99.91M Scan:   3.28M Rate: 29.00
[0079] Keys per second: 106.31K Total: 100.00M Scan:   3.30M Rate: 31.00
real    13m20.820s
user    8m50.727s
sys     6m35.163s

24G     /data
25G     /data-ebs

Quite good. DB size deceeds 12B/key.



--- 256c 1B Keys @ 92bits (256M/256M) w/ LevelDB History (NVME + EBS) --- i3.large



> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 1000 --dir=$DATADIR -keysz 12 -n 16 -p -batchsize 100 -keypfx 4 -keytrunc 4 -sp 16 -sync-every 1000 -fill -ldbhist $DATADIREBS
[0000] Keys per second:   1.04M Total:  10.38M Scan:  0.00 Rate:  0.00
[0001] Keys per second:   1.10M Total:  20.35M Scan:  0.00 Rate:  0.00
[0002] Keys per second: 983.91K Total:  30.00M Scan:  0.00 Rate:  0.00
[0003] Keys per second: 982.52K Total:  39.52M Scan:  0.00 Rate:  0.00
[0004] Keys per second:   1.02M Total:  49.26M Scan:  0.00 Rate:  0.00
[0005] Keys per second:   1.00M Total:  59.32M Scan:  0.00 Rate:  0.00
[0006] Keys per second:   1.06M Total:  68.58M Scan:  0.00 Rate:  0.00
[0007] Keys per second: 937.80K Total:  77.50M Scan:  0.00 Rate:  0.00
[0008] Keys per second: 828.84K Total:  86.44M Scan:  0.00 Rate:  0.00
[0009] Keys per second: 921.90K Total:  95.22M Scan:  0.00 Rate:  0.00
[0010] Keys per second:   1.06M Total: 104.51M Scan:  0.00 Rate:  0.00
[0011] Keys per second:   1.09M Total: 113.95M Scan:  0.00 Rate:  0.00
[0012] Keys per second: 928.60K Total: 123.26M Scan:  0.00 Rate:  0.00
-------------------------- SNIP -------------------------
[0187] Keys per second: 573.53K Total: 955.11M Scan:   1.72M Rate:  3.00
[0188] Keys per second: 457.77K Total: 958.60M Scan:   1.37M Rate:  3.00
[0189] Keys per second: 586.78K Total: 962.95M Scan:   1.76M Rate:  3.00
[0190] Keys per second: 453.50K Total: 966.83M Scan:   1.36M Rate:  3.00
[0191] Keys per second: 392.26K Total: 970.75M Scan:   1.22M Rate:  3.00
[0192] Keys per second: 466.14K Total: 974.68M Scan:   1.40M Rate:  3.00
[0193] Keys per second: 427.70K Total: 978.73M Scan:   1.28M Rate:  3.00
[0194] Keys per second: 408.23K Total: 982.81M Scan:   1.23M Rate:  3.00
[0195] Keys per second: 383.23K Total: 986.64M Scan:   1.12M Rate:  2.00
[0196] Keys per second: 367.48K Total: 990.56M Scan:   1.10M Rate:  3.00
[0197] Keys per second: 377.25K Total: 994.63M Scan:   1.13M Rate:  2.00
[0198] Keys per second: 351.59K Total: 998.37M Scan:   1.05M Rate:  3.00
[0199] Keys per second: 387.86K Total: 1000.01M Scan:   1.16M Rate:  3.00
real    33m19.168s
user    35m11.021s
sys     9m17.221s

21G     /data
11G     /data-ebs

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
           9.71    0.00    9.06   48.53    1.22   31.49

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
xvda              0.20         0.00         0.00          0          0
nvme0n1       14343.90        52.40        31.26        523        312
xvdf             28.00         0.00         1.39          0         13


continuing...


> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 1000 --dir=$DATADIR -keysz 12 -n 16 -p -batchsize 100  -keypfx 4 -keytrunc 4 -sp 16 -sync-every 1000 -fill -ldbhist $DATADIREBS -a
[0000] Keys per second: 385.01K Total:   3.85M Scan:   1.54M Rate:  4.00
[0001] Keys per second: 477.79K Total:   7.37M Scan:   1.91M Rate:  4.00
[0002] Keys per second: 504.21K Total:  11.33M Scan:   1.99M Rate:  3.00
[0003] Keys per second: 448.59K Total:  14.99M Scan:   1.71M Rate:  3.00
[0004] Keys per second: 564.70K Total:  18.56M Scan:   2.19M Rate:  3.00
[0005] Keys per second: 473.51K Total:  21.65M Scan:   1.86M Rate:  3.00
[0006] Keys per second: 309.77K Total:  24.67M Scan:   1.27M Rate:  4.00
[0007] Keys per second: 451.97K Total:  28.27M Scan:   1.73M Rate:  3.00
[0008] Keys per second: 470.59K Total:  32.13M Scan:   1.77M Rate:  3.00
[0009] Keys per second: 446.20K Total:  35.38M Scan:   1.78M Rate:  4.00
[0010] Keys per second: 562.16K Total:  39.20M Scan:   2.25M Rate:  4.00
[0011] Keys per second: 399.67K Total:  42.21M Scan:   1.73M Rate:  4.00
[0012] Keys per second: 492.00K Total:  45.42M Scan:   1.97M Rate:  4.00
-------------------------- SNIP -------------------------
[0339] Keys per second: 383.40K Total: 968.38M Scan:   2.52M Rate:  6.00
[0340] Keys per second: 391.35K Total: 970.95M Scan:   2.30M Rate:  5.00
[0341] Keys per second: 329.90K Total: 973.20M Scan:   2.13M Rate:  6.00
[0342] Keys per second: 381.93K Total: 975.89M Scan:   2.35M Rate:  6.00
[0343] Keys per second: 294.46K Total: 978.36M Scan:   2.03M Rate:  6.00
[0344] Keys per second: 280.94K Total: 980.84M Scan:   2.03M Rate:  7.00
[0345] Keys per second: 331.82K Total: 983.57M Scan:   2.10M Rate:  6.00
[0346] Keys per second: 348.02K Total: 986.18M Scan:   2.12M Rate:  6.00
[0347] Keys per second: 313.42K Total: 988.78M Scan:   2.23M Rate:  7.00
[0348] Keys per second: 272.32K Total: 991.17M Scan:   1.82M Rate:  6.00
[0349] Keys per second: 242.45K Total: 993.60M Scan:   1.70M Rate:  6.00
[0350] Keys per second: 270.83K Total: 996.31M Scan:   1.90M Rate:  7.00
[0351] Keys per second: 256.32K Total: 998.87M Scan:   1.79M Rate:  7.00
real    58m54.564s
user    39m10.823s
sys     17m52.240s

22G     /data
12G     /data-ebs

Scan rate seems correct: 2B / 2 ^ 28 = 7.45



--- 256c 1B Keys @ 92bits (256M/256M) w/ Key Size 20 w/ LevelDB History (NVME + EBS) --- i3.large



> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 1000 --dir=$DATADIR -keysz 20 -n 16 -p -batchsize 100 -keypfx 4 -keytrunc 4 -sp 16 -sync-every 1000 -fill -ldbhist $DATADIREBS
[0000] Keys per second:   1.01M Total:  10.11M Scan:  0.00 Rate:  0.00
[0001] Keys per second:   1.03M Total:  19.79M Scan:  0.00 Rate:  0.00
[0002] Keys per second:   1.15M Total:  29.22M Scan:  0.00 Rate:  0.00
[0003] Keys per second:   1.10M Total:  38.95M Scan:  0.00 Rate:  0.00
[0004] Keys per second: 910.75K Total:  46.33M Scan:  0.00 Rate:  0.00
[0005] Keys per second: 873.70K Total:  55.09M Scan:  0.00 Rate:  0.00
[0006] Keys per second: 911.22K Total:  63.80M Scan:  0.00 Rate:  0.00
[0007] Keys per second:   1.13M Total:  72.91M Scan:  0.00 Rate:  0.00
[0008] Keys per second:   1.09M Total:  83.01M Scan:  0.00 Rate:  0.00
[0009] Keys per second: 964.25K Total:  91.09M Scan:  0.00 Rate:  0.00
[0010] Keys per second: 985.99K Total: 100.66M Scan:  0.00 Rate:  0.00
[0011] Keys per second:   1.03M Total: 108.95M Scan:  0.00 Rate:  0.00
[0012] Keys per second: 901.79K Total: 117.97M Scan:  0.00 Rate:  0.00
-------------------------- SNIP -------------------------
[0220] Keys per second: 473.63K Total: 959.45M Scan:   1.44M Rate:  3.00
[0221] Keys per second: 371.87K Total: 962.48M Scan:   1.15M Rate:  3.00
[0222] Keys per second: 461.04K Total: 966.13M Scan:   1.42M Rate:  3.00
[0223] Keys per second: 387.03K Total: 969.17M Scan:   1.37M Rate:  3.00
[0224] Keys per second: 322.93K Total: 972.19M Scan:   1.09M Rate:  3.00
[0225] Keys per second: 392.58K Total: 975.62M Scan:   1.11M Rate:  2.00
[0226] Keys per second: 356.75K Total: 979.17M Scan:   1.19M Rate:  3.00
[0227] Keys per second: 273.19K Total: 981.91M Scan: 884.28K Rate:  3.00
[0228] Keys per second: 337.22K Total: 985.28M Scan: 948.09K Rate:  2.00
[0229] Keys per second: 354.31K Total: 988.76M Scan:   1.04M Rate:  2.00
[0230] Keys per second: 294.98K Total: 991.71M Scan: 868.62K Rate:  2.00
[0231] Keys per second: 349.08K Total: 995.20M Scan: 971.97K Rate:  2.00
[0232] Keys per second: 325.69K Total: 998.59M Scan: 989.19K Rate:  3.00
real    39m2.514s
user    35m49.905s
sys     11m5.194s

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          22.67    0.00   12.69   35.95    1.03   27.66

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
xvda              0.00         0.00         0.00          0          0
nvme0n1       10492.50        39.69        22.06        396        220
xvdf             85.40         0.01         8.41          0         84

31G     /data
19G     /data-ebs



--- 32c (32/256) 1B Keys @ 90bits (8M/64M) w/ LevelDB History (EBS + EBS) --- a1.medium --- 81c77a2e.png



> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 1000 --dir=$DATADIREBS -keysz 12 -n 4 -p -batchsize 50 -keypfx 4 -keytrunc 6 -sp 16 -sync-every 1000 -fill -ldbhist $DATADIREBS
[0000] Keys per second: 413.02K Total:   4.13M Scan:  0.00 Rate:  0.00
[0001] Keys per second: 431.68K Total:   7.75M Scan:  17.92K Rate:  0.00
[0002] Keys per second: 330.35K Total:  10.69M Scan: 221.03K Rate:  0.00
[0003] Keys per second: 310.63K Total:  13.22M Scan: 309.42K Rate:  0.00
[0004] Keys per second: 338.91K Total:  16.06M Scan: 372.28K Rate:  1.00
[0005] Keys per second: 384.05K Total:  19.49M Scan: 688.93K Rate:  1.00
[0006] Keys per second: 406.70K Total:  22.80M Scan: 750.08K Rate:  1.00
[0007] Keys per second: 372.50K Total:  25.96M Scan: 811.70K Rate:  2.00
[0008] Keys per second: 365.15K Total:  29.61M Scan:   1.14M Rate:  3.00
[0009] Keys per second: 368.21K Total:  32.62M Scan:   1.14M Rate:  3.00
[0010] Keys per second: 296.65K Total:  35.26M Scan:   1.15M Rate:  3.00
[0011] Keys per second: 208.68K Total:  37.31M Scan: 809.35K Rate:  3.00
[0012] Keys per second: 242.10K Total:  39.77M Scan:   1.14M Rate:  4.00
-------------------------- SNIP -------------------------
[0766] Keys per second:  22.44K Total: 349.43M Scan: 774.52K Rate: 34.00
[0767] Keys per second:  24.00K Total: 349.67M Scan: 829.18K Rate: 34.00
[0768] Keys per second:  22.55K Total: 349.90M Scan: 787.88K Rate: 34.00
[0769] Keys per second:  24.02K Total: 350.14M Scan: 829.61K Rate: 34.00
[0770] Keys per second:  22.80K Total: 350.37M Scan: 792.12K Rate: 34.00
[0771] Keys per second:  23.00K Total: 350.60M Scan: 794.38K Rate: 34.00
[0772] Keys per second:  23.29K Total: 350.83M Scan: 810.36K Rate: 34.00
[0773] Keys per second:  22.25K Total: 351.05M Scan: 767.17K Rate: 34.00
[0774] Keys per second:  24.09K Total: 351.29M Scan: 842.89K Rate: 34.00
[0775] Keys per second:  23.21K Total: 351.53M Scan: 801.48K Rate: 34.00
[0776] Keys per second:  23.48K Total: 351.76M Scan: 814.41K Rate: 34.00
[0777] Keys per second:  23.32K Total: 352.00M Scan: 804.98K Rate: 34.00
[0778] Keys per second:  23.00K Total: 352.23M Scan: 800.28K Rate: 34.00
real    130m2.591s
user    21m28.291s
sys     19m19.485s

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          15.57    0.00   14.86   69.57    0.00    0.00

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
nvme0n1           0.00         0.00         0.00          0          0
nvme2n1        2500.61         8.69        12.52         85        123
nvme1n1          37.11         0.01         3.98          0         39

6.6G    /data-ebs

Not even burst throttled. Restarting at 92bits



--- 32c (32/256) 1B Keys @ 92bits (32M/256M) w/ LevelDB History (EBS + EBS) --- a1.medium



> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 1000 --dir=$DATADIREBS -keysz 12 -n 16 -p -batchsize 100 -keypfx 4 -keytrunc 4 -sp 2 -sync-every 1000 -fill -ldbhist $DATADIREBS
[0000] Keys per second: 512.75K Total:   5.13M Scan:  0.00   Rate:  0.00
[0001] Keys per second: 538.17K Total:   9.48M Scan:  0.00   Rate:  0.00
[0002] Keys per second: 513.47K Total:  13.72M Scan:  0.00   Rate:  0.00
[0003] Keys per second: 521.63K Total:  18.43M Scan:  0.00   Rate:  0.00
[0004] Keys per second: 527.47K Total:  22.72M Scan:  0.00   Rate:  0.00
[0005] Keys per second: 471.48K Total:  27.08M Scan:  0.00   Rate:  0.00
[0006] Keys per second: 538.97K Total:  31.63M Scan:   1.57K Rate:  0.00
[0007] Keys per second: 285.79K Total:  34.49M Scan:  92.26K Rate:  0.00
[0008] Keys per second: 202.10K Total:  36.51M Scan: 195.62K Rate:  0.00
[0009] Keys per second: 193.94K Total:  38.56M Scan: 196.38K Rate:  1.00
[0010] Keys per second: 204.95K Total:  40.61M Scan: 197.63K Rate:  0.00
[0011] Keys per second: 202.92K Total:  42.64M Scan: 194.79K Rate:  0.00
[0012] Keys per second: 193.37K Total:  44.67M Scan: 196.07K Rate:  1.00
-------------------------- SNIP -------------------------
[0214] Keys per second:  53.47K Total: 218.12M Scan: 309.12K Rate:  5.00
[0215] Keys per second:  51.56K Total: 218.64M Scan: 296.58K Rate:  5.00
[0216] Keys per second:  52.41K Total: 219.16M Scan: 302.34K Rate:  5.00
[0217] Keys per second:  53.62K Total: 219.70M Scan: 313.02K Rate:  5.00
[0218] Keys per second:  50.51K Total: 220.20M Scan: 291.06K Rate:  5.00
[0219] Keys per second:  53.12K Total: 220.73M Scan: 306.54K Rate:  5.00
[0220] Keys per second:  52.48K Total: 221.26M Scan: 303.30K Rate:  5.00
[0221] Keys per second:  51.44K Total: 221.77M Scan: 296.34K Rate:  5.00
[0222] Keys per second:  52.07K Total: 222.29M Scan: 300.12K Rate:  5.00
[0223] Keys per second:  53.96K Total: 222.83M Scan: 315.54K Rate:  5.00
[0224] Keys per second:  51.08K Total: 223.35M Scan: 294.00K Rate:  5.00
[0225] Keys per second:  54.04K Total: 223.89M Scan: 312.18K Rate:  5.00
[0226] Keys per second:  52.24K Total: 224.41M Scan: 301.02K Rate:  5.00

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          16.67    0.00   13.77   69.57    0.00    0.00

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
nvme0n1           0.00         0.00         0.00          0          0
nvme2n1        2524.22         9.22        12.95         89        125
nvme1n1           0.00         0.00         0.00          0          0

9.3GB    /data-ebs

Still IO bound



--- 64c (64/256) 1B Keys @ 92bits (64M/256M) w/ LevelDB History (EBS + EBS) --- a1.medium



> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 1000 --dir=$DATADIREBS -keysz 12 -n 16 -p -batchsize 100 -keypfx 4 -keytrunc 4 -sp 4 -sync-every 1000 -fill -ldbhist $DATADIREBS
[0000] Keys per second: 532.65K Total:   5.33M Scan:  0.00   Rate:  0.00
[0001] Keys per second: 597.29K Total:   9.55M Scan:  0.00   Rate:  0.00
[0002] Keys per second: 590.58K Total:  14.24M Scan:  0.00   Rate:  0.00
[0003] Keys per second: 553.69K Total:  18.86M Scan:  0.00   Rate:  0.00
[0004] Keys per second: 530.05K Total:  23.14M Scan:  0.00   Rate:  0.00
[0005] Keys per second: 556.41K Total:  27.35M Scan:  0.00   Rate:  0.00
[0006] Keys per second: 500.63K Total:  31.76M Scan:  0.00   Rate:  0.00
[0007] Keys per second: 487.20K Total:  36.54M Scan:  0.00   Rate:  0.00
[0008] Keys per second: 602.18K Total:  41.49M Scan:  0.00   Rate:  0.00
[0009] Keys per second: 698.38K Total:  45.07M Scan:  0.00   Rate:  0.00
[0010] Keys per second: 646.88K Total:  49.44M Scan:  0.00   Rate:  0.00
[0011] Keys per second: 626.76K Total:  53.71M Scan:  0.00   Rate:  0.00
[0012] Keys per second: 620.08K Total:  58.41M Scan:  0.00   Rate:  0.00
-------------------------- SNIP -------------------------
[0962] Keys per second:  51.74K Total: 711.89M Scan: 504.08K Rate:  9.00
[0963] Keys per second:  51.74K Total: 712.41M Scan: 503.94K Rate:  9.00
[0964] Keys per second:  51.56K Total: 712.92M Scan: 501.68K Rate:  9.00
[0965] Keys per second:  52.07K Total: 713.45M Scan: 505.96K Rate:  9.00
[0966] Keys per second:  51.91K Total: 713.97M Scan: 504.99K Rate:  9.00
[0967] Keys per second:  51.71K Total: 714.49M Scan: 503.24K Rate:  9.00
[0968] Keys per second:  51.79K Total: 715.01M Scan: 503.69K Rate:  9.00
[0969] Keys per second:  51.62K Total: 715.53M Scan: 502.80K Rate:  9.00
[0970] Keys per second:  51.45K Total: 716.05M Scan: 500.70K Rate:  9.00
[0971] Keys per second:  51.72K Total: 716.57M Scan: 504.30K Rate:  9.00
[0972] Keys per second:  51.68K Total: 717.09M Scan: 503.10K Rate:  9.00
[0973] Keys per second:  51.82K Total: 717.61M Scan: 504.90K Rate:  9.00
[0974] Keys per second:  51.92K Total: 718.12M Scan: 506.00K Rate:  9.00
real    162m38.864s
user    33m16.033s
sys     23m28.748s

22GB @ 730M map + history



--- 256c (256/256) 200M Keys @ 92bits (256M/256M) w/ LMDB History (NVME + NVME) --- local vm



> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 200 --dir=$DATADIR -keysz 20 -n 16 -p -batchsize 100 -keypfx 4 -sp 16 -keytrunc 4 -fill -sync-every 100 -exp 10s -history
[0000] Keys per second:   1.22M Total:  12.25M Del: 10.00 Scan:  0.00 Rate:  0.00
[0001] Keys per second: 792.55K Total:  19.65M Del: 609.10K Scan:  0.00 Rate:  0.00
[0002] Keys per second: 338.46K Total:  23.04M Del: 491.92K Scan:  0.00 Rate:  0.00
[0003] Keys per second: 313.51K Total:  26.16M Del: 522.67K Scan:  0.00 Rate:  0.00
[0004] Keys per second: 346.66K Total:  29.64M Del: 428.93K Scan:  0.00 Rate:  0.00
[0005] Keys per second: 341.82K Total:  33.06M Del: 439.96K Scan:  0.00 Rate:  0.00
[0006] Keys per second: 372.10K Total:  36.78M Del: 437.09K Scan:  0.00 Rate:  0.00
[0007] Keys per second: 453.25K Total:  41.33M Del: 388.81K Scan:  0.00 Rate:  0.00
[0008] Keys per second: 603.43K Total:  46.96M Del: 536.59K Scan:  0.00 Rate:  0.00
[0009] Keys per second: 560.72K Total:  52.55M Del: 539.53K Scan:  0.00 Rate:  0.00
[0010] Keys per second: 520.59K Total:  57.83M Del: 546.73K Scan:  0.00 Rate:  0.00
[0011] Keys per second: 497.75K Total:  62.69M Del: 437.34K Scan:  0.00 Rate:  0.00
[0012] Keys per second: 509.35K Total:  67.93M Del: 521.75K Scan:  0.00 Rate:  0.00
[0013] Keys per second: 443.02K Total:  73.05M Del: 509.72K Scan:  0.00 Rate:  0.00
[0014] Keys per second: 483.93K Total:  77.88M Del: 505.04K Scan:  0.00 Rate:  0.00
[0015] Keys per second: 506.83K Total:  82.94M Del: 546.81K Scan:  0.00 Rate:  0.00
[0016] Keys per second: 495.17K Total:  88.27M Del: 481.45K Scan:  0.00 Rate:  0.00
[0017] Keys per second: 598.67K Total:  94.14M Del: 572.28K Scan:  0.00 Rate:  0.00
[0018] Keys per second: 500.98K Total:  99.19M Del: 538.86K Scan:  0.00 Rate:  0.00
[0019] Keys per second: 539.29K Total: 104.43M Del: 565.56K Scan:  0.00 Rate:  0.00
[0020] Keys per second: 569.70K Total: 109.72M Del: 425.11K Scan:  0.00 Rate:  0.00
[0021] Keys per second: 590.57K Total: 115.36M Del: 585.68K Scan:  0.00 Rate:  0.00
[0022] Keys per second: 588.76K Total: 120.91M Del: 514.37K Scan:  0.00 Rate:  0.00
real    3m56.716s
user    3m31.174s
sys     2m2.675s

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
           5.00    0.00   10.00   85.00    0.00    0.00

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
sda               0.00         0.00         0.00          0          0
sdb            1696.00         1.78         6.83          1          6
dm-0              0.00         0.00         0.00          0          0
dm-1              0.00         0.00         0.00          0          0



> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 200 --dir=$DATADIR -keysz 20 -n 16 -p -batchsize 100 -keypfx 4 -sp 16 -keytrunc 4 -fill -sync-every 100 -exp 60s -history
[0000] Keys per second:   1.20M Total:  12.03M Del:  0.00 Scan:  0.00 Rate:  0.00
[0001] Keys per second: 917.56K Total:  21.29M Del:  0.00 Scan:  0.00 Rate:  0.00
[0002] Keys per second: 910.27K Total:  30.00M Del:  0.00 Scan:  0.00 Rate:  0.00
[0003] Keys per second: 866.11K Total:  38.66M Del:  0.00 Scan:  0.00 Rate:  0.00
[0004] Keys per second: 854.11K Total:  47.16M Del:  0.00 Scan:  0.00 Rate:  0.00
[0005] Keys per second: 869.40K Total:  55.86M Del: 520.00 Scan:  0.00 Rate:  0.00
[0006] Keys per second: 282.76K Total:  58.68M Del: 228.18K Scan:  0.00 Rate:  0.00
[0007] Keys per second: 160.36K Total:  60.29M Del: 298.18K Scan:  0.00 Rate:  0.00
[0008] Keys per second: 158.97K Total:  61.95M Del: 322.97K Scan:  0.00 Rate:  0.00
[0009] Keys per second: 124.03K Total:  63.17M Del: 239.56K Scan:  0.00 Rate:  0.00
[0010] Keys per second: 125.08K Total:  64.48M Del: 256.02K Scan:  0.00 Rate:  0.00
[0011] Keys per second: 114.35K Total:  65.62M Del: 223.72K Scan:  0.00 Rate:  0.00
[0012] Keys per second: 118.81K Total:  66.82M Del: 236.40K Scan:  0.00 Rate:  0.00
-------------------------- SNIP -------------------------
[0063] Keys per second: 235.86K Total: 168.25M Del: 233.48K Scan:  0.00 Rate:  0.00
[0064] Keys per second: 245.99K Total: 170.71M Del: 251.65K Scan:  0.00 Rate:  0.00
[0065] Keys per second: 238.54K Total: 173.10M Del: 261.65K Scan:  0.00 Rate:  0.00
[0066] Keys per second: 255.59K Total: 175.65M Del: 231.96K Scan:  0.00 Rate:  0.00
[0067] Keys per second: 285.76K Total: 178.51M Del: 239.64K Scan:  0.00 Rate:  0.00
[0068] Keys per second: 266.63K Total: 181.18M Del: 205.43K Scan:  0.00 Rate:  0.00
[0069] Keys per second: 238.41K Total: 183.58M Del: 182.78K Scan:  0.00 Rate:  0.00
[0070] Keys per second: 459.44K Total: 188.17M Del: 173.35K Scan:  0.00 Rate:  0.00
[0071] Keys per second: 253.44K Total: 190.71M Del: 170.45K Scan:  0.00 Rate:  0.00
[0072] Keys per second: 301.72K Total: 193.72M Del: 148.63K Scan:  0.00 Rate:  0.00
[0073] Keys per second: 299.42K Total: 196.72M Del: 128.46K Scan:  0.00 Rate:  0.00
[0074] Keys per second: 196.29K Total: 198.68M Del: 127.34K Scan:  0.00 Rate:  0.00
[0075] Keys per second: 226.72K Total: 200.01M Del: 104.59K Scan:  0.00 Rate:  0.00
real    12m38.176s
user    6m28.974s
sys     5m49.333s

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          28.33    0.00   35.00   32.78    0.00    3.89

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
sda               0.00         0.00         0.00          0          0
sdb            6488.00         5.50        45.46          5         45
dm-0              0.00         0.00         0.00          0          0
dm-1              0.00         0.00         0.00          0          0

9.8G



--- 256c (256/256) 200M Keys @ 92bits (256M/256M) w/ LMDB History w/ Rotating Delete (NVME + NVME) --- local vm



> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 50 --dir=$DATADIR -keysz 20 -n 16 -p -batchsize 100 -keypfx 4 -sp 16 -keytrunc 8 -fill -sync-every 50 -history
[0000] Keys per second:   1.00M Total:  10.02M Del:  0.00 Scan:  10.53K Rate:  0.00
[0001] Keys per second: 776.07K Total:  17.73M Del:  0.00 Scan: 229.19K Rate:  0.00
[0002] Keys per second: 533.23K Total:  22.62M Del:  0.00 Scan: 380.15K Rate:  0.00
[0003] Keys per second: 279.14K Total:  25.82M Del:  0.00 Scan: 383.77K Rate:  1.00
[0004] Keys per second: 289.80K Total:  28.86M Del:  0.00 Scan: 443.71K Rate:  1.00
[0005] Keys per second: 222.30K Total:  31.27M Del:  0.00 Scan: 300.98K Rate:  1.00
[0006] Keys per second: 211.22K Total:  33.49M Del:  0.00 Scan: 258.85K Rate:  1.00
[0007] Keys per second: 206.22K Total:  35.67M Del:  0.00 Scan: 267.41K Rate:  1.00
[0008] Keys per second: 178.57K Total:  37.57M Del:  0.00 Scan: 283.86K Rate:  1.00
[0009] Keys per second: 161.42K Total:  39.18M Del:  0.00 Scan: 261.96K Rate:  1.00
[0010] Keys per second: 149.31K Total:  40.76M Del:  0.00 Scan: 281.99K Rate:  1.00
[0011] Keys per second: 150.21K Total:  42.25M Del:  0.00 Scan: 292.46K Rate:  1.00
[0012] Keys per second: 148.56K Total:  43.73M Del:  0.00 Scan: 287.78K Rate:  1.00
[0013] Keys per second: 123.47K Total:  45.04M Del:  0.00 Scan: 255.90K Rate:  2.00
[0014] Keys per second: 141.44K Total:  46.45M Del:  0.00 Scan: 275.66K Rate:  1.00
[0015] Keys per second: 135.47K Total:  47.82M Del:  0.00 Scan: 267.82K Rate:  1.00
[0016] Keys per second: 165.30K Total:  49.48M Del:  0.00 Scan: 321.48K Rate:  1.00
[0017] Keys per second: 124.78K Total:  50.02M Del:  0.00 Scan: 239.72K Rate:  1.00
real    2m56.271s
user    1m39.051s
sys     1m27.052s

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          15.70    0.00   30.81   50.58    0.00    2.91

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
sda               0.00         0.00         0.00          0          0
sdb            4988.00        16.48        34.06         16         34
dm-0              0.00         0.00         0.00          0          0
dm-1              0.00         0.00         0.00          0          0

3.9G

> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 50 --dir=$DATADIR -keysz 20 -n 16 -p -batchsize 100 -keypfx 4 -sp 16 -keytrunc 8 -fill -sync-every 50 -history -exp 10s
[0000] Keys per second: 973.86K Total:   9.74M Del:   3.69K Scan:  18.05K Rate:  0.00
[0001] Keys per second: 627.60K Total:  16.01M Del: 476.88K Scan:  54.16K Rate:  0.00
[0002] Keys per second: 515.38K Total:  21.17M Del: 517.86K Scan:  48.65K Rate:  0.00
[0003] Keys per second: 482.13K Total:  25.43M Del: 526.14K Scan:  33.39K Rate:  0.00
[0004] Keys per second: 512.28K Total:  29.32M Del: 496.37K Scan:  18.76K Rate:  0.00
[0005] Keys per second: 364.42K Total:  33.10M Del: 429.30K Scan:   8.50K Rate:  0.00
[0006] Keys per second: 372.62K Total:  36.54M Del: 411.29K Scan:   9.73K Rate:  0.00
[0007] Keys per second: 391.86K Total:  39.96M Del: 440.43K Scan:   6.80K Rate:  0.00
[0008] Keys per second: 380.02K Total:  43.53M Del: 385.36K Scan:   4.52K Rate:  0.00
[0009] Keys per second: 354.75K Total:  47.23M Del: 353.06K Scan:   4.72K Rate:  0.00
[0010] Keys per second: 452.37K Total:  50.02M Del: 337.43K Scan:   7.16K Rate:  0.00
real    1m49.020s
user    2m9.746s
sys     0m38.910s

1.3GB

5427.29K in
4377.81K out

Deletion is evident in scan reduction and total data volume.
Data directory size is likely inflated by write log.



--- 256c (256/256) 1B Keys @ 92bits (256M/256M) w/ Key Size 20 w/ History (NVME + NVME) --- local vm



> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 1000 --dir=$DATADIR -keysz 20 -n 16 -p -batchsize 100 -keypfx 4 -keytrunc 4 -sp 16 -sync-every 100 -fill
[0000]   1.06M Per Second   5.28M Total  0.00 Deleted Scan:  0.00 Rate:  0.00
               Data Items:  Depth:  Branch Pages:  Leaf Pages:  Overflow Pages:
                 5.31M       2.00       1.00         153.00         0.00
[0001] 910.98K Per Second  10.05M Total  0.00 Deleted Scan:  0.00 Rate:  0.00
               Data Items:  Depth:  Branch Pages:  Leaf Pages:  Overflow Pages:
                10.19M       2.00       2.00         295.00         0.00
[0002] 743.90K Per Second  13.47M Total  0.00 Deleted Scan:  0.00 Rate:  0.00
               Data Items:  Depth:  Branch Pages:  Leaf Pages:  Overflow Pages:
                13.49M       2.00       2.00         391.00         0.00
-------------------------- SNIP -------------------------
[0894] 110.86K Per Second 999.17M Total  0.00 Deleted Scan: 332.58K Rate:  3.00
               Data Items:  Depth:  Branch Pages:  Leaf Pages:  Overflow Pages:
               999.17M       3.00      188.00          31.07K         0.00
[0895] 147.74K Per Second 999.91M Total  0.00 Deleted Scan: 423.36K Rate:  2.00
               Data Items:  Depth:  Branch Pages:  Leaf Pages:  Overflow Pages:
               999.91M       3.00      188.00          31.07K         0.00
[0896] 116.68K Per Second 1000.01M Total  0.00 Deleted Scan: 351.42K Rate:  3.00
               Data Items:  Depth:  Branch Pages:  Leaf Pages:  Overflow Pages:
               1000.01M       3.00      188.00          31.07K         0.00
real    74m44.128s
user    33m47.176s
sys     44m32.725s

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          14.36    0.00   39.20   44.93    0.00    1.51

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
sdb            6226.20        14.88        24.78        148        247
sda               0.30         0.01         0.00          0          0
dm-0              0.30         0.01         0.00          0          0
dm-1              0.00         0.00         0.00          0          0

69GB     nice.

69 Bytes per hash seems like the largest I've seen. Twice the size of previous tests. Wadu hek?
Oh. History is on by default now. That makes total sense. I bet 90bits is smaller.



--- 256c (256/256) 1B Keys @ 92bits (256M/256M) w/ Key Size 20 w/ Rotating Delete (NVME + NVME) --- local vm



> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 1000 --dir=$DATADIR -keysz 12 -n 16 -p -sp 16 -batchsize 100 -keypfx 4 -keytrunc 4 -sync-every 100 -fill -history -exp 60m -a
[0000]   5.44K Per Second  27.20K Total   6.85K Deleted Scan:  21.82K Rate:  4.01
               Data Items:  Depth:  Branch Pages:  Leaf Pages:  Overflow Pages:
               1000.05M       3.00      188.00          31.07K         0.00
[0001] 158.78K Per Second 857.50K Total 205.03K Deleted Scan: 650.88K Rate:  4.10
               Data Items:  Depth:  Branch Pages:  Leaf Pages:  Overflow Pages:
               1000.89M       3.00      188.00          31.17K         0.00
[0002] 157.34K Per Second   1.67M Total 204.47K Deleted Scan: 649.12K Rate:  4.13
               Data Items:  Depth:  Branch Pages:  Leaf Pages:  Overflow Pages:
               1001.69M       3.00      188.00          31.26K         0.00
[0003] 118.26K Per Second   2.26M Total 148.55K Deleted Scan: 471.60K Rate:  3.99
               Data Items:  Depth:  Branch Pages:  Leaf Pages:  Overflow Pages:
               1002.28M       3.00      189.00          31.33K         0.00

-------------------------- SNIP -------------------------

Pausing to increase deletion ratio from 1.25 to 1.5 so it can catch up

[0369]  76.22K Per Second 151.15M Total  95.76K Deleted Scan: 304.00K Rate:  3.99
               Data Items:  Depth:  Branch Pages:  Leaf Pages:  Overflow Pages:
               1151.17M       4.00      310.00          48.56K         0.00
[0370]  75.04K Per Second 151.54M Total  94.42K Deleted Scan: 299.76K Rate:  3.99
               Data Items:  Depth:  Branch Pages:  Leaf Pages:  Overflow Pages:
               1151.56M       4.00      310.00          48.61K         0.00
[0371]  81.26K Per Second 151.97M Total 109.54K Deleted Scan: 347.76K Rate:  4.28
               Data Items:  Depth:  Branch Pages:  Leaf Pages:  Overflow Pages:
               1152.00M       4.00      310.00          48.66K         0.00^Csignal: interrupt
real    31m3.706s
user    11m55.103s
sys     24m2.388s


Deletion was broken.


> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 1000 --dir=$DATADIR -keysz 12 -n 16 -p -sp 16 -batchsize 100 -keypfx 4 -keytrunc 4 -sync-every 100 -fill -history -exp 60m -a

panic: runtime error: slice bounds out of range [:16] with capacity 4

goroutine 280 [running]:
main.writeBatch.func3(0xc00013dcb0, 0x0, 0x0)
        /root/home/junk/badger-bench/populate/main.go:354 +0x49d
github.com/bmatsuo/lmdb-go/lmdb.(*Env).run(0xc000010918, 0x1, 0x0, 0xc000055e88, 0x0, 0x0)
        /usr/local/share/go/pkg/mod/github.com/bmatsuo/lmdb-go@v1.8.0/lmdb/env.go:494 +0xe3
github.com/bmatsuo/lmdb-go/lmdb.(*Env).Update(...)
        /usr/local/share/go/pkg/mod/github.com/bmatsuo/lmdb-go@v1.8.0/lmdb/env.go:459
main.writeBatch(0xc000112a80, 0x64, 0x64, 0x0, 0xff, 0x0)
        /root/home/junk/badger-bench/populate/main.go:332 +0xd0b
main.main.func7(0x41cdcd6500000000, 0x100, 0xc00015c130, 0xc00006a9c0, 0xc00015c140, 0xff)
        /root/home/junk/badger-bench/populate/main.go:699 +0x21a
created by main.main
        /root/home/junk/badger-bench/populate/main.go:684 +0xab4
exit status 2

real    0m1.335s
user    0m1.315s
sys     0m0.405s


!!!!!!   HISTORY DOES NOT SUPPORT KEY SIZE CHANGE   !!!!!!!

History tables should be named by key size
History table names will probably also specify expiration time (7/14/30)


> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 1000 --dir=$DATADIR -keysz 12 -n 16 -p -sp 16 -batchsize 100 -keypfx 4 -keytrunc 4 -sync-every 100 -fill -history -exp 60m
[0000]   1.25M Per Second   6.23M Total  0.00 Deleted Scan:  0.00 Rate:  0.00
               Data Items:  Depth:  Branch Pages:  Leaf Pages:  Overflow Pages:
                 6.74M       2.04       1.00         143.00         0.00
[0001] 966.98K Per Second  10.73M Total  0.00 Deleted Scan:  0.00 Rate:  0.00
               Data Items:  Depth:  Branch Pages:  Leaf Pages:  Overflow Pages:
                10.73M       2.25       1.00         228.00         0.00
[0002]   1.18M Per Second  16.66M Total  0.00 Deleted Scan:  0.00 Rate:  0.00
               Data Items:  Depth:  Branch Pages:  Leaf Pages:  Overflow Pages:
                16.66M       2.64       2.00         354.00         0.00

-------------------------- SNIP -------------------------

[0714] 151.36K Per Second 997.76M Total  0.00 Deleted Scan: 441.30K Rate:  2.92
               Data Items:  Depth:  Branch Pages:  Leaf Pages:  Overflow Pages:
               997.76M       3.00      139.00          22.80K         0.00
[0715] 144.94K Per Second 998.49M Total  0.00 Deleted Scan: 425.76K Rate:  2.94
               Data Items:  Depth:  Branch Pages:  Leaf Pages:  Overflow Pages:
               998.49M       3.00      139.00          22.80K         0.00
[0716] 184.16K Per Second 999.42M Total  0.00 Deleted Scan: 538.68K Rate:  2.93
               Data Items:  Depth:  Branch Pages:  Leaf Pages:  Overflow Pages:
               999.42M       3.00      139.00          22.80K         0.00
real    59m50.779s
user    32m44.257s
sys     34m12.896s

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          18.91    0.00   36.62   41.34    0.00    3.13

Device:            tps    MB_read/s    MB_wrtn/s    MB_read    MB_wrtn
sdb            6678.07        16.27        26.08        976       1564
sda               2.55         0.22         0.00         13          0
dm-0              2.28         0.22         0.00         13          0
dm-1              0.90         0.00         0.00          0          0

47GB    Nice.


We're operating at about 5x TPS (IOPS) compared with target production environment.
Should put us around 25k sustained w/ deletes @ 1B keys

> time go run populate/main.go --kv lmdb --valsz 0 --keys_mil 1000 --dir=$DATADIR -keysz 12 -n 16 -p -sp 16 -batchsize 100 -keypfx 4 -keytrunc 4 -sync-every 100 -fill -history -exp 10s -a